H.add("widget~RandomBox",function(a){function f(a,c){var d=this;if(!(d instanceof f))return new f;d.config=b.mix(e,a),d.list=d.config.list,d.domNum=d.list.length,d.rollTimes=d.config.rollTimes,d.cls=d.config.cls,d.beginIndex=0,d.duration=d.config.duration,d.speedSteps=d.config.speedSteps,d._init(),d.callback=typeof c=="function"?c:undefined}var b=KISSY,c=b.all,d=b.Event,e={rollTimes:4,cls:"sel-item",duration:40,speedSteps:[1,2,5],probability:[]};b.augment(f,{_init:function(){var a=this,b=a.domNum;a.$domList=[],a.curRollTimes=0;for(var d=0;d<b;d++)a.$domList[d]=c(a.list[d]);a.changeTimes=b*a.rollTimes,a.config.finalId?(a.finalId=a.config.finalId,a.finalNum=a.changeTimes+a.indexOfArray(a.list,a.finalId)+1):a.finalNum=1e6},rolling:function(){var a=this;a.choose(a.$domList[a.beginIndex%a.domNum]),a.beginIndex+=1,a.start(),a.beginIndex==a.finalNum&&(a._clearInterval(),a.callback(a.curTarget))},_setInterval:function(a){var b=this;b.interval=setInterval(function(){b.rolling()},a)},_clearInterval:function(){var a=this;clearInterval(a.interval)},start:function(){var a=this,b=a.duration,c=a.speedSteps;a.stop(),a.beginIndex<a.finalNum&&(a.beginIndex>a.finalNum-10?a._setInterval(b*c[2]):a.beginIndex<=a.finalNum-10&&a.beginIndex>=a.finalNum-20?a._setInterval(b*c[1]):a._setInterval(b*c[0]))},stop:function(){var a=this;a._clearInterval()},reset:function(){var a=this,b=a.$domList,c=a.domNum,d=a.cls;a.stop(),a.beginIndex=0,a._init();for(var e=0,f=c;e<f;e++)b[e].hasClass(d)?b[e].removeClass(d):null},choose:function(a){var c=this;b.each(c.$domList,function(a){a.removeClass(c.cls)}),a.addClass(c.cls),c.curTarget="#"+a.attr("id")||""},indexOfArray:function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]==b)return c;return-1}}),H.widget.RandomBox=f}),H.add("SMART",function(a){var b=KISSY,c=b.DOM,e=b.Event,f={active_tab:function(a){return new b.Tabs("#J_Smart",{navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",activeTriggerCls:"current",autoplay:!0}),this},StringToDate:function(a){if(typeof a=="undefined")return new Date;if(typeof a=="date")return a;var b=Date.parse(a),c=new Date(b);if(isNaN(c)){a=a.replace(/:/g,"-"),a=a.replace(" ","-"),a=a.replace(".","-");var d=a.split("-");switch(d.length){case 7:c=new Date(d[0],--d[1],d[2],d[3],d[4],d[5],d[6]);break;case 6:c=new Date(d[0],--d[1],d[2],d[3],d[4],d[5]);break;default:c=new Date(d[0],--d[1],d[2])}}return c},shareToQzone:function(a,b){return url="http://item.taobao.com/item.htm?id="+a,window.open("http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+encodeURIComponent(url)+"&title"+encodeURIComponent(b)),!1},shareToSina:function(a,b){url="http://item.taobao.com/item.htm?id="+a,void function(a,c,d){function h(){window.open([e,g].join(""),"mb",["toolbar=0,status=0,resizable=1,width=620,height=450,left=",(a.width-620)/2,",top=",(a.height-450)/2].join(""))||(f.href=[e,g].join(""))}try{}catch(d){}var e="http://v.t.sina.com.cn/share/share.php?",f=url,g=["url=",d(f),"&title=",d(b),"&appkey=1226626340"].join("");/Firefox/.test(navigator.userAgent)?setTimeout(h,0):h()}(screen,document,encodeURIComponent)},shareToQq:function(a,b){return url="http://item.taobao.com/item.htm?id="+a,window.open("http://v.t.qq.com/share/share.php?url="+encodeURIComponent(url)+"&appkey=&site=&title="+encodeURI(b),"","width=700, height=680, top=0, left=0, toolbar=no,menubar=no, scrollbars=no, location=yes, resizable=no, status=no"),!1},shareToRenren:function(a,b){url="http://item.taobao.com/item.htm?id="+a,void function(a,c,d){function i(){window.open([e,h].join(""),"xnshare",["toolbar=0,status=0,resizable=1,width=626,height=436,left=",(a.width-626)/2,",top=",(a.height-436)/2].join(""))||(f.href=[e,h].join(""))}if(/xiaonei\.com/.test(url))return;var e="http://share.xiaonei.com/share/buttonshare.do?link=",f=url,g=b,h=[d(f),"&title=",d(g)].join("");/Firefox/.test(navigator.userAgent)?setTimeout(i,0):i()}(screen,document,encodeURIComponent)},shareToKaixin:function(a,b){var c="http://item.taobao.com/item.htm?id="+a;d=document,t=d.selection?d.selection.type!="None"?d.selection.createRange().text:"":d.getSelection?d.getSelection():"",void (kaixin=window.open("http://www.kaixin001.com/~repaste/repaste.php?&rurl="+escape(c)+"&rtitle="+escape(b)+"&rcontent="+escape(d.title),"kaixin")),kaixin.focus()},shareToDouban:function(a,b){var c="http://item.taobao.com/item.htm?id="+a;void function(){var a=document,d=encodeURIComponent,e=window.getSelection,f=a.getSelection,g=a.selection,h=e?e():f?f():g?g.createRange().text:"",i="http://www.douban.com/recommend/?url="+d(c)+"&title="+d(b)+"&sel="+d(h)+"&v=1",j=function(){window.open(i,"douban","toolbar=0,resizable=1,scrollbars=yes,status=1,width=700,height=680")||(location.href=i+"&r=1")};/Firefox/.test(navigator.userAgent)?setTimeout(j,0):j()}()},shareToBaidu:function(a,b){return url="http://item.taobao.com/item.htm?id="+a,window.open("http://apps.hi.baidu.com/share/?title="+encodeURIComponent(b.substring(0,76))+"&url="+encodeURIComponent(url)),!1},getItemVolume:function(a,b,d,e){var f=function(a){c.html("#"+b,a.payload)},g=function(a){c.html("#"+b,"0")},h="item_id="+b.substr(9)+"&nick="+d+"&mode="+e;(new H.widget.asyncRequest).setURI(a).setMethod("GET").setHandle(f).setErrorHandle(g).setData(h).send()},getItemCollect:function(a,b){var d=function(a){c.html("#"+b,a.payload)},e=function(a){c.html("#"+b,"0")},f="item_id="+b.substr(10);(new H.widget.asyncRequest).setURI(a).setMethod("GET").setHandle(d).setErrorHandle(e).setData(f).send()}};H.app.smart||(H.app.smart=f)}); 