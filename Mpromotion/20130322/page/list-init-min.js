KISSY.add("utils/showPages/index",function(a){function e(a){var b=this;if(!(b instanceof e))return new e(a);this.pageNum=4,this.name=a,this.page=1,this.pageCount=200,this.argName="page"}var b=a.DOM,c=a.Event,d=document;return a.mix(e.prototype,{jump:function(){return undefined},checkPages:function(){isNaN(parseInt(this.page))&&(this.page=1),isNaN(parseInt(this.pageCount))&&(this.pageCount=1),this.page<1&&(this.page=1),this.pageCount<1&&(this.pageCount=1),this.page>this.pageCount&&(this.page=this.pageCount),this.page=parseInt(this.page),this.pageCount=parseInt(this.pageCount)},_createHtml:function(a){var b=this,c="",d=this.page-1,e=this.page+1;if(a==""||typeof a=="undefined")a=1;switch(a){case 1:c+='<span class="number">',this.page!=1&&(c+='<span title="Page 1"><a href="javascript:'+b.name+'.toPage(1);">1</a></span>'),this.page>=5&&(c+="<span>...</span>");if(this.pageCount>this.page+2)var f=this.page+2;else var f=this.pageCount;for(var g=this.page-2;g<=f;g++)g>0&&(g==this.page?c+='<span title="Page '+g+'">'+g+"</span>":g!=1&&g!=this.pageCount&&(c+='<span title="Page '+g+'"><a href="javascript:'+b.name+".toPage("+g+');">'+g+"</a></span>"));this.page+3<this.pageCount&&(c+="<span>...</span>"),this.page!=this.pageCount&&(c+='<span title="Page '+this.pageCount+'"><a href="javascript:'+b.name+".toPage("+this.pageCount+');">'+this.pageCount+"</a></span>"),c+="</span><br />";break;case 2:if(this.pageCount>1){c+='<div class="page-bottom"> <div class="sabrosus">',d<1?c+='<span class="pre-none page-pic-no"></span>':c+='<a class="" href="javascript:'+b.name+".toPage("+d+');" title="\u4e0a\u4e00\u9875"><span class="pre page-pic-no"></span></a>',this.page==1;if(this.page-2<=0){var h=1;if(this.pageCount>this.page+4)var f=this.page+4;else var f=this.pageCount}else if(this.page+2>=this.pageCount){var h=this.pageCount-4;if(this.pageCount>this.page+4)var f=this.page+4;else var f=this.pageCount}else{var h=this.page-2;if(this.pageCount>this.page+2)var f=this.page+2;else var f=this.pageCount}for(var g=h;g<=f;g++)g>0&&(g==this.page?c+='<span class="current a-padding">'+g+"</span>":c+='<a class="a-padding" href="javascript:'+b.name+".toPage("+g+');">'+g+"</a>");this.page+5<this.pageCount&&(c+='<a class="a-padding" title="" href="javascript:'+b.name+".toPage("+(this.page+3)+');">...</a>'),this.page==this.pageCount,e>this.pageCount?c+='<span class="next-none page-pic-no"></span>':c+='<a class="" href="javascript:'+b.name+".toPage("+e+');" title="\u4e0b\u4e00\u9875"><span class="next page-pic-no"></span></a>',this.pageCount>5&&(c+='<font class="number">',c+="\u5171"+this.pageCount+"\u9875&nbsp;\u5230\u7b2c&nbsp;",this.page>=this.pageCount?c+='<input style="" type="text" class="page-pic-no w-30 bg-img" id="pageInput'+b.name+'"  value="'+this.pageCount+'" onkeypress="return window.'+b.name+'.formatInputPage(event);" onfocus="this.select()">&nbsp;\u9875':c+='<input style="" type="text" class="page-pic-no w-30 bg-img" id="pageInput'+b.name+'"  value="'+(this.page+1)+'" onkeypress="return window.'+b.name+'.formatInputPage(event);" onfocus="this.select()">&nbsp;\u9875',c+='<input type="button" value="" class="page-pic-no gray-btm-h-go w-30 btm-go" onclick="javascript:var page = document.getElementById(\'pageInput'+b.name+"').value; if(isNaN(Number(page))|| Number(page)==0) { var turnTo = 1;} else if(page>"+this.pageCount+"){ var turnTo = "+this.pageCount+";} else{var turnTo = page;}  window."+b.name+'.toPage(turnTo);">',c+="</font>"),c+='<div style="clear:both"></div></div></div> '}break;case 3:c+='<div class="page-top"><div class="sabrosus"><span class="count">'+this.page+" / "+this.pageCount+"</span>",d<1?c+=' <span class="pre-none page-pic-no"></span>':c+='<a class="border-left-dedede" href="javascript:'+b.name+".toPage("+d+');" title="\u4e0a\u4e00\u9875"><span class="pre page-pic-no"></span></a>',e>this.pageCount?c+='<span class="next-none page-pic-no"></span>':c+='<a href="javascript:'+b.name+".toPage("+e+');" title="\u4e0b\u4e00\u9875"><span class="next page-pic-no"></span></a>',c+='<div style="clear:both"></div></div></div>'}return c},formatInputPage:function(a){var b=navigator.appName=="Microsoft Internet Explorer"?!0:!1;if(!b)var c=a.which;else var c=event.keyCode;return c==8||c==46||c>=48&&c<=57?!0:!1},toPage:function(a,b){var c=1,d=this;typeof a=="object"?c=a.options[a.selectedIndex].value:c=a,d.jump(c,b,"")},printHtml:function(a,c){return this.checkPages(),b.html(a,this._createHtml(c)),this},setPageCount:function(a){return this.pageCount=a,this},getPageCount:function(){return this.pageCount},setRender:function(a){return this.jump=a,this},setPageNum:function(a){return this.pageNum=a,this},setPage:function(a){return this.page=a,this}}),e}),KISSY.add("page/mods/check",function(a){return checkUtil={checkSpecTitle:function(a){var b=[],c=!1,d=null,e=/(淘宝)|(聚划算)|(限时折扣)|(限时打折)|(良品)|(淘金币)|(天天特价)|(满就送)|(vip)/i;if(e.test(a)){var f=e.exec(a);f!=null&&(c=!0,d="\u542b\u6709\u8fdd\u7981\u5b57"+f[0]+"\uff01")}return b.push(c),b.push(d),b},checkPromoName:function(a){var b=[],c=!1,d=null,e=/^[\u4E00-\u9FA5\uf900-\ufa2d\A-Za-z0-9]{2,5}$/;if(!e.test(a))if(a.length<2||a.length>5)c=!0,d="\u957f\u5ea62~5\u4e2a\u5b57\u7b26\uff01";else{var f=/[^\u4E00-\u9FA5\uf900-\ufa2d\A-Za-z0-9]+/,g=a.match(f);g!=null&&(c=!0,d="\u542b\u6709\u975e\u6cd5\u5b57\u7b26"+g[0]+"\uff01")}return b.push(c),b.push(d),b},checkPromoDesc:function(a){var b=[],c=!1,d=null,e=/^[\u4E00-\u9FA5\uf900-\ufa2d\w\s\，！。《》（）、—]{0,30}$/;if(!e.test(a))if(a.length>30)c=!0,d="\u957f\u5ea630\u4e2a\u5b57\u4ee5\u5185\uff01";else{var f=/[^\u4E00-\u9FA5\uf900-\ufa2d\w\s\，！。《》（）、—]+/,g=a.match(f);g!=null&&(c=!0,d="\u542b\u6709\u975e\u6cd5\u5b57\u7b26"+g[0]+"\uff01")}return b.push(c),b.push(d),b},checkUrl:function(a){var b=[],c=!1,d=null,e=/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?/;return e.test(a)||(c=!0,d="\u975e\u6cd5URl\u5730\u5740\uff01"),b.push(c),b.push(d),b},checkDiscount:function(a){var b=[],c=!1,d=null;if(isNaN(Number(a))||a<=0||a>=10)c=!0,d="\u6298\u6263\u8303\u56f4\u5728 0.00~9.99\u4e4b\u95f4\u54e6\uff01";else{var e=/(^[0-9]([.][0-9]{1,2})?$)|(^1[0-9]([.][0-9]{1,2})?$)|(^2[0-3]([.][0-9]{1,2})?$)|(^10([.]0{1,2})?$)/;e.test(a)||(c=!0,d="\u6298\u6263\u8303\u56f4\u5728 0.00~9.99\u4e4b\u95f4\u54e6\uff01")}return b.push(c),b.push(d),b}}}),KISSY.add("page/list-init",function(a,b,c,d){var a=KISSY,e=a.DOM,f=a.Event;return promotionControl={msg:null,msg1:null,isLoad:!1,paginator:null,init:function(){f.delegate(document,"click",".J_Editor_Promo",function(a){if(!showPermissions("editor_promotion","\u7f16\u8f91\u4fc3\u9500\u6d3b\u52a8"))return;var b=e.attr(a.currentTarget,"data"),c=function(a){window.location.href=b},d=function(a){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error",autoClose:!0,timeOut:3e3})},f=e.attr(a.currentTarget,"uid"),g="pid="+f+"&form_key="+FORM_KEY;(new H.widget.asyncRequest).setURI(editPromoUrl).setMethod("GET").setHandle(c).setErrorHandle(d).setData(g).send()}),f.delegate(document,"click",".J_OnClickShopDesc",function(a){if(!showPermissions("editor_promotion","\u7f16\u8f91\u4fc3\u9500\u6d3b\u52a8"))return;e.hide(a.currentTarget);var b=e.attr(a.currentTarget,"data"),c=KISSY.trim(e.val("#J_SouceShopDesc_"+b));if(!KISSY.one("#J_EditorShopDesc_"+b)){var d='<input type="text"  class="input-text w-70 fl" data ="'+b+'" id="J_InputShopDesc_'+b+'" value="">'+'<input class="gray-btm-h-10 w-30" style="cursor:pointer" data="'+b+'"  id="J_EditorShopDesc_'+b+'" value ="\u4fdd\u5b58" />';e.html("#J_ShowEditorDesc_"+b,d)}e.show("#J_ShowEditorDesc_"+b),f.on("#J_InputShopDesc_"+b,"blur",function(){KISSY.later(function(){e.hide("#J_ShowEditorDesc_"+b),e.show("#J_Promo_"+b+" .J_OnClickShopDesc")},200,!1,null)}),e.get("#J_InputShopDesc_"+b).focus(),e.val("#J_InputShopDesc_"+b,c),f.on("#J_EditorShopDesc_"+b,"click",function(a){var b=e.attr(a.currentTarget,"data"),c=KISSY.trim(e.val("#J_SouceShopDesc_"+b)),d=KISSY.trim(e.val("#J_InputShopDesc_"+b));if(c==d){e.hide("#J_ShowEditorDesc_"+b),e.show("#J_Promo_"+b+" .J_OnClickShopDesc");return}var f=function(a){e.hide("#J_ShowEditorDesc_"+b),d?(e.html("#J_Promo_"+b+" .J_OnClickShopDesc",d),e.removeClass("#J_Promo_"+b+" .J_OnClickShopDesc","color-gray-9")):(e.html("#J_Promo_"+b+" .J_OnClickShopDesc",'<span class="editItemNum"> </span>\u586b\u5907\u6ce8...'),e.addClass("#J_Promo_"+b+" .J_OnClickShopDesc","color-gray-9")),e.show("#J_Promo_"+b+" .J_OnClickShopDesc"),e.val("#J_SouceShopDesc_"+b,d)},g=function(a){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error",autoClose:!0,timeOut:3e3})},h="pid="+b+"&shop_desc="+encodeURI(d)+"&form_key="+FORM_KEY;(new H.widget.asyncRequest).setURI(saveShopDescUrl).setMethod("GET").setHandle(f).setErrorHandle(g).setData(h).send()})}),f.on(e.query(".J_GetTemplet"),"click",function(){var a=function(a){promotionControl.msg.hide();var b='<div><textarea style="width:380px;height:200px; margin:5px" id="J_Templet_Content" onclick="this.select()">'+a.payload+'</textarea></br><span class="btm-68-gray fl"><a href="#2"  class="J_Copy"><span>\u70b9\u6b64\u590d\u5236</span></a></span><span style="height:31px; line-height:31px">\u9f20\u6807\u4e8e\u6846\u5185CTRL+C\uff1a\u590d\u5236\u3001CTRL+V\uff1a\u7c98\u8d34</span></div>',c=new d.Dialog({width:395,headerContent:"\u83b7\u53d6\u6d77\u62a5\u4ee3\u7801",bodyContent:b,mask:!0,align:{points:["cc","cc"]},closable:!0,draggable:!0,aria:!0});c.render(),c.show(),H.util.clipboard(".J_Copy","#J_Templet_Content")},b=function(a){promotionControl.msg.hide(),new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})},c=e.attr(this,"data"),f="pid="+c+"&form_key="+FORM_KEY;promotionControl.msg=new H.widget.msgBox({title:"",dialogType:"loading",content:"\u83b7\u53d6\u4ee3\u7801\u4e2d\uff0c\u8bf7\u7a0d\u5019"}),(new H.widget.asyncRequest).setURI(getTempletUrl).setMethod("GET").setHandle(a).setErrorHandle(b).setData(f).send()}),f.delegate(document,"click",".J_BackTo",function(){e.show("#promoList"),e.show("#J_PromoDetail"),e.hide("#itemList"),e.hide("#J_BackToPromoList")});var a=e.query(".J_Delete");f.on(a,"click",function(){if(!showPermissions("editor_promotion","\u5220\u9664\u4fc3\u9500\u6d3b\u52a8"))return;var a=e.attr(this,"data"),b=e.val("#J_TypeId_"+a),c=IsExpired();if(c>-5e3&&b==10){var d=function(b){promotionControl.deleteHandle(a)},f=function(a){KISSY.Event.fire(".J_TopExpired","click")},g="";(new H.widget.asyncRequest).setURI(isExpiredUrl).setMethod("GET").setHandle(d).setErrorHandle(f).setData(g).send()}else promotionControl.deleteHandle(a)}),f.on(e.query(".J_Pause"),"click",function(){if(!showPermissions("editor_promotion","\u7f16\u8f91\u4fc3\u9500\u6d3b\u52a8"))return;var a=e.attr(this,"data"),b=IsExpired();if(b>-5e3){var c=function(b){promotionControl.pausePromo(a)},d=function(a){KISSY.Event.fire(".J_TopExpired","click")},f="";(new H.widget.asyncRequest).setURI(isExpiredUrl).setMethod("GET").setHandle(c).setErrorHandle(d).setData(f).send()}else promotionControl.pausePromo(a)}),f.on(e.query(".J_Restart"),"click",function(){if(!showPermissions("editor_promotion","\u91cd\u542f\u4fc3\u9500\u6d3b\u52a8"))return;var a=e.attr(this,"data"),b=IsExpired();if(b>-5e3){var c=function(b){promotionControl.restartPromo(a)},d=function(a){KISSY.Event.fire(".J_TopExpired","click")},f="";(new H.widget.asyncRequest).setURI(isExpiredUrl).setMethod("GET").setHandle(c).setErrorHandle(d).setData(f).send()}else promotionControl.restartPromo(a)}),f.delegate(document,"click mouseenter mouseleave",".J_EditorPromoName",function(a){if(a.type=="mouseenter")e.addClass(a.currentTarget,"edit-activity-hover");else if(a.type=="mouseleave")e.removeClass(a.currentTarget,"edit-activity-hover");else if(a.type=="click"){if(!showPermissions("editor_promotion","\u7f16\u8f91\u4fc3\u9500\u6d3b\u52a8"))return;var b=e.attr(a.currentTarget,"data"),c=IsExpired();if(c>-5e3){var d=function(a){promotionControl.editorPromoName(b)},f=function(a){KISSY.Event.fire(".J_TopExpired","click")},g="";(new H.widget.asyncRequest).setURI(isExpiredUrl).setMethod("GET").setHandle(d).setErrorHandle(f).setData(g).send()}else promotionControl.editorPromoName(b)}}),f.delegate(document,"click mouseenter mouseleave",".J_EditorPromoTime",function(a){if(a.type=="mouseenter")e.addClass(a.currentTarget,"edit-activity-hover");else if(a.type=="mouseleave")e.removeClass(a.currentTarget,"edit-activity-hover");else if(a.type=="click"){if(!showPermissions("editor_promotion","\u7f16\u8f91\u4fc3\u9500\u6d3b\u52a8"))return;var b=e.attr(a.currentTarget,"data"),c=IsExpired();if(c>-5e3){var d=function(a){promotionControl.editorPromoTime(b)},f=function(a){KISSY.Event.fire(".J_TopExpired","click")},g="";(new H.widget.asyncRequest).setURI(isExpiredUrl).setMethod("GET").setHandle(d).setErrorHandle(f).setData(g).send()}else promotionControl.editorPromoTime(b)}})},pausePromo:function(a){var b=function(b){new H.widget.msgBox({title:"\u6682\u505c\u6d3b\u52a8",content:"\u6682\u505c\u6d3b\u52a8\u5c06\u4f1a\u53d6\u6d88\u60a8\u8bbe\u7f6e\u7684\u4fc3\u9500\u6d3b\u52a8",type:"confirm",buttons:[{value:"\u6682\u505c"},{value:"\u53d6\u6d88"}],success:function(b){if(b=="\u6682\u505c"){var c="pid="+a+"&form_key="+FORM_KEY,d=function(a){new H.widget.msgBox({type:"sucess",dialogType:"msg",content:"\u6d3b\u52a8\u6682\u505c\u6210\u529f",autoClose:!0,timeOut:3e3}),window.location.href=currentPageUrl},e=function(a){if(a.desc=="need-oauth"){KISSY.Event.fire(".J_TopExpired","click");return}new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})};(new H.widget.asyncRequest).setURI(pauseUrl).setMethod("GET").setHandle(d).setErrorHandle(e).setData(c).send()}}})},c=function(a){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})},d="pid="+a+"&form_key="+FORM_KEY;(new H.widget.asyncRequest).setURI(getPromoTimeUrl).setMethod("GET").setHandle(b).setErrorHandle(c).setData(d).send()},restartPromo:function(a){var b=function(b){promotionControl.msg.hide();var c=H.util.StringToDate(b.payload.stime),d=H.util.StringToDate(b.payload.etime),f=new Date;leftStartTime=(c.getTime()-f.getTime())/1e3,leftEndTime=(d.getTime()-f.getTime())/1e3;var g=e.val("#J_TypeId_"+a);if(g==10)var h="\u5f00\u59cb\u65f6\u95f4 \uff1a\u7acb\u5373\u5f00\u59cb",i="hidden";else var h="\u5f00\u59cb\u65f6\u95f4\uff1a",i="text";new H.widget.msgBox({title:"\u91cd\u542f\u6d3b\u52a8",type:"prompt",inputs:[{header:h,type:i,value:b.payload.stime,name:"",id:"J_stime",className:"input-text input-day-2"},{header:"\u7ed3\u675f\u65f6\u95f4\uff1a",type:"text",value:b.payload.etime,name:"",id:"J_etime",className:"input-text input-day-2"}],buttons:[{value:"\u786e\u5b9a\u4fee\u6539"},{value:"\u53d6\u6d88\u4fee\u6539"}],success:function(b){if(b=="\u786e\u5b9a\u4fee\u6539"){var c=e.val(e.get("#J_stime")),d=e.val(e.get("#J_etime")),f="pid="+a+"&etime="+d+"&stime="+c+"&form_key="+FORM_KEY,g=function(a){new H.widget.msgBox({type:"sucess",dialogType:"msg",content:"\u6d3b\u52a8\u91cd\u542f\u6210\u529f",autoClose:!0,timeOut:3e3}),window.location.href=currentPageUrl},h=function(a){if(a.desc=="need-oauth"){KISSY.Event.fire(".J_TopExpired","click");return}new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})};(new H.widget.asyncRequest).setURI(restartUrl).setMethod("GET").setHandle(g).setErrorHandle(h).setData(f).send()}}}),myCalendar("J_stime"),myCalendar("J_etime")},c=function(a){promotionControl.msg.hide(),new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})},d="pid="+a+"&form_key="+FORM_KEY;promotionControl.msg=new H.widget.msgBox({title:"",dialogType:"loading",content:"\u83b7\u53d6\u6d3b\u52a8\u65f6\u95f4\uff0c\u8bf7\u7a0d\u5019"}),(new H.widget.asyncRequest).setURI(getPromoTimeUrl).setMethod("GET").setHandle(b).setErrorHandle(c).setData(d).send()},editorPromoName:function(a){e.hide("#J_PromoNameBox_"+a);var b=KISSY.trim(e.val("#J_SoucePromoName_"+a)),d='<input type="text"  class="input-text w-70 fl" style="_width:79px" data ="'+a+'" id="J_InputPromoName_'+a+'" value="">'+'<input class="gray-btm-h-10 w-30" style="cursor:pointer" data="'+a+'"  id="J_SavePromoName_'+a+'" value ="\u4fdd\u5b58" />';e.html("#J_ShowEditorPromoName_"+a,d),e.show("#J_ShowEditorPromoName_"+a),f.on("#J_InputPromoName_"+a,"blur",function(){KISSY.later(function(){e.hide("#J_ShowEditorPromoName_"+a),e.show("#J_PromoNameBox_"+a)},200,!1,null)}),e.get("#J_InputPromoName_"+a).focus(),e.val("#J_InputPromoName_"+a,b),f.on("#J_SavePromoName_"+a,"click",function(a){var b=e.attr(a.currentTarget,"data"),d=KISSY.trim(e.val("#J_SoucePromoName_"+b)),f=KISSY.trim(e.val("#J_InputPromoName_"+b));if(d==f){e.hide("#J_ShowEditorPromoName_"+b),e.show("#J_PromoNameBox_"+b);return}var g=H.util.isNull(f),h=g[0],i=g[1];if(h){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u51fa\u9519\u4e86\uff1a"+i,type:"error"});return}g=c.checkSpecTitle(f),h=g[0],i=g[1];if(h){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u51fa\u9519\u4e86\uff1a"+i,type:"error"});return}var j=e.val("#J_TypeId_"+b);if(j=="2"||j=="9"||j=="20"||j=="22"){g=c.checkPromoName(f),h=g[0],i=g[1];if(h){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u51fa\u9519\u4e86\uff1a"+i,type:"error"});return}}var k=function(a){window.location.href=currentPageUrl},h=function(a){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})},l="pid="+b+"&promo_name="+encodeURI(f)+"&form_key="+FORM_KEY;(new H.widget.asyncRequest).setURI(savePromoNameUrl).setMethod("GET").setHandle(k).setErrorHandle(h).setData(l).send()})},editorPromoTime:function(a){e.hide(e.get(".J_EditorPromoTime","#J_Promo_"+a));var b=KISSY.trim(e.val("#J_SoucePromoStartTime_"+a)),c=KISSY.trim(e.val("#J_SoucePromoEndTime_"+a)),d='<div class="bianji-shijian w-170"><span class="block riqi">\u8d77&nbsp;<input style="*width:135px;" type="text" readonly="readonly" id="J_startDate_'+a+'" name="start_date" class="input-text input-day-2" value="'+b+'" title="\u5f00\u59cb\u65f6\u95f4">'+"</span>"+'<span class="block riqi">\u5230&nbsp;<input style="*width:135px;" type="text" readonly="readonly" id="J_endDate_'+a+'" name="end_date" class="input-text input-day-2" value="'+c+'" title="\u7ed3\u675f\u65f6\u95f4">'+"</span>"+'<span class="block clear"></span>'+'</div><div style="width:163px" class="J_RestartBlock" ><input type="checkbox" checked="checked" id="J_IsRestart'+a+'" data="'+a+'" value="1" style="margin:0px 2px 0px 16px;"/><div style="margin:0px 2px 2px 9px; display:inline-block;" class="w-120" id="" >\u4fdd\u5b58\u8bbe\u7f6e\u540e\u91cd\u542f\u6d3b\u52a8</div></div><div style=" margin:0px 2px 0px 16px; _display:inline;" class="gray-btm-h-20 w-70 fl" id="J_SaveTime_'+a+'" data="'+a+'">\u4fdd\u5b58</div><div class="gray-btm-h-20 w-70" id="J_CancelTime_'+a+'" data="'+a+'">\u53d6\u6d88</div>';e.html("#J_ShowEditorPromoTime_"+a,d),e.show("#J_ShowEditorPromoTime_"+a),Calendar("J_startDate_",a),Calendar("J_endDate_",a),f.remove("#J_SaveTime_"+a),f.remove("#J_CancelTime_"+a),f.on("#J_SaveTime_"+a,"click",function(a){var b=e.attr(a.currentTarget,"data");e.hide("#J_TimeMsg_"+b);var c=KISSY.trim(e.val("#J_SoucePromoStartTime_"+b)),d=KISSY.trim(e.val("#J_SoucePromoEndTime_"+b));NSpromoTime=KISSY.trim(e.val("#J_startDate_"+b)),NEpromoTime=KISSY.trim(e.val("#J_endDate_"+b));if(c==NSpromoTime&&d==NEpromoTime){e.hide("#J_ShowEditorPromoTime_"+b),e.show(e.get(".J_EditorPromoTime","#J_Promo_"+b)),e.hide("#J_TimeMsg_"+b);return}KISSY.later(function(){e.hide("#J_ShowEditorPromoTime_"+b),e.show(e.get(".J_EditorPromoTime","#J_Promo_"+b))},200,!1,null);var f=function(a){window.location.href=currentPageUrl},g=function(a){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})};if(e.hasClass("#J_Promo_"+b,"pauseing"))var h=e.prop("#J_IsRestart"+b,"checked")?1:0;else var h=0;var i="pid="+b+"&start_date="+NSpromoTime+"&end_date="+NEpromoTime+"&isReStart="+h+"&form_key="+FORM_KEY;(new H.widget.asyncRequest).setURI(savePromoTimeUrl).setMethod("GET").setHandle(f).setErrorHandle(g).setData(i).send()}),f.on("#J_CancelTime_"+a,"click",function(a){var b=e.attr(a.currentTarget,"data");e.hide("#J_ShowEditorPromoTime_"+b),e.show(e.get(".J_EditorPromoTime","#J_Promo_"+b)),e.hide("#J_TimeMsg_"+b);return})},deleteHandle:function(a){new H.widget.msgBox({title:"\u5220\u9664\u6d3b\u52a8",content:"\u7cfb\u7edf\u5c06\u4e3a\u60a8\u53d6\u6d88\u6b64\u6d3b\u52a8\u8bbe\u7f6e\u7684\u4fc3\u9500\u4fe1\u606f",type:"confirm",buttons:[{value:"\u786e\u5b9a\u5220\u9664"},{value:"\u53d6\u6d88"}],success:function(b){if(b=="\u786e\u5b9a\u5220\u9664"){var c=function(a){new H.widget.msgBox({type:"sucess",dialogType:"msg",content:"\u6d3b\u52a8\u5220\u9664\u6210\u529f",autoClose:!0,timeOut:3e3}),window.location.href=currentPageUrl},d=function(a){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})},e="pid="+a+"&form_key="+FORM_KEY;(new H.widget.asyncRequest).setURI(deleteUrl).setMethod("GET").setHandle(c).setErrorHandle(d).setData(e).send()}}})},searchPromoItems:function(){promotionControl.isLoad||(promotionControl.isLoad=!0),e.hide("#promoList"),e.show("#itemList");var a=function(a){e.hide("#J_LeftLoading"),e.show("#J_MainLeftContent"),e.hide("#J_PromoDetail"),e.show("#J_BackToPromoList"),totalRecords=a.payload.totalRecords,totalRecords>0?(e.get("#J_LEmpty").style.display="none",e.removeClass(e.query(".J_PromotionItemBtnHolder"),"ks-hidden")):(e.get("#J_LEmpty").style.display="",e.addClass(e.query(".J_PromotionItemBtnHolder"),"ks-hidden")),e.html("#J_PromoItems",a.payload.body),pageCount=Math.ceil(totalRecords/a.payload.pageNum),promotionControl.paginator=(new b("promotionControl.paginator")).setRender(promotionControl.handlePagination).setPageCount(pageCount).printHtml("#J_PromotionItemPaging",2)},c=function(a){e.show("#promoList"),e.show("#J_PromoDetail"),e.hide("#itemList"),e.hide("#J_BackToPromoList"),new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})};if(e.val(e.get("#J_SearchTitle"))!="\u5173\u952e\u5b57\u3001\u5546\u54c1\u94fe\u63a5\u3001\u5546\u54c1\u7f16\u7801")var d=encodeURIComponent(e.val(e.get("#J_SearchTitle")));else var d="";var f=e.val(e.get("#J_SearchStatus")),g="keytitle="+d+"&status="+f;e.show("#J_LeftLoading"),e.hide("#J_MainLeftContent"),(new H.widget.asyncRequest).setURI(getPromoItemsUrl).setMethod("GET").setHandle(a).setErrorHandle(c).setData(g).setDataType("json").send()},handlePagination:function(a){pageId=a;var b=function(a){totalRecords=a.payload.totalRecords,totalRecords>0?(e.get("#J_LEmpty").style.display="none",e.removeClass(e.get(".J_PromotionItemBtnHolder"),"ks-hidden")):(e.get("#J_LEmpty").style.display="",e.addClass(e.get(".J_PromotionItemBtnHolder"),"ks-hidden")),pageCount=Math.ceil(totalRecords/a.payload.pageNum),e.html("#J_PromoItems",a.payload.body),promotionControl.paginator.setPage(pageId).setPageCount(pageCount).printHtml("#J_PromotionItemPaging",2),e.hide("#J_LeftLoading"),e.show("#J_MainLeftContent")};if(e.val(e.get("#J_SearchTitle"))!="\u5173\u952e\u5b57\u3001\u5546\u54c1\u94fe\u63a5\u3001\u5546\u54c1\u7f16\u7801")var c=encodeURIComponent(e.val(e.get("#J_SearchTitle")));else var c="";var d=e.val(e.get("#J_SearchStatus")),f="keytitle="+c+"&status="+d+"&page_id="+pageId;e.show("#J_LeftLoading"),e.hide("#J_MainLeftContent"),(new H.widget.asyncRequest).setURI(getPromoItemsUrl).setMethod("GET").setHandle(b).setData(f).send()},removePromotionItemHandle:function(a,b,c){if(!showPermissions("editor_promotion","\u7f16\u8f91\u4fc3\u9500\u6d3b\u52a8"))return;if(c=="promoItems")var d=e.val("#J_TypeIdItem_"+a);if(d==10){var f=IsExpired();if(f>-5e3){var g=function(d){promotionControl.deletePromotionItemHandle(a,b,c)},h=function(a){KISSY.Event.fire(".J_TopExpired","click")},i="";(new H.widget.asyncRequest).setURI(isExpiredUrl).setMethod("GET").setHandle(g).setErrorHandle(h).setData(i).send()}else promotionControl.deletePromotionItemHandle(a,b,c)}else promotionControl.deletePromotionItemHandle(a,b,c)},deletePromotionItemHandle:function(a,b,c){itemIds=[],c=="promoItems"&&(e.hide("#J_RemovePromo_"+a),e.show("#J_MinLoading_"+a)),a&&b&&(itemIds.push(a),pid=b);var d=function(a){promotionControl.paginator?promotionControl.paginator.toPage(promotionControl.paginator.page):promotionControl.searchPromoItems()},f="pid="+pid+"&item_ids="+itemIds+"&form_key="+FORM_KEY;(new H.widget.asyncRequest).setURI(removePromotionItemUrl).setMethod("POST").setHandle(d).setData(f).send()}}},{requires:["utils/showPages/index","./mods/check","overlay"]}); 