KISSY.add("page/mods/lottery-char",function(a){var b=a.DOM,c=a.Event,d=a.Anim,e=window.lotteryConfig.lotteryChars,f=window.lotteryConfig.winChars,g=b.query(".J_LotteryItem"),h=[],i=[],j=.3,k=.15,l=window.lotteryConfig.processDuration,m={_scrollItem:function(c,f){var g=this,j=b.get(".J_LotteryScrollWrap",c),l=-1*b.height(j)/2;h[f]&&(h[f].cancel(),h[f]=null),i[f]&&(i[f].stop(),i[f]=null),h[f]=a.later(function(){var a=b.query("img",j),c=a[0],g=a[1],h=e[Math.floor(Math.random()*e.length)];i[f]=(new d(j,{top:l},k,"easeNone",function(){c.src=h,b.append(c,j),b.css(j,{top:0})})).run()},k*1100,!0)},lotteryAnimReset:function(){},lotteryAnimStart:function(){var b=this;a.each(g,function(c,d){a.later(function(){b._scrollItem(c,d)},d*j*1e3,!1)})},lotteryAnimStop:function(c,d,m){var n=this;a.later(function(){a.each(g,function(d,g){a.later(function(){var a=b.get(".J_LotteryScrollWrap",d),j=-1*b.height(a)/2,k=b.query("img",a),l=k[0],n=k[1],o;h[g]&&h[g].cancel(),i[g]&&i[g].stop(!0),g==Math.floor(Math.random()*e.length)?o=c?f[m][0]:f[2][0]:o=c?f[m][0]:e[Math.floor(Math.random()*e.length)],l.src=o,n.src=o},g*j*1e3,!1)}),a.later(function(){a.isFunction(d)&&d()},g.length*(j+k)*1e3,!1)},l*1e3,!1)}};return m}),KISSY.add("page/mods/lottery-popup",function(a,b,c,d){var e=a.Event,f=new b.Popup({prefixCls:"lottery-",elCls:"lottery-popup-root",zIndex:99999,content:"",closable:!0,mask:!0});e.on(window,"resize",function(a){f.center()});var g={show:function(a){var b=a.payload.code,e=d.MAP_RESULT[b],g;g=c(d.TPLT).render(e),f.set("content",g),f.center(),f.show()},hide:function(){f.set("content",""),f.hide()}};return g},{requires:["overlay","template","./lottery-tplt"]}),KISSY.add("page/mods/lottery-tplt",function(a){var b='<div class="lottery-popup-content {{icon_cls}}"><div class="lottery-popup-title"><p class="lottery-popup-title-main">{{title_main}}</p><p class="lottery-popup-title-sub">{{#if data}} {{data}} {{/if}}{{title_sub}}</p></div><div class="lottery-popup-button">{{#each buttons as button}}<a href="{{button.href}}" class="{{button.cls}}">{{button.text}}</a>{{/each}}</div></div>',c={1:{title_main:"\u4eb2\uff0c\u60a8\u8fd8\u4e0d\u662f\u6b22\u4e50\u901b\u7684\u7528\u6237<br />\u6682\u65f6\u65e0\u6cd5\u62bd\u5956\u54e6\uff01",title_sub:"\u60a8\u53ef\u4ee5\u5148\u5f00\u901a\u514d\u8d39\u7248\u518d\u6765\u62bd\u5956",icon_cls:"lottery-icon-1",buttons:[{text:"\u5f00\u901a\u514d\u8d39\u7248",cls:"",href:"http://fuwu.taobao.com/ser/assembleParam.htm?subParams=itemCode:appstore-10687-1,cycleNum:12,cycleUnit:2"}]},2:{title_main:"\u4eb2\uff0c\u606d\u559c\u60a8\u62bd\u4e2d\u201c\u514d\u8d39\u5b63\u5ea6\u5c0a\u4eab\u7248\u201d\u5566",title_sub:"\u60a8\u53ea\u8981\u9000\u51fa\u5e76\u91cd\u65b0\u767b\u5f55\u8f6f\u4ef6\uff0c\u7cfb\u7edf\u5c31\u4f1a\u81ea\u52a8\u5e2e\u60a8\u5347\u7ea7\u54e6",icon_cls:"lottery-icon-2",buttons:[{text:"\u786e\u5b9a",cls:"J_LotteryPopHide",href:""}]},3:{title_main:"\u4eb2\uff0c\u624b\u6c14\u4e0d\u662f\u5f88\u597d\u54e6\uff01",title_sub:"\u4e0d\u8981\u6c14\u9981\uff0c\u540e\u7eed\u8fd8\u6709\u66f4\u591a\u6d3b\u52a8\u54e6",icon_cls:"lottery-icon-3",buttons:[{text:"\u786e\u5b9a",cls:"J_LotteryPopHide",href:""}]},4:{title_main:"\u4eb2\uff0c\u8bf7\u5148\u767b\u5f55\u54e6\uff01",title_sub:"\u7acb\u523b\u767b\u5f55\uff0c\u53c2\u4e0e\u62bd\u5956",icon_cls:"lottery-icon-4",buttons:[{text:"\u7acb\u523b\u767b\u5f55",cls:"J_LotteryLogin",href:"https://oauth.taobao.com/authorize?client_id=12029422&response_type=code&redirect_uri=http://tb.huanleguang.com/"}]},5:{title_main:"\u4eb2\uff0c\u606d\u559c\u60a8\u62bd\u4e2d\u201c\u8bfa\u57fa\u4e9a\u624b\u673a\u201d\u5566",title_sub:'\u901f\u901f\u67e5\u770b<a target="_blank" href="http://bangpai.taobao.com/group/thread/609027-282269816.htm?spm=0.0.0.0.Ssas6x">\u3010\u9886\u53d6\u6ce8\u610f\u4e8b\u9879\u3011</a>\u5427\uff01',icon_cls:"lottery-icon-2",buttons:[{text:"\u786e\u5b9a",cls:"J_LotteryPopHide",href:""}]},6:{title_main:"\u4eb2\uff0c\u6bcf\u4e2a\u4eba\u53ea\u6709\u4e00\u6b21\u62bd\u5956\u673a\u4f1a\u54e6\uff01",title_sub:" ",icon_cls:"lottery-icon-6",buttons:[{text:"\u786e\u5b9a",cls:"J_LotteryPopHide",href:""}]},7:{title_main:"\u6d3b\u52a8\u592a\u706b\u7206\u4e86\uff0c\u7a0d\u7b49\u4e00\u4f1a\u513f\u3002",title_sub:"\u518d\u6765\u8bd5\u4e00\u6b21\u5427\uff01",icon_cls:"lottery-icon-5",buttons:[{text:"\u786e\u5b9a",cls:"J_LotteryPopHide",href:""}]},8:{title_main:"\u4eb2\uff0c\u8be5\u6d3b\u52a8\u8fd8\u672a\u5f00\u59cb\u54e6\uff01",title_sub:"\u8bf7\u60a8\u5728\u6d3b\u52a8\u5f00\u59cb\u4e4b\u540e\u518d\u6765\u62bd\u5956\u54e6",icon_cls:"lottery-icon-8",buttons:[{text:"\u786e\u5b9a",cls:"J_LotteryPopHide",href:""}]},9:{title_main:"\u4eb2\uff0c\u4e0d\u597d\u610f\u601d",title_sub:"\u8be5\u6d3b\u52a8\u5df2\u7ecf\u7ed3\u675f\u4e86\u54e6",icon_cls:"lottery-icon-8",buttons:[{text:"\u786e\u5b9a",cls:"J_LotteryPopHide",href:""}]}};return{TPLT:b,MAP_RESULT:c}}),KISSY.add("utils/roll/index",function(a){function i(a,c,d){var e=this;if(!(e instanceof i))return new i(a,c,d);this.tab=b.get(a),this.speed=d;var f=b.children(this.tab);if(f.length!=2)return;this.tab1=f[0],this.tab2=f[1],e.init(c)}var b=a.DOM,c=a.Event,d=document,e="left",f="right",g="up",h="down";return a.mix(i.prototype,{init:function(d){var i=this;if(d==""||typeof d=="undefined")d=g;switch(d){case g:b.html(i.tab2,b.html(i.tab1));function j(){i.tab2.offsetTop-i.tab.scrollTop<=0?i.tab.scrollTop-=i.tab1.offsetHeight:i.tab.scrollTop++}i.timer=a.later(j,i.speed,!0,null,null),c.on(i.tab,"mouseenter mouseleave",function(b){b.type=="mouseenter"?i.timer.cancel():i.timer=a.later(j,i.speed,!0,null,null)});break;case h:b.html(i.tab2,b.html(i.tab1)),i.tab.scrollTop=i.tab.scrollHeight;function k(){i.tab1.offsetTop-i.tab.scrollTop>=0?i.tab.scrollTop+=i.tab2.offsetHeight:i.tab.scrollTop--}i.timer=a.later(k,i.speed,!0,null,null),c.on(i.tab,"mouseenter mouseleave",function(b){b.type=="mouseenter"?i.timer.cancel():i.timer=a.later(k,i.speed,!0,null,null)});break;case e:alert("left");break;case f:alert("right")}}}),i}),KISSY.add("page/lottery-core",function(a,b,c,d){var e=a.DOM,f=a.Event,g=document.body,h={init:function(){var a=this,b=e.get(".J_LotteryButton");if(!b)return;a.lotteryButton=b,a._updateButtonEvent(a._lottery),a._initEventMap();var c=KISSY.DOM.children("#J_WinnerListUl");c.length>8&&new d("#J_WinnerList","up",100)},_updateButtonEvent:function(a){var b=this.lotteryButton;f.remove(b,"click"),f.on(b,"click",a,this)},_lottery:function(a){a.preventDefault();var b=this;b._lotteryQuery()},_lotteryQuery:function(){var d=this;d._updateButtonEvent(d._showLotterying),b.lotteryAnimStart(),a.io({url:window.lotteryConfig.api.lotteryURI,type:"get",data:{_tb_token_:window.lotteryConfig.token},dataType:"json",success:function(a){var e=a.payload.status==="success",f=a.payload.type;b.lotteryAnimStop(e,function(){switch(a.payload.code){case"1":case 1:d._updateButtonEvent(d._showLotteryOrder);break;case 4:case"4":d._updateButtonEvent(d._showLotteryLogin);break;case 6:case"6":d._updateButtonEvent(d._showLotteryChanceOver);break;case 8:case"8":d._updateButtonEvent(d._showLotteryLimit);break;case 9:case"9":d._updateButtonEvent(d._showLotteryExpired);break;default:d._updateButtonEvent(d._lottery)}c.show(a)},f)},error:function(a,e,f){b.lotteryAnimStop(!1,function(){c.show({payload:{code:7}}),d._updateButtonEvent(d._lottery)})}})},_initEventMap:function(){var a=this;f.delegate(g,"click",".J_LotteryPopHide",function(a){a.preventDefault(),c.hide()}),f.delegate(g,"click",".J_LotteryShare",function(a){a.preventDefault()})},_showLotterying:function(a){a&&a.preventDefault&&a.preventDefault()},_showLotteryOrder:function(a){a&&a.preventDefault&&a.preventDefault(),c.show({payload:{code:1}})},_showLotteryLogin:function(a){a&&a.preventDefault&&a.preventDefault(),c.show({payload:{code:4}})},_showLotteryChanceOver:function(a){a&&a.preventDefault&&a.preventDefault(),c.show({payload:{code:6}})},_showLotteryLimit:function(a){a&&a.preventDefault&&a.preventDefault(),c.show({payload:{code:8}})},_showLotteryExpired:function(a){a&&a.preventDefault&&a.preventDefault(),c.show({payload:{code:9}})}};return h},{requires:["./mods/lottery-char","./mods/lottery-popup","utils/roll/index"]}); 