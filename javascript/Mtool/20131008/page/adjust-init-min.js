KISSY.add("utils/showPages/index",function(a){function e(a){var b=this;if(!(b instanceof e))return new e(a);this.pageNum=4,this.name=a,this.page=1,this.pageCount=200,this.argName="page"}var b=a.DOM,c=a.Event,d=document;return a.mix(e.prototype,{jump:function(){return undefined},checkPages:function(){isNaN(parseInt(this.page))&&(this.page=1),isNaN(parseInt(this.pageCount))&&(this.pageCount=1),this.page<1&&(this.page=1),this.pageCount<1&&(this.pageCount=1),this.page>this.pageCount&&(this.page=this.pageCount),this.page=parseInt(this.page),this.pageCount=parseInt(this.pageCount)},_createHtml:function(a){var b=this,c="",d=this.page-1,e=this.page+1;if(a==""||typeof a=="undefined")a=1;switch(a){case 1:c+='<div class="page-bottom"> <div class="sabrosus">',c+='<font class="number">',c+="\u5171"+this.pageCount+"\u9875&nbsp;",c+='<input style="" type="text"  class="page-input" id="pageInput'+b.name+'"  value="\u9875\u7801" onkeypress="return window.'+b.name+".formatInputPage(event);\" onfocus=\"this.className='page-input page-input-text-on ';if(this.value=='\u9875\u7801'){this.value = '';}\" onblur=\"this.className='page-input';if(this.value==''){this.value = '\u9875\u7801'}\">",c+='<input type="button" value="Go" class="btm-go" onclick="javascript:var page = document.getElementById(\'pageInput'+b.name+"').value; if(isNaN(Number(page))|| Number(page)==0) { var turnTo = 1;} else if(page>"+this.pageCount+"){ var turnTo = "+this.pageCount+";} else{var turnTo = page;}  window."+b.name+'.toPage(turnTo);" >',c+="</font>",d<1?c+='<span class="pre-none page-pic-no"></span>':c+='<span title="\u4e0a\u4e00\u9875" class="pre page-pic-no" onclick="'+b.name+".toPage("+d+');"></span>',e>this.pageCount?c+='<span class="next-none page-pic-no"></span>':c+='<span title="\u4e0b\u4e00\u9875" class="next page-pic-no" onclick="'+b.name+".toPage("+e+');"></span>',c+='<div style="clear:both"></div></div></div> ';break;case 2:if(this.pageCount>1){c+='<div class="page-bottom"> <div class="sabrosus">',this.pageCount>5&&(c+='<font class="number">',c+="\u5171"+this.pageCount+"\u9875&nbsp;",c+='<input style="" type="text"  class="page-input" id="pageInput'+b.name+'"  value="\u9875\u7801" onkeypress="return window.'+b.name+".formatInputPage(event);\" onfocus=\"this.className='page-input page-input-text-on ';if(this.value=='\u9875\u7801'){this.value = '';}\" onblur=\"this.className='page-input';if(this.value==''){this.value = '\u9875\u7801'}\">",c+='<input type="button" value="Go" class="btm-go" onclick="javascript:var page = document.getElementById(\'pageInput'+b.name+"').value; if(isNaN(Number(page))|| Number(page)==0) { var turnTo = 1;} else if(page>"+this.pageCount+"){ var turnTo = "+this.pageCount+";} else{var turnTo = page;}  window."+b.name+'.toPage(turnTo);" >',c+="</font>"),d<1?c+='<span class="pre-none page-pic-no"></span>':c+='<span title="\u4e0a\u4e00\u9875" class="pre page-pic-no" onclick="'+b.name+".toPage("+d+');"></span>',this.page==1;if(this.page-2<=0){var f=1;if(this.pageCount>this.page+4)var g=this.page+4;else var g=this.pageCount}else if(this.page+2>=this.pageCount){var f=this.pageCount-4;if(this.pageCount>this.page+4)var g=this.page+4;else var g=this.pageCount}else{var f=this.page-2;if(this.pageCount>this.page+2)var g=this.page+2;else var g=this.pageCount}for(var h=f;h<=g;h++)h>0&&(h==this.page?c+='<span class="current a-padding">'+h+"</span>":c+='<a class="a-padding" href="javascript:'+b.name+".toPage("+h+');">'+h+"</a>");this.page+5<this.pageCount&&(c+='<a class="a-padding" title="" href="javascript:'+b.name+".toPage("+(this.page+3)+');">...</a>'),this.page==this.pageCount,e>this.pageCount?c+='<span class="next-none page-pic-no"></span>':c+='<span title="\u4e0b\u4e00\u9875" class="next page-pic-no" onclick="'+b.name+".toPage("+e+');"></span>',c+='<div style="clear:both"></div></div></div> '}break;case 3:c+='<div class="page-top"><div class="sabrosus"><span class="count">'+this.page+" / "+this.pageCount+"</span>",d<1?c+=' <span class="pre-none page-pic-no"></span>':c+='<a class="border-left-dedede" href="javascript:'+b.name+".toPage("+d+');" title="\u4e0a\u4e00\u9875"><span class="pre page-pic-no"></span></a>',e>this.pageCount?c+='<span class="next-none page-pic-no"></span>':c+='<a href="javascript:'+b.name+".toPage("+e+');" title="\u4e0b\u4e00\u9875"><span class="next page-pic-no"></span></a>',c+='<div style="clear:both"></div></div></div>'}return c},formatInputPage:function(a){var b=navigator.appName=="Microsoft Internet Explorer"?!0:!1;if(!b)var c=a.which;else var c=event.keyCode;return c==8||c==46||c>=48&&c<=57?!0:!1},toPage:function(a,b){var c=1,d=this;typeof a=="object"?c=a.options[a.selectedIndex].value:c=a,d.jump(c,b,"")},printHtml:function(a,c){return this.checkPages(),b.html(a,this._createHtml(c)),this},setPageCount:function(a){return this.pageCount=a,this},getPageCount:function(){return this.pageCount},setRender:function(a){return this.jump=a,this},setPageNum:function(a){return this.pageNum=a,this},setPage:function(a){return this.page=a,this}}),e}),KISSY.add("page/adjust-init",function(a,b,c){var a=KISSY,d=a.DOM,e=a.Event;return adjust={itemIds:new Array,itemArr:new Array,panel:null,panelItemPaginator:null,panelPageNum:8,msg:null,init:function(){e.add("#J_CheckAll","click",function(){d.attr("#J_CheckAll","checked")==1||d.attr("#J_CheckAll","checked")=="checked"?d.attr(".J_CheckBox","checked",!0):a.each(a.all(".J_CheckBox"),function(a,b){a.checked=!1});return}),e.add("#J_LoadItemsButton","click",function(){var b=new Array,c=document.getElementsByName("category[]");a.each(a.all(c),function(a,c){a.checked==1&&b.push(a.value)});if(b.length==0){alert("\u8bf7\u9009\u62e9\u8981\u52a0\u8f7d\u7684\u5206\u7c7b\uff01");return}new H.widget.msgBox({type:"error",content:"\u6b63\u5728\u63d0\u4ea4\uff0c\u8bf7\u7a0d\u5019\uff01",dialogType:"loading"});var d=function(a){var b=a.payload.items;for(var c=0;c<b.length;c++)addOneLine(b[c]);MSG.hide()},e=function(a){MSG.hide(),MSG.setMsg(a.desc).showDialog();return},f="isAjax=1&cats="+encodeURIComponent(JSON.stringify(b));(new H.widget.asyncRequest).setURI(getItemsByCatAjaxUrl).setMethod("POST").setHandle(d).setErrorHandle(e).setData(f).send();return}),e.add("#J_SubButton","click",function(){if(adjust.itemIds.length==0)return alert("\u8bf7\u6dfb\u52a0\u5b9d\u8d1d\uff01"),!1;new H.widget.msgBox({type:"error",content:"\u6b63\u5728\u63d0\u4ea4\uff0c\u8bf7\u7a0d\u5019\uff01",dialogType:"loading"}),d.val("#J_ItemIds",adjust.itemIds.join(",")),d.get("#J_ListForm").submit();return})},openTbItemsDialog:function(){var a=d.html("#J_SellerCats");if(!adjust.panel){var b='<div style="width:620px;height:500px;"><div class="baobei-edit"><div class="new-baobei"><div class="seach" style="width:610px; height:32px;margin-top:10px;">\u540d\u79f0\uff1a<input type="text" id="J_SearchTitle" class="input-text-2" value="" size="26"/>&nbsp;		<select name="approveStatus" id="J_SearchSelling" class="noneReset haahha">			<option value="1">\u9500\u552e\u4e2d</option>			<option value="2">\u4ed3\u5e93\u4e2d</option>		</select>&nbsp;		<select name="order" id="J_SelectItemOrder" class="noneReset">			<option value="0">\u6700\u665a\u4e0b\u67b6</option>			<option value="1">\u6700\u5feb\u4e0b\u67b6</option>		</select>&nbsp;&nbsp;<select name="cid" id="J_SelectItemCid" class="noneReset">'+a+"</select>"+'&nbsp;&nbsp;<a onclick="adjust.loadTbItems();">\u641c\u7d22</a>'+"</div>"+'<ul class="new-baobei-list">'+'<div style="width:20px;">&nbsp;</div>'+'<div style="width:80px;">&nbsp;</div>'+'<div style="width:200px;text-align:center;">\u540d\u79f0</div>'+'<div style="width:80px;text-align:center;">\u5df2\u52a0\u5165\u8ba1\u5212</div>'+'<div style="width:150px;text-align:center;">\u4e0b\u67b6\u65f6\u95f4</div>'+"</ul>"+'<ul class="new-baobei-list" id="J_ItemList"></ul>'+'<div id="J_Paging" class="ui-page Rpage"></div>'+"</div>";adjust.panel=new c.Dialog({width:660,bodyContent:b,mask:!1,buttons:[{text:"\u786e\u5b9a",elCls:"bui-button bui-button-primary",handler:function(){this.hide()}},{text:"\u5173\u95ed",elCls:"bui-button",handler:function(){this.hide()}}],align:{points:["cc","cc"]},closable:!0,draggable:!0,aria:!0}),adjust.panel.set("title","\u8bc4\u5206\u8be6\u60c5"),adjust.panel.show()}adjust.panel.show()},totalChecked:function(b){d.attr(b,"checked")==1||d.attr(b,"checked")=="checked"?a.each(a.all(".J_TbCheckBox"),function(a,b){a.disabled!=1&&(a.checked=!0)}):a.each(a.all(".J_TbCheckBox"),function(a,b){a.checked=!1});return},loadTbItems:function(){var a=function(a){adjust.msg.hide(),totalRecords=a.payload.totalRecords;if(!(totalRecords>0)){d.get("#J_Paging").style.display="none",adjust.msg.hide(),d.html(d.get("#J_ItemList"),"");return}d.get("#J_Paging").style.display="",pageCount=Math.ceil(totalRecords/adjust.panelPageNum),adjust.rederTbItems(a.payload.items);var c=function(a){var b=a,c=function(a){adjust.msg.hide(),totalRecords=a.payload.totalRecords,pageCount=Math.ceil(totalRecords/adjust.panelPageNum),adjust.rederTbItems(a.payload.items),adjust.msg.hide(),adjust.panelItemPaginator.setPage(b).setPageCount(pageCount).printHtml("#J_Paging",2)},e=d.val(d.get("#J_SelectItemCid")),f=d.val(d.get("#J_SearchSelling")),g=encodeURIComponent(d.val(d.get("#J_SearchTitle"))),h=d.val(d.get("#J_SelectItemOrder")),i="cid="+e+"&type="+f+"&order="+h+"&q="+g+"&page_id="+b;adjust.msg=H.widget.msgBox({type:"error",content:"\u6b63\u5728\u63d0\u4ea4\uff0c\u8bf7\u7a0d\u5019\uff01",dialogType:"loading"}),(new H.widget.asyncRequest).setURI(getItemsFromTbUrl).setMethod("GET").setHandle(c).setData(i).send()};adjust.panelItemPaginator=(new b("adjust.panelItemPaginator")).setRender(c).setPageCount(pageCount).printHtml("#J_Paging",2)},c=function(a){adjust.msg.hide(),adjust.msg.setMsg(a.desc).show(),adjust.msg.hide()},e=d.val(d.get("#J_SelectItemCid")),f=d.val(d.get("#J_SearchSelling")),g=encodeURIComponent(d.val(d.get("#J_SearchTitle"))),h=d.val(d.get("#J_SelectItemOrder")),i="cid="+e+"&type="+f+"&order="+h+"&q="+g+"&page_id=1";adjust.msg=H.widget.msgBox({type:"error",content:"\u6b63\u5728\u63d0\u4ea4\uff0c\u8bf7\u7a0d\u5019\uff01",dialogType:"loading"}),(new H.widget.asyncRequest).setURI(getItemsFromTbUrl).setMethod("GET").setHandle(a).setErrorHandle(c).setData(i).send()},rederTbItems:function(b){var c=b.length,e="";for(var f=0;f<c;f++){if(a.inArray(""+b[f].num_iid,adjust.itemIds))var g='checked="checked" ';else var g="";if(b[f].add_plan_enabled=="0")var h='disabled="disabled"',i='style="display:none"',j="\u662f";else var h="",i='style="display:"',j="\u5426";e+='<li id="Ltr-'+b[f].num_iid+'">'+'<input type="hidden" id="J_item_title_'+b[f].num_iid+'" value="'+b[f].title+'" />'+'<input type="hidden" id="J_pic_url_'+b[f].num_iid+'" value="'+b[f].pic_url+'" />'+'<input type="hidden" id="J_list_time_'+b[f].num_iid+'" value="'+b[f].list_time+'" />'+'<input type="hidden" id="J_delist_time_'+b[f].num_iid+'" value="'+b[f].delist_time+'" />'+'<div style="width:20px;"><input type="checkbox" class="J_TbCheckBox" id="J_CB_'+b[f].num_iid+'" value="'+b[f].num_iid+'"'+g+h+"/></div>"+'<div style="width:80px;"><a target="_blank" href="http://item.taobao.com/item.htm?id='+b[f].num_iid+'"><img height="30" width="40" src="'+b[f].pic_url+'"></img></a></div>'+'<div style="width:200px;">'+b[f].title+"</div>"+'<div style="width:80px;text-align:center;">'+j+"</div>"+'<div style="width:150px;">'+b[f].delist_time+"</div>",e+='<div style="width:60px;"><a '+i+'id="J_AddLink_'+b[f].num_iid+'" onclick="adjust.addItem(\''+b[f].num_iid+"')\" >\u6dfb\u52a0</a>",e+="</div></li>"}e+='<li style="border-bottom:0;"><input type="checkbox" onclick="adjust.totalChecked(this);" id="J_TotalChecked"><label for="J_TotalChecked">&nbsp;&nbsp;\u5168\u9009</label>&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" class="btm-caozuo-gray" style="float:none;" onclick="adjust.addItems();" value="\u6dfb\u52a0">&nbsp;<span id="J_AddItemsTip"></span></li>',d.html(d.get("#J_ItemList"),e)},addItem:function(b){if(a.inArray(b,adjust.itemIds))return;var c=d.val("#J_item_title_"+b),e=d.val("#J_pic_url_"+b),f=a.get("#J_ItemUl"),g="<li id='J_ItemLi_"+b+"' class='list-item border-e4e4e4-b-d'><div class='list-div'><ul class=''>";g+='<li style="width:10%;text-align:left;clear:none;"><input type="checkbox" class="J_CheckBox" name="ids[]" value="'+b+'"/></li>',g+='<li style="width:20%;text-align:left;clear:none;"><a target="_blank" href="http://item.taobao.com/item.htm?id='+b+'"><img height="30" width="40" src="'+e+'"></img></a></li>',g+='<li style="width:35%;text-align:left;clear:none;">'+c+"</li>",g+='<li style="width:20%;text-align:left;clear:none;"><a onClick="adjust.delItem(\''+b+"')\">\u5220\u9664</a></li>";var h=new a.Node(g);d.append(h,f),adjust.itemIds.push(""+b),d.text("#J_ItemTableNum",parseInt(d.text("#J_ItemTableNum"))+1),d.attr("#J_CB_"+b,"checked",!0),d.html(d.parent(d.get("#J_AddLink_"+b),"div"),"\u5df2\u6dfb\u52a0");return},addItems:function(){d.html("#J_AddItemsTip",""),a.each(a.all(".J_TbCheckBox"),function(a,b){a.checked&&adjust.addItem(a.value)}),d.html("#J_AddItemsTip","\u6dfb\u52a0\u6210\u529f\uff01")},delItem:function(b){d.remove("#J_ItemLi_"+b);var c=a.indexOf(b,adjust.itemIds);c!=-1&&adjust.itemIds.splice(c,1),d.text("#J_ItemTableNum",parseInt(d.text("#J_ItemTableNum")-1));return},delItems:function(){a.each(a.all(".J_CheckBox"),function(a,b){a.checked&&adjust.delItem(""+a.value)})}}},{requires:["utils/showPages/index","bui/overlay"]}); 