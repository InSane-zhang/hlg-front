KISSY.add("utils/showPages/index",function(a){function e(a){var b=this;if(!(b instanceof e))return new e(a);this.pageNum=4,this.name=a,this.page=1,this.pageCount=200,this.argName="page"}var b=a.DOM,c=a.Event,d=document;return a.mix(e.prototype,{jump:function(){return undefined},checkPages:function(){isNaN(parseInt(this.page))&&(this.page=1),isNaN(parseInt(this.pageCount))&&(this.pageCount=1),this.page<1&&(this.page=1),this.pageCount<1&&(this.pageCount=1),this.page>this.pageCount&&(this.page=this.pageCount),this.page=parseInt(this.page),this.pageCount=parseInt(this.pageCount)},_createHtml:function(a){var b=this,c="",d=this.page-1,e=this.page+1;if(a==""||typeof a=="undefined")a=1;switch(a){case 1:c+='<div class="page-bottom"> <div class="sabrosus">',c+='<font class="number">',c+="\u5171"+this.pageCount+"\u9875&nbsp;",c+='<input style="" type="text"  class="page-input" id="pageInput'+b.name+'"  value="\u9875\u7801" onkeypress="return window.'+b.name+".formatInputPage(event);\" onfocus=\"this.className='page-input page-input-text-on ';if(this.value=='\u9875\u7801'){this.value = '';}\" onblur=\"this.className='page-input';if(this.value==''){this.value = '\u9875\u7801'}\">",c+='<input type="button" value="Go" class="btm-go" onclick="javascript:var page = document.getElementById(\'pageInput'+b.name+"').value; if(isNaN(Number(page))|| Number(page)==0) { var turnTo = 1;} else if(page>"+this.pageCount+"){ var turnTo = "+this.pageCount+";} else{var turnTo = page;}  window."+b.name+'.toPage(turnTo);" >',c+="</font>",d<1?c+='<span class="pre-none page-pic-no"></span>':c+='<span title="\u4e0a\u4e00\u9875" class="pre page-pic-no" onclick="'+b.name+".toPage("+d+');"></span>',e>this.pageCount?c+='<span class="next-none page-pic-no"></span>':c+='<span title="\u4e0b\u4e00\u9875" class="next page-pic-no" onclick="'+b.name+".toPage("+e+');"></span>',c+='<div style="clear:both"></div></div></div> ';break;case 2:if(this.pageCount>1){c+='<div class="page-bottom"> <div class="sabrosus">',this.pageCount>5&&(c+='<font class="number">',c+="\u5171"+this.pageCount+"\u9875&nbsp;",c+='<input style="" type="text"  class="page-input" id="pageInput'+b.name+'"  value="\u9875\u7801" onkeypress="return window.'+b.name+".formatInputPage(event);\" onfocus=\"this.className='page-input page-input-text-on ';if(this.value=='\u9875\u7801'){this.value = '';}\" onblur=\"this.className='page-input';if(this.value==''){this.value = '\u9875\u7801'}\">",c+='<input type="button" value="Go" class="btm-go" onclick="javascript:var page = document.getElementById(\'pageInput'+b.name+"').value; if(isNaN(Number(page))|| Number(page)==0) { var turnTo = 1;} else if(page>"+this.pageCount+"){ var turnTo = "+this.pageCount+";} else{var turnTo = page;}  window."+b.name+'.toPage(turnTo);" >',c+="</font>"),d<1?c+='<span class="pre-none page-pic-no"></span>':c+='<span title="\u4e0a\u4e00\u9875" class="pre page-pic-no" onclick="'+b.name+".toPage("+d+');"></span>',this.page==1;if(this.page-2<=0){var f=1;if(this.pageCount>this.page+4)var g=this.page+4;else var g=this.pageCount}else if(this.page+2>=this.pageCount){var f=this.pageCount-4;if(this.pageCount>this.page+4)var g=this.page+4;else var g=this.pageCount}else{var f=this.page-2;if(this.pageCount>this.page+2)var g=this.page+2;else var g=this.pageCount}for(var h=f;h<=g;h++)h>0&&(h==this.page?c+='<span class="current a-padding">'+h+"</span>":c+='<a class="a-padding" href="javascript:'+b.name+".toPage("+h+');">'+h+"</a>");this.page+5<this.pageCount&&(c+='<a class="a-padding" title="" href="javascript:'+b.name+".toPage("+(this.page+3)+');">...</a>'),this.page==this.pageCount,e>this.pageCount?c+='<span class="next-none page-pic-no"></span>':c+='<span title="\u4e0b\u4e00\u9875" class="next page-pic-no" onclick="'+b.name+".toPage("+e+');"></span>',c+='<div style="clear:both"></div></div></div> '}break;case 3:c+='<div class="page-top"><div class="sabrosus"><span class="count">'+this.page+" / "+this.pageCount+"</span>",d<1?c+=' <span class="pre-none page-pic-no"></span>':c+='<a class="border-left-dedede" href="javascript:'+b.name+".toPage("+d+');" title="\u4e0a\u4e00\u9875"><span class="pre page-pic-no"></span></a>',e>this.pageCount?c+='<span class="next-none page-pic-no"></span>':c+='<a href="javascript:'+b.name+".toPage("+e+');" title="\u4e0b\u4e00\u9875"><span class="next page-pic-no"></span></a>',c+='<div style="clear:both"></div></div></div>'}return c},formatInputPage:function(a){var b=navigator.appName=="Microsoft Internet Explorer"?!0:!1;if(!b)var c=a.which;else var c=event.keyCode;return c==8||c==46||c>=48&&c<=57?!0:!1},toPage:function(a,b){var c=1,d=this;typeof a=="object"?c=a.options[a.selectedIndex].value:c=a,d.jump(c,b,"")},printHtml:function(a,c){return this.checkPages(),b.html(a,this._createHtml(c)),this},setPageCount:function(a){return this.pageCount=a,this},getPageCount:function(){return this.pageCount},setRender:function(a){return this.jump=a,this},setPageNum:function(a){return this.pageNum=a,this},setPage:function(a){return this.page=a,this}}),e}),KISSY.add("page/babylibraryIndex-init",function(a,b,c,d){var e=a.DOM,f=a.Event;return babylibraryControl={paginator:null,panel:null,msg:null,msg1:null,inputChangeFlag:null,checkBoxs:null,init:function(){var a=new d.Tip({trigger:"#J_promptHelp0",alignType:"top",offset:10,elCls:"ui-tip",title:'<div class="ui-tip-text">\u5728\u6253\u5370\u53d1\u8d27\u5355\u65f6\u663e\u793a\uff0c\u65b9\u4fbf\u914d\u8d27\u5458\u53d1\u8d27</div>'});a.render();var b=new d.Tip({trigger:"#J_promptHelp1",alignType:"top",offset:10,autoRender:"true",elCls:"ui-tip",title:'<div class="ui-tip-text">\u8bbe\u7f6e\u5b9d\u8d1d\u5b9d\u8d1d\u6210\u672c\u4ef7\uff0c\u4e86\u89e3\u5e97\u94fa\u8d22\u52a1<br>\u52a8\u6001<a  id="J_searchProfit" onclick="window.location.href=getBusinessUrl;"  style="margin-left:5px;">\u67e5\u770b\u6210\u4ea4\u5229\u6da6</a></div>'});b.render();var g=new d.Tip({trigger:"#J_promptHelp2",alignType:"top",offset:10,elCls:"ui-tip",title:'<div class="ui-tip-text">\u540c\u6b65\u6dd8\u5b9d\u5546\u5bb6\u7f16\u7801,\u65b9\u4fbf\u7ba1\u7406\u5b9d\u8d1d</div>'});g.render(),f.on("#J_SyncItemsButton","click",function(a){var b=function(a){babylibraryControl.msg1.hide(),new H.widget.msgBox({type:"sucess",content:"\u5b9d\u8d1d\u540c\u6b65\u6210\u529f",dialogType:"msg",autoClose:!0,timeOut:3e3})},c=function(a){babylibraryControl.msg1.hide(),new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"});return};babylibraryControl.msg1=new H.widget.msgBox({dialogType:"loading",content:"\u6b63\u5728\u540c\u6b65\u5b9d\u8d1d\uff0c\u8bf7\u7a0d\u540e..."});var d="";(new H.widget.asyncRequest).setURI(syncItemsUrl).setHandle(b).setMethod("GET").setData(null).send()}),f.on(".J_ChooseType","click",function(a){e.removeClass(e.query(".J_ChooseType"),"current"),e.addClass(a.currentTarget,"current");var b=e.attr(a.currentTarget,"data");e.val("#J_SearchType",b),b==5?e.html("#J_SortName","\u5229\u6da6\u4ef7"):e.html("#J_SortName","&nbsp;"),babylibraryControl.searchTbItems()}),babylibraryControl.searchTbItems(),f.on("#J_SearchBtn","click",babylibraryControl.searchTbItems),f.on("#J_TCheckAll","click",babylibraryControl.CheckAll),f.delegate(document,"click",".J_ListUpTime",function(a){var b=e.attr(a.currentTarget,"data"),c=e.get("#J_ChooseRoleContent_"+b);e.css("#J_ChooseRoleContent_"+b,"visibility","visible")}),f.delegate(document,"click",".J_iconDeletelink",function(a){e.css(".J_ChooseRoleContent","visibility","hidden")}),f.delegate(document,"click",".J_submit",function(a){var b=e.attr(a.currentTarget,"data");e.css("#J_ChooseRoleContent_"+b,"visibility","hidden");var c=e.val("#J_startDate"+b),d=function(a){babylibraryControl.paginator?babylibraryControl.paginator.toPage(babylibraryControl.paginator.page):babylibraryControl.searchTbItems()},f="item_id="+b+"&listing_time="+c;(new H.widget.asyncRequest).setURI(timingListingUrl).setMethod("GET").setHandle(d).setData(f).send()}),f.delegate(document,"click",".J_ListUp",function(a){var b=e.attr(a.currentTarget,"data"),c=function(a){babylibraryControl.paginator?babylibraryControl.paginator.toPage(babylibraryControl.paginator.page):babylibraryControl.searchTbItems()},d="item_id="+b;(new H.widget.asyncRequest).setURI(listUpUrl).setMethod("GET").setHandle(c).setData(d).send()}),f.delegate(document,"click",".J_ListDown",function(a){var b=e.attr(a.currentTarget,"data"),c=function(a){babylibraryControl.paginator?babylibraryControl.paginator.toPage(babylibraryControl.paginator.page):babylibraryControl.searchTbItems()},d="item_id="+b;(new H.widget.asyncRequest).setURI(listDownUrl).setMethod("GET").setHandle(c).setData(d).send()}),f.delegate(document,"click",".J_EditTiger",function(a){var b=e.parent(a.currentTarget);e.addClass(b,"hover"),e.get("input",b).focus()}),f.delegate(document,"focusout",".J_Huohao",function(a){var b=e.attr(a.currentTarget,"data");KISSY.later(function(){e.removeClass("#J_HuohaoBox"+b,"hover")},200,!1,null)}),f.delegate(document,"focusout",".J_OriginPrice",function(a){var b=e.attr(a.currentTarget,"data");KISSY.later(function(){e.removeClass("#J_OriginPriceBox"+b,"hover")},200,!1,null)}),f.delegate(document,"focusout",".J_ShortTitle",function(a){var b=e.attr(a.currentTarget,"data");KISSY.later(function(){e.removeClass("#J_ShortTitleBox"+b,"hover")},200,!1,null)}),f.delegate(document,"click mouseenter mouseleave",".J_TitleTiger",function(a){var b=e.css(e.get(".rebate-text",a.currentTarget),"display");if(a.type=="mouseenter")b=="none"&&e.addClass(a.currentTarget,"current");else if(a.type=="mouseleave")b=="none"&&e.removeClass(a.currentTarget,"current");else{e.removeClass(a.currentTarget,"current"),e.hide(e.get(".J_Name",a.currentTarget)),e.show(e.get(".rebate-text",a.currentTarget)),e.get(".J_Title",a.currentTarget).focus();var c=e.attr(a.currentTarget,"data");e.val("#J_id",c);var d=e.val("#J_Title"+c),f=H.util.strProcess(d),g=f.replace(/[^\x00-\xff]/g,"**").length;if(g>60)e.html(e.get("#J_Notice"+c),"\u5b9d\u8d1d\u6807\u9898\u8d85\u8fc7\u6dd8\u5b9d\u9650\u5236\uff0830\u4e2a\u6c49\u5b57\uff09"),e.html(e.get("#J_Zs"+c),"");else{var h=60-g;e.html(e.get("#J_Notice"+c),""),e.html(e.get("#J_Zs"+c),'\u60a8\u8fd8\u80fd\u8f93\u5165<i style="margin:0 5px;">'+h+"</i>\u4e2a\u5b57\u7b26")}}}),f.delegate(document,"focusout",".J_Title",function(a){var b=e.attr(a.currentTarget,"data");KISSY.later(function(){e.show(e.get("#J_TitleBox"+b+" .J_Name")),e.hide(e.get("#J_TitleBox"+b+" .rebate-text"))},200,!1,null)}),f.delegate(document,"click",".J_TitleSubmit",function(a){var b=e.attr(a.currentTarget,"data"),c=e.val("#J_Title"+b),d=function(a){new H.widget.msgBox({type:"sucess",content:"\u4fee\u6539\u6210\u529f",dialogType:"msg",autoClose:!0,timeOut:3e3}),e.val("#J_Origin0"+b,c),e.html(e.get("#J_TitleBox"+b+" .J_Name"),c)},f=e.val("#J_Origin0"+b);if(f==c)return;var g=H.util.strProcess(c),h=g.replace(/[^\x00-\xff]/g,"**").length;if(h>60)return new H.widget.msgBox({type:"error",content:"\u5b9d\u8d1d\u6807\u9898\u8d85\u8fc7\u6dd8\u5b9d\u9650\u5236\uff0830\u4e2a\u6c49\u5b57\uff09\uff01",dialogType:"msg",autoClose:!0,timeOut:3e3}),!1;var i="item_id="+b+"&title="+encodeURIComponent(g);(new H.widget.asyncRequest).setURI(updateItemTitleUrl).setMethod("GET").setHandle(d).setData(i).send()}),f.delegate(document,"click",".J_ShortTitleSubmit",function(a){var b=e.attr(a.currentTarget,"data"),c=e.val("#J_ShortTitle"+b),d=function(a){new H.widget.msgBox({type:"sucess",content:"\u4fee\u6539\u6210\u529f",dialogType:"msg",autoClose:!0,timeOut:3e3}),e.val("#J_Origin1"+b,c),e.html(e.get("#J_ShortTitleBox"+b+" .J_Name"),c)},f=e.val("#J_Origin1"+b);if(f==c)return;var g="item_id="+b+"&item_short="+c;(new H.widget.asyncRequest).setURI(updateItemUrl).setMethod("GET").setHandle(d).setData(g).send()}),f.delegate(document,"click",".J_OriginPriceSubmit",function(a){var b=e.attr(a.currentTarget,"data"),c=e.val("#J_OriginPrice"+b),d=function(a){new H.widget.msgBox({type:"sucess",content:"\u4fee\u6539\u6210\u529f",dialogType:"msg",autoClose:!0,timeOut:3e3}),e.val("#J_Origin2"+b,c),e.html(e.get("#J_OriginPriceBox"+b+" .J_Name"),c)},f=e.val("#J_Origin2"+b);if(f==c)return;var g="item_id="+b+"&item_const_price="+c;(new H.widget.asyncRequest).setURI(updateItemUrl).setMethod("GET").setHandle(d).setData(g).send()}),f.delegate(document,"click",".J_HuohaoSubmit",function(a){var b=e.attr(a.currentTarget,"data"),c=e.val("#J_Huohao"+b),d=function(a){new H.widget.msgBox({type:"sucess",content:"\u4fee\u6539\u6210\u529f",dialogType:"msg",autoClose:!0,timeOut:3e3}),e.val("#J_Origin3"+b,c),e.html(e.get("#J_HuohaoBox"+b+" .J_Name"),c)},f=e.val("#J_Origin3"+b);if(f==c)return;var g="item_id="+b+"&outer_id="+c;(new H.widget.asyncRequest).setURI(updateItemTitleUrl).setMethod("GET").setHandle(d).setData(g).send()}),new c.DatePicker({trigger:".calendarImg",showTime:!0,autoRender:!0,autoSetValue:!0,delegateTigger:!0,minDate:new Date})},searchTbItems:function(){var a=function(a){e.hide("#J_RightLoading"),e.show("#J_MainRightContent"),totalRecords=a.payload.totalRecords,totalRecords>0?(e.css(e.get("#J_REmpty"),"display","none"),e.css(e.query(".J_PromotionItemBtnHolder"),"display","")):(e.css(e.get("#J_REmpty"),"display",""),e.css(e.query(".J_PromotionItemBtnHolder"),"display","none")),e.html("#J_PromotionItemList",a.payload.body);var c=e.query("#J_PromotionItemList .J_TbItem");f.on(c,"mouseenter mouseleave click",function(a){a.type=="mouseenter"?e.addClass(a.currentTarget,"current"):a.type=="mouseleave"&&e.removeClass(a.currentTarget,"current")});var d=Math.ceil(totalRecords/a.payload.pageNum);babylibraryControl.paginator=(new b("babylibraryControl.paginator")).setRender(babylibraryControl.handlePagination).setPageCount(d).printHtml("#J_BottomPaging",2)},c=babylibraryControl.getParamsData();e.show("#J_RightLoading"),e.hide("#J_MainRightContent");var d=e.val(e.get("#J_SearchType"));if(KISSY.inArray(d,["1","2"]))var g=getItemsFromUdpUrl;else var g=getItemsFromTbUrl;(new H.widget.asyncRequest).setURI(g).setMethod("GET").setHandle(a).setData(c).send()},handlePagination:function(a){pageId=a;var b=function(a){e.hide("#J_RightLoading"),e.show("#J_MainRightContent"),totalRecords=a.payload.totalRecords,totalRecords>0?(e.css(e.get("#J_REmpty"),"display","none"),e.css(e.query(".J_PromotionItemBtnHolder"),"display","")):(e.css(e.get("#J_REmpty"),"display",""),e.css(e.query(".J_PromotionItemBtnHolder"),"display","none")),e.html("#J_PromotionItemList",a.payload.body);var b=e.query("#J_PromotionItemList .J_TbItem");f.on(b,"mouseenter mouseleave click",function(a){a.type=="mouseenter"?e.addClass(a.currentTarget,"current"):a.type=="mouseleave"&&e.removeClass(a.currentTarget,"current")});var c=Math.ceil(totalRecords/a.payload.pageNum);babylibraryControl.paginator.setPage(pageId).setPageCount(c).printHtml("#J_BottomPaging",2)},c=babylibraryControl.getParamsData();c+="&page_id="+pageId,e.show("#J_RightLoading"),e.hide("#J_MainRightContent");var d=e.val(e.get("#J_SearchType"));if(KISSY.inArray(d,["1","2"]))var g=getItemsFromUdpUrl;else var g=getItemsFromTbUrl;(new H.widget.asyncRequest).setURI(g).setMethod("GET").setHandle(b).setData(c).send()},getParamsData:function(){if(e.val(e.get("#J_SearchTitle"))!="\u5173\u952e\u5b57\u3001\u5546\u54c1\u94fe\u63a5\u3001\u5546\u54c1\u7f16\u7801")var a=encodeURIComponent(e.val(e.get("#J_SearchTitle")));else var a="";var b="q="+a+"&pageSize=10",c=e.val(e.get("#J_SearchType"));switch(c){case"1":b+="&sales=2";break;case"2":b+="&sales=1";break;case"3":b+="&approve_status=onsale";break;case"4":b+="&vip=1";break;case"5":b+="&profit=2";break;case"6":b+="&has_showcase=1";break;case"7":b+="&approve_status=instock"}return b},checkTitleNotice:function(a){var b=e.val("#J_id"),c=a.replace(/[^\x00-\xff]/g,"**").length;if(c>60)e.html(e.get("#J_Notice"+b),"\u6807\u9898\u8d85\u8fc7\u6dd8\u5b9d\u9650\u5236\uff0830\u4e2a\u6c49\u5b57\uff09"),e.html(e.get("#J_Zs"+b),"");else{var d=60-c;e.html(e.get("#J_Notice"+b),""),e.html(e.get("#J_Zs"+b),'\u60a8\u8fd8\u80fd\u8f93\u5165<i style="margin:0 5px;">'+d+"</i>\u4e2a\u5b57\u7b26")}},escape:function(a){return a==null?"":a.replace(/\//g,"\\/").replace(/\./g,"\\.").replace(/\*/g,"\\*").replace(/\+/g,"\\+").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\$/g,"\\$").replace(/\?/g,"\\?").replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/\{/g,"\\{").replace(/\}/g,"\\}")}}},{requires:["utils/showPages/index","bui/calendar","bui/tooltip"]}); 