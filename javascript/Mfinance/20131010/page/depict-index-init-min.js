KISSY.add("page/depict-index-init",function(a,b){var c=a.DOM,d=a.Event;return indexControl={msg:null,chart:null,chart1:null,chart2:null,chart3:null,flag:!1,flags:!1,init:function(){indexControl.getMoneyListItem(),indexControl.getMoneyAjax(),indexControl.getBackAjax(),indexControl.getIncomeRatioAjax(),indexControl.getMemberAjax(),indexControl.getLessTotalAjax(),indexControl.searchProfitItem(),d.delegate(document,"click mouseover",".J_itemNav",function(a){var b=c.attr(a.currentTarget,"pid");c.val("#J_getListPid",b),c.removeClass(".J_itemNav","current"),c.addClass(a.currentTarget,"current"),b==0?(c.hide(".modle2"),indexControl.flag==0&&indexControl.searchProfitItem(),c.show(".model1")):b==1&&(c.hide(".model1"),indexControl.flags==0&&indexControl.searchSaleItem(),c.show(".modle2"))})},getBackAjax:function(){var b=function(b){indexControl.chart1&&indexControl.chart1.destroy(),jQuery(function(){jQuery("#J_line_one").highcharts({chart:{type:"line",height:274,spacingLeft:0,spacingRight:0,spacingBottom:15,spacingTop:15},title:{text:"\u9500\u552e\u989d",verticalAlign:"bottom",y:35,"float":!0},colors:["#64ABEB","#4dc1e8","#fb6e52","#ffce55","#656d78","#ac92ed","#ec87c1","#4b89dc","#db4453","#d8ad88","#00d39f","#a2b1c7","#5937ae","#bc3783"],plotOptions:{series:{stickyTracking:!1,marker:{symbol:"circle"}}},xAxis:{categories:b.payload.xdata,labels:{step:b.payload.xkuadu}},yAxis:{title:{text:null},minPadding:0,maxPadding:0,lineWidth:1,gridLineWidth:1,labels:{format:"{value}"}},legend:{enabled:!0,borderWidth:0},credits:{enabled:!1},series:[]})});var d=b.payload.data,e=b.payload.ydata,f=b.payload.tdata;c.html("#J_yesterday",e),c.html("#J_today",f),indexControl.chart1=jQuery("#J_line_one").highcharts(),a.each(d,function(a,b){indexControl.chart1.addSeries(a)})},d=function(a){};(new H.widget.asyncRequest).setURI(getSalesUrl).setMethod("POST").setHandle(b).setErrorHandle(d).setData(null).send()},getMoneyAjax:function(){var b=function(b){indexControl.chart&&indexControl.chart.destroy(),jQuery(function(){jQuery("#J_line-two").highcharts({chart:{type:"line",width:560,height:274,spacingLeft:0,spacingRight:0,spacingBottom:15,spacingTop:15},title:{text:"\u6536\u5165",verticalAlign:"bottom",y:35,"float":!0},colors:["#64ABEB","#4dc1e8","#fb6e52","#ffce55","#656d78","#ac92ed","#ec87c1","#4b89dc","#db4453","#d8ad88","#00d39f","#a2b1c7","#5937ae","#bc3783"],plotOptions:{series:{stickyTracking:!1,marker:{symbol:"circle"}}},xAxis:{categories:b.payload.xdata,labels:{step:b.payload.xkuadu}},yAxis:{title:{text:null},minPadding:0,maxPadding:0,lineWidth:1,gridLineWidth:1,labels:{format:"{value}"}},legend:{enabled:!0,borderWidth:0},credits:{enabled:!1},series:[]})});var d=b.payload.data,e=b.payload.yincome,f=b.payload.tincome,g=b.payload.ypay,h=b.payload.tpay;c.html("#J_zuori",e),c.html("#J_jinri",f),c.html("#J_zouriPay",g),c.html("#J_todayPay",h),indexControl.chart=jQuery("#J_line-two").highcharts(),a.each(d,function(a,b){indexControl.chart.addSeries(a)})},d=function(a){};(new H.widget.asyncRequest).setURI(getAccountsUrl).setMethod("POST").setHandle(b).setErrorHandle(d).setData(null).send()},getIncomeRatioAjax:function(){var a=function(a){indexControl.chart2&&indexControl.chart2.destroy(),jQuery(function(){chart2=new Highcharts.Chart({chart:{renderTo:"demo3",width:380,type:"pie",spacingLeft:15,spacingRight:0,spacingBottom:30,spacingTop:15},title:{text:" ","float":!0},colors:["#64ABEB","#4dc1e8","#4b89dc","#656d78","#d8ad88"],yAxis:{title:{text:" "}},plotOptions:{pie:{shadow:!1,startAngle:0,borderWidth:0,center:[100,60],point:{events:{legendItemClick:function(){return!1}}}}},tooltip:{formatter:function(){return"<b>"+this.point.name+"</b>: "+this.point.percentage.toFixed(2)+" %"}},legend:{layout:"vertical",backgroundColor:"#FFFFFF",floating:!0,align:"left",borderWidth:0,verticalAlign:"top",x:220,y:30,labelFormatter:function(){return'<div style="margin-bottom:15px;"><span style="font-weight:700;color:#656d78;">'+Highcharts.numberFormat(this.y/500*100,2)+"%</span>  "+'<span style="color:#abb3be;">'+this.name+"</span></div>"}},credits:{enabled:!1},series:[{name:" ",data:a.payload.items,size:"90%",innerSize:"50%",showInLegend:!0,dataLabels:{enabled:!1}}]})})},b=function(a){};(new H.widget.asyncRequest).setURI(getIncomeRatioUrl).setMethod("POST").setHandle(a).setErrorHandle(b).setData(null).send()},getMemberAjax:function(){var a=function(a){indexControl.chart3&&indexControl.chart3.destroy(),jQuery(function(){chart3=new Highcharts.Chart({chart:{renderTo:"demo4",width:380,height:245,type:"pie",spacingRight:0,spacingBottom:30},title:{text:" ","float":!0},colors:["#64ABEB","#4dc1e8","#4b89dc","#656d78","#d8ad88"],yAxis:{title:{text:" "}},plotOptions:{pie:{shadow:!1,startAngle:0,borderWidth:0,center:[100,60],point:{events:{legendItemClick:function(){return!1}}}}},tooltip:{formatter:function(){return"<b>"+this.point.name+"</b>: "+this.point.percentage.toFixed(2)+" %"}},legend:{layout:"vertical",backgroundColor:"#FFFFFF",floating:!0,align:"left",borderWidth:0,verticalAlign:"top",x:220,y:30,labelFormatter:function(){return'<div style="margin-bottom:15px;"><span style="font-weight:700;color:#656d78;">'+Highcharts.numberFormat(this.y/500*100,2)+"%</span>  "+'<span style="color:#abb3be;">'+this.name+"</span></div>"}},credits:{enabled:!1},series:[{name:" ",data:a.payload.items,size:"90%",innerSize:"50%",showInLegend:!0,dataLabels:{enabled:!1}}]})})},b=function(a){};(new H.widget.asyncRequest).setURI(getExpenditureUrl).setMethod("POST").setHandle(a).setErrorHandle(b).setData(null).send()},getLessTotalAjax:function(){var a=function(a){var b=a.payload;c.html("#J_remain",b),b==0?c.hide("#J_lessTotal"):c.show("#J_lessTotal")};(new H.widget.asyncRequest).setURI(getUnsetsUrl).setMethod("POST").setHandle(a).setData(null).send()},searchSaleItem:function(){var a=function(a){totalRecords=a.payload.totalRecords,totalRecords>0?(c.get("#J_REmpty").style.display="none",c.css(c.query(".J_ItemSelectBtnHolder"),"display","")):(c.get("#J_REmpty").style.display="",c.css(c.query(".J_ItemSelectBtnHolder"),"display","none")),indexControl.renderItems(a.payload.body),c.hide("#J_RightLoading"),c.show("#J_MainRightContent")},b=function(a){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})};c.show("#J_RightLoading"),c.hide("#J_MainRightContent"),(new H.widget.asyncRequest).setURI(getSaleRankingsUrl).setMethod("GET").setHandle(a).setErrorHandle(b).setData(null).setDataType("json").send()},renderItems:function(a){c.html(c.get("#J_sale"),a,!0),indexControl.flags=!0},searchProfitItem:function(){var a=function(a){totalRecords=a.payload.totalRecords,totalRecords>0?(c.get("#J_LEmpty").style.display="none",c.css(c.query(".J_ItemSelectBtnHolder"),"display","")):(c.get("#J_LEmpty").style.display="",c.css(c.query(".J_ItemSelectBtnHolder"),"display","none")),indexControl.renderprofitItems(a.payload.body),c.hide("#J_LeftLoading"),c.show("#J_MainLeftContent")},b=function(a){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})};c.show("#J_LeftLoading"),c.hide("#J_MainLeftContent"),(new H.widget.asyncRequest).setURI(getProfitRankingsUrl).setMethod("GET").setHandle(a).setErrorHandle(b).setData(null).setDataType("json").send()},renderprofitItems:function(a){c.html(c.get("#J_profit"),a,!0),indexControl.flag=!0},getMoneyListItem:function(){var e=function(e){var f=e.payload.income,g=e.payload.pay,h=e.payload.profit,i=e.payload.refund;c.html("#J_income",f),c.html("#J_out",g),c.html("#J_proval",h),c.html("#J_drawback",i);if(h==0){c.show("#J_pro");var j=new b.Tip({trigger:"#J_pro",alignType:"top",offset:10,elCls:"ui-tip",title:'<div class="zero"><p style="color:#989898;">\u6ca1\u6709\u5229\u6da6\uff1f\u4e0d\u53ef\u80fd\uff01</p><span>\u7531\u4e8e\u60a8\u6682\u672a\u8bbe\u7f6e\u5b9d\u8d1d\u6210\u672c\uff0c\u5229\u6da6\u6570\u636e\u4e0d\u7cbe\u51c6\uff0c\u6682\u4e0d\u4e3a\u60a8\u63a8\u9001\u3002</span><a href="http://tb-new.huanleguang.com/finance/configure/index/?sid=0-1369739-3-8f09ad69ed774f0a7ca741e9fad4c686&zid=1369739" target="_blank" >\u53bb\u8bbe\u7f6e</a></div></div>'});d.on("#J_pro","mouseover mouseenter",function(a){j.render(),j.show()}),d.on("#J_pro","mouseleave",function(c){var d=new b.Tip({trigger:"#J_pro",alignType:"top",offset:10,elCls:"ui-tip",title:'<div class="zero"><p style="color:#989898;">\u6ca1\u6709\u5229\u6da6\uff1f\u4e0d\u53ef\u80fd\uff01</p><span>\u7531\u4e8e\u60a8\u6682\u672a\u8bbe\u7f6e\u5b9d\u8d1d\u6210\u672c\uff0c\u5229\u6da6\u6570\u636e\u4e0d\u7cbe\u51c6\uff0c\u6682\u4e0d\u4e3a\u60a8\u63a8\u9001\u3002</span><a href="http://tb-new.huanleguang.com/finance/configure/index/?sid=0-1369739-3-8f09ad69ed774f0a7ca741e9fad4c686&zid=1369739" target="_blank" >\u53bb\u8bbe\u7f6e</a></div></div>'});d.show(),d.render(),a.later(function(){d.hide()},1e4,!0)})}else c.hide("#J_pro")};(new H.widget.asyncRequest).setURI(getStatisticUrl).setMethod("GET").setHandle(e).setData(null).send()}}},{requires:["bui/tooltip"]}); 