KISSY.add("page/category-list-init",function(a,b){var c=a.DOM,d=a.Event;return list={panel:null,msg:null,init:function(){list.panel=new b.Dialog({title:"\u83b7\u53d6\u4ee3\u7801",width:425,height:360,mask:!1,footerStyle:{display:"none"},bodyContent:""});var a=c.query(".J_List");d.on(a,"click",function(a){a.preventDefault();var b=c.attr(a.currentTarget,"lid");list.get(b)}),d.on(c.query(".J_StartDesign"),"click",function(a){a.preventDefault();if(!showPermissions("editor_material","\u4fc3\u9500\u7d20\u6750"))return;var b=c.attr(a.currentTarget,"data-url");if(isVersionPer("material",!1)){new H.widget.msgBox({title:"\u6e29\u99a8\u63d0\u793a",content:"\u53ea\u63d0\u4f9b\u5236\u4f5c\u4f53\u9a8c\uff0c\u5c0a\u4eab\u7248\u624d\u80fd\u4eab\u53d7\u7d20\u6750\u6295\u653e\u529f\u80fd",type:"info",buttons:[{value:"\u7ee7\u7eed\u4f53\u9a8c"},{value:"\u5173\u95ed"}],success:function(a){a=="\u7ee7\u7eed\u4f53\u9a8c"&&(window.location.href=b)}});return}})},get:function(a){if(!showPermissions("editor_material","\u4fc3\u9500\u7d20\u6750"))return;if(isVersionPer("material"))return;var b=function(a){list.msg.hide();var b='<div><textarea style="width:380px;height:200px;margin:5px;" id="J_Templet_Content" onclick="this.select()">'+a.payload+'</textarea></br><button class="btm-small button-green J_Copy">\u70b9\u6b64\u590d\u5236</button><span style="height:31px; line-height:31px">\u9f20\u6807\u4e8e\u6846\u5185CTRL+C\uff1a\u590d\u5236\u3001CTRL+V\uff1a\u7c98\u8d34</span></div>';list.panel.set("bodyContent",b),list.panel.show(),list.clipboard(".J_Copy","#J_Templet_Content")};list.msg=new H.widget.msgBox({dialogType:"loading",content:"\u6b63\u5728\u83b7\u53d6\u4ee3\u7801\uff01"});var c="id="+a;(new H.widget.asyncRequest).setURI(getListUrl).setMethod("GET").setHandle(b).setData(c).send()},collect:function(a){var b=function(b){c.html("#J_Collect_"+a,"<span></span>&nbsp;\u5df2\u6536\u85cf")},d=function(a){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"});return},e="share_id="+a;(new H.widget.asyncRequest).setURI(collectUrl).setMethod("GET").setHandle(b).setErrorHandle(d).setData(e).send()},cancelCollect:function(a){var b=function(b){c.remove("#J_Bm_Wrap_"+a)},d=function(a){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})},e="favorite_id="+a;(new H.widget.asyncRequest).setURI(cancelCollectUrl).setMethod("GET").setHandle(b).setErrorHandle(d).setData(e).send()},clipboard:function(a,b){d.on(a,"click",function(a){var d=c.val(b);if(window.clipboardData)window.clipboardData.clearData(),window.clipboardData.setData("Text",d),new H.widget.msgBox({type:"success",content:"\u5df2\u6210\u529f\u590d\u5236",dialogType:"msg",autoClose:!0,timeOut:3e3});else if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(e){return new H.widget.msgBox({type:"error",content:"\u60a8\u7684firefox\u5b89\u5168\u9650\u5236\u9650\u5236\u60a8\u8fdb\u884c\u526a\u8d34\u677f\u64cd\u4f5c\uff0c\u8bf7\u6253\u5f00'about:config'\u5c06signed.applets.codebase_principal_support'\u8bbe\u7f6e\u4e3atrue'\u4e4b\u540e\u91cd\u8bd5\uff0c\u76f8\u5bf9\u8def\u5f84\u4e3afirefox\u6839\u76ee\u5f55/greprefs/all.js",dialogType:"msg",autoClose:!0,timeOut:3e3}),!1}var f=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!f)return;var g=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!g)return;g.addDataFlavor("text/unicode");var h=new Object,i=new Object,h=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString),j=d;h.data=j,g.setTransferData("text/unicode",h,j.length*2);var k=Components.interfaces.nsIClipboard;if(!f)return!1;f.setData(g,null,k.kGlobalClipboard),new H.widget.msgBox({type:"success",content:"\u5df2\u6210\u529f\u590d\u5236",dialogType:"msg",autoClose:!0,timeOut:3e3})}else KISSY.UA.core=="webkit"&&new H.widget.msgBox({type:"error",content:"\u8be5\u6d4f\u89c8\u5668\u6682\u4e0d\u652f\u6301\uff0c\u8bf7\u7528 Ctrl+c \u590d\u5236",dialogType:"msg",autoClose:!0,timeOut:3e3});return!1})}}},{requires:["bui/overlay"]}); 