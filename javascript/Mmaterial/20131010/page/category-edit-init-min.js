KISSY.add("utils/beautifyForm/index",function(a){function g(b,c){var d=this;defaultCfg={init:!0};if(!(d instanceof g))return new g(b,c);var e=a.merge(defaultCfg,c);d._init(b,e)}var b=a.DOM,c=a.Event,d=document,e=b.get("body"),f=!1;return a.UA.safari!="undefined"&&a.UA.safari<3&&(f=!0),a.UA.ie==6&&b.replaceClass("#J_BodyHtml","has-js","no-js"),a.augment(g,{_init:function(a,b){var c=this;c.renderAll(a)},renderAll:function(a){var c=this;a=typeof a=="undefined"?"#J_BodyHtml":a;var d=b.filter(b.query(a+" input"),function(a){if(a.type=="checkbox"||a.type=="radio")return!0});for(var e=d.length-1;e>=0;e--)c.renderInput(d[e])},renderInput:function(a){var c=this,d=b.get(a),e=b.parent(d);e.tagName.toUpperCase()=="LABEL"&&e.className.indexOf("beautify_")>-1?e.className=="beautify_check"?c.renderCheckbox(d):e.className=="beautify_radio"&&c.renderRadio(d):e.tagName.toUpperCase()=="SPAN"&&b.hasClass(d,"beautify_input")&&c.renderCheckPro(d)},renderAllCheckPro:function(a){var c=this,d=b.filter(b.query(a+" input"),function(a){if((a.type=="checkbox"||a.type=="radio")&&b.hasClass(a,"beautify_input"))return!0});if(d.length<1)return;for(var e=d.length-1;e>=0;e--)c.renderCheckPro(d[e])},renderAllCheckbox:function(c){var d=this,e=b.filter(b.query(c+" input"),function(a){if(a.type=="checkbox")return!0});if(e.length<1){a.log("\u6b64id\u4e0b\u6ca1\u6709input(renderAllCheckbox)");return}for(var f=e.length-1;f>=0;f--)d.renderCheckbox(e[f])},renderAllRadio:function(c){var d=this,e=b.filter(b.query(c+" input"),function(a){if(a.type=="radio")return!0});if(e.length<1){a.log("\u6b64id\u4e0b\u6ca1\u6709input(renderAllRadio)");return}for(var f=e.length-1;f>=0;f--)d.renderRadio(e[f])},renderCheckPro:function(d){var e=this,g=b.get(d),h=b.prop(g,"type")=="checkbox",i=b.parent(g,"label")||b.parent(g,"span");if(!b.hasClass(g,"beautify_input")){a.log("input\u5fc5\u987b\u6709class=\u201dbeautify_input\u201c(renderCheckPro)");return}h?f&&g.checked==1||g.checked?(b.removeClass(i,"radio-checkoff-span"),b.addClass(i,"radio-checkon-span"),b.addClass(b.parent(i),"radio-checkstyle")):(b.removeClass(i,"radio-checkon-span"),b.addClass(i,"radio-checkoff-span"),b.removeClass(b.parent(i),"radio-checkstyle")):f&&g.checked==1||g.checked?(b.removeClass(i,"beautify_radio_off"),b.addClass(i,"beautify_radio_on"),b.addClass(b.parent(i),"radio-checkstyle")):(b.removeClass(i,"beautify_radio_on"),b.addClass(i,"beautify_radio_off"),b.removeClass(b.parent(i),"radio-checkstyle")),c.on(i,"click",function(a){a.stopPropagation();if(a.target.tagName.toUpperCase()=="LABEL")return;e.toggleCheckPro(g)})},renderCheckbox:function(a){var d=this,e=b.get(a),g=b.parent(e,"label")||b.parent(e,"span");if(!b.hasClass(g,"beautify_check"))return;b.append(b.create("<i>&nbsp;</i>"),g),e.disabled==1?f&&e.checked==1||e.checked?g.className="beautify_check c_on_disable":g.className="beautify_check beautify_check_disable":(f&&e.checked==1||e.checked?g.className="beautify_check c_on":g.className="beautify_check c_off",c.on(g,"click",function(a){a.stopPropagation();if(a.target.tagName.toUpperCase()=="LABEL")return;d.toggleCheckbox(e)}))},renderRadio:function(a){var d=this,e=b.get(a),g=b.parent(e,"label")||b.parent(e,"span");if(!b.hasClass(g,"beautify_radio"))return;b.append(b.create("<i>&nbsp;</i>"),g),e.disabled==1?f&&e.checked==1||e.checked?g.className="beautify_radio r_on_disable":g.className="beautify_radio beautify_radio_disable":(f&&e.checked==1||e.checked?g.className="beautify_radio r_on":g.className="beautify_radio r_off",c.on(g,"click",function(a){a.stopPropagation();if(a.target.tagName.toUpperCase()=="LABEL")return;d.toggleRadio(e)}))},setCheckboxOn:function(a){var c=b.get(a),d=b.parent(c,"label");d.className="beautify_check c_on",c.checked=!0},setCheckboxOff:function(a){var c=b.get(a),d=b.parent(c,"label");d.className="beautify_check c_off",c.checked=!1},setCheckboxDisabled:function(a){var c=b.get(a),d=b.parent(c,"label");f&&c.checked==1||c.checked?d.className="beautify_check c_on_disable":d.className="beautify_check beautify_check_disable",c.disabled=!0},setCheckboxNoDisabled:function(a){var c=b.get(a),d=b.parent(c,"label");f&&c.checked==1||c.checked?d.className="beautify_check c_on_disable":d.className="beautify_check beautify_check_disable",c.disabled=!1},toggleCheckbox:function(a){var c=b.get(a),d=b.parent(c,"label");d.className=="beautify_check c_off"?(d.className=="beautify_check c_on_disable"?d.className="beautify_check c_on_disable":d.className="beautify_check c_on",f&&c.click()):d.className=="beautify_check c_on_disable"?(d.className="beautify_check c_on_disable",f&&c.click()):d.className=="beautify_check beautify_check_disable"?(d.className="beautify_check beautify_check_disable",f&&c.click()):(d.className="beautify_check c_off",f&&c.click())},toggleRadio:function(a){var c=b.get(a),d=b.attr(c,"name"),e=b.parent(c,"label");if(e.className=="beautify_radio r_off"||c.checked){var g=b.filter(b.query("input"),function(a){if(a.type=="radio")return!0});for(var h=0;h<g.length;h++){var i=b.parent(g[h]);if(i.className.indexOf("beautify_radio")==-1)continue;if(b.attr(g[h],"name")!==d)continue;i.className="beautify_radio r_off"}e.className="beautify_radio r_on",f&&c.click()}else e.className=="beautify_radio beautify_radio_disable"?(e.className="beautify_radio beautify_radio_disable",f&&c.click()):(e.className="beautify_radio r_off",f&&c.click())},setRadioOn:function(a){var c=b.get(a),d=b.attr(c,"name"),e=b.parent(c,"label");if(e.className=="beautify_radio r_off"||c.checked){var f=b.filter(b.query("input"),function(a){if(a.type=="radio")return!0});for(var g=0;g<f.length;g++){var h=b.parent(f[g]);if(h.className.indexOf("beautify_radio")==-1)continue;if(b.attr(f[g],"name")!==d)continue;h.className="beautify_radio r_off"}e.className="beautify_radio r_on",c.checked=!0}},toggleCheckPro:function(a){var c=b.get(a),d=b.prop(c,"type")=="checkbox",e=b.attr(c,"name"),g=b.parent(a,"span");if(d)b.hasClass(g,"radio-checkon-span")?(b.removeClass(b.parent(g),"radio-checkstyle"),b.removeClass(g,"radio-checkon-span"),b.hasClass(g,"radio-checkoff-span")||b.addClass(g,"radio-checkoff-span")):(b.addClass(b.parent(g),"radio-checkstyle"),b.toggleClass(g,"radio-checkon-span","radio-checkoff-span"));else if(b.hasClass(g,"beautify_radio_off")){var h=b.filter(b.query(".beautify_input"),function(a){if(a.type=="radio")return!0});for(var c=0;c<h.length;c++){var i=h[c],j=b.parent(h[c]);if(i.className.indexOf("beautify_input")==-1)continue;if(b.attr(i,"name")!==e)continue;j.className="beautify_radio_off",b.removeClass(b.parent(j),"radio-checkstyle")}b.addClass(b.parent(g),"radio-checkstyle"),g.className="beautify_radio_on",f&&c.click()}else b.addClass(b.parent(g),"radio-checkstyle"),g.className="beautify_radio_on",f&&c.click()},setRadioPro:function(a){var c=b.get(a),d=b.attr(c,"name"),e=b.parent(a,"span"),f=b.filter(b.query(".beautify_input"),function(a){if(a.type=="radio")return!0});for(var c=0;c<f.length;c++){var g=f[c],h=b.parent(f[c]);if(g.className.indexOf("beautify_input")==-1)continue;if(b.attr(g,"name")!==d)continue;h.className="beautify_radio_off",b.removeClass(b.parent(h),"radio-checkstyle")}b.addClass(b.parent(e),"radio-checkstyle"),e.className="beautify_radio_on",b.get(a).checked=!0},setRadioProOff:function(a){var c=b.get(a),d=b.attr(c,"name"),e=b.parent(a,"span"),f=b.filter(b.query(".beautify_input"),function(a){if(a.type=="radio")return!0});for(var c=0;c<f.length;c++){var g=f[c],h=b.parent(f[c]);if(g.className.indexOf("beautify_input")==-1)continue;if(b.attr(g,"name")!==d)continue;h.className="beautify_radio_on"}e.className="beautify_radio_off",b.get(a).checked=!1},setCheckboxProOn:function(a){var c=b.get(a),d=b.attr(c,"name"),e=b.parent(a,"span");b.addClass(b.parent(e),"radio-checkstyle"),b.toggleClass(e,"radio-checkon-span","radio-checkoff-span"),b.get(a).checked=!0},setCheckboxProOff:function(a){var c=b.get(a),d=b.attr(c,"name"),e=b.parent(a,"span");b.removeClass(b.parent(e),"radio-checkstyle"),b.removeClass(e,"radio-checkon-span"),b.hasClass(e,"radio-checkoff-span")||b.addClass(e,"radio-checkoff-span"),b.get(a).checked=!1}}),g}),KISSY.add("page/category-edit-init",function(S,O,Switchable,XTemplate,beautifyForm){var DOM=S.DOM,Event=S.Event;return editControl={panel:null,msg:null,paginator:null,flag:0,editFlag:!1,postItems:[],promotionItemPaginator:null,selectItem:eval("("+itemsJson+")"),listParams:eval("("+listParamsJson+")"),init:function(){editControl.Form=new beautifyForm,iconTabs=(new Switchable.Tabs("#J_main",{navCls:"ks-switchable-nav",contentCls:"main-content",activeTriggerCls:"current",triggerType:"click"})).on("switch",function(a){var b=a.currentIndex;switch(b){case 0:DOM.show("#J_Preview_Box"),Event.remove("#J_SaveBtn"),DOM.html("#J_SaveBtn","\u4e0b\u4e00\u6b65"),Event.on("#J_SaveBtn","click",function(){editControl.preview(),iconTabs.switchTo(1)});break;case 1:Event.remove("#J_SaveBtn"),DOM.html("#J_SaveBtn","\u4fdd\u5b58"),Event.on("#J_SaveBtn","click",function(){editControl.save()})}}),editControl.initListParam(),Event.on(DOM.query(".J_list_width"),"click",editControl.changeListOption),Event.on("#J_ListBoxToggle","click",editControl.toggle),DOM.replaceClass("#J_SaveBtn","button-disabled","button-green"),Event.remove("#J_RangeBorder_1"),Event.on("#J_RangeBorder_1","click",function(a){DOM.val("#J_Is_Border","1")}),Event.remove("#J_RangeBorder_0"),Event.on("#J_RangeBorder_0","click",function(a){DOM.val("#J_Is_Border","0")}),Event.remove("#J_RangeColor_1"),Event.on("#J_RangeColor_1","click",function(a){DOM.val("#J_Is_Color","1")}),Event.remove("#J_RangeColor_0"),Event.on("#J_RangeColor_0","click",function(a){DOM.val("#J_Is_Color","0")}),Event.on("#J_SaveBtn","click",function(){editControl.preview(),iconTabs.switchTo(1)}),Event.on("#J_PreviewBtn","click",function(){editControl.preview()}),editControl.selectItem.length>0&&(editControl.renderSelectItems(),editControl.editFlag=edit,editControl.preview()),Event.delegate(document,"click",".J_OpenList",function(a){var b=DOM.attr(a.currentTarget,"data");DOM.toggleClass("#J_List"+b,"current")}),DOM.hide(DOM.query("#J_List0 .J_TopMoveDele")),Event.on("#J_AddGroup","click",function(){editControl.addItem(),DOM.hide(DOM.query("#J_List0 .J_TopMoveDele"))}),Event.delegate(document,"click",".J_TopMoveDele",function(a){var b=DOM.attr(a.currentTarget,"data");editControl.tempSave(),editControl.selectItem.splice(b,1),editControl.renderSelectItems(),editControl.preview(),editControl.selectItem.length<=0&&DOM.hide("#J_Preview_Box"),DOM.hide(DOM.query("#J_List0 .J_TopMoveDele"))}),Event.delegate(document,"click",".J_AddChildGroup",function(a){DOM.hide(DOM.query("#J_List0 .J_TopMoveDele"));var b=DOM.attr(a.currentTarget,"data"),c={name:"\u957f\u8896\u886c\u886b",url:"http://",isHight:"0"};if(typeId==9)var c={name:"",url:"http://",isHight:"0"};else var c={name:"\u65fa\u65fa\u540d\u79f0",url:"\u65fa\u65fa\u6635\u79f0",isHight:"0"};editControl.tempSave(),editControl.selectItem[b].children.push(c),editControl.renderSelectItems(),editControl.preview(),DOM.query("#J_ChildUl"+b+" .childName")[editControl.selectItem[b].children.length-1].focus(),DOM.hide(DOM.query("#J_List0 .J_TopMoveDele"))}),Event.delegate(document,"click",".J_BotMoveDele",function(a){var b=DOM.attr(a.currentTarget,"data"),c=DOM.attr(a.currentTarget,"pid");editControl.tempSave(),editControl.selectItem[b].children.splice(c,1),editControl.renderSelectItems(),editControl.preview(),editControl.selectItem.length<=0&&DOM.hide("#J_Preview_Box"),DOM.hide(DOM.query("#J_List0 .J_TopMoveDele"))}),Event.delegate(document,"click",".J_TopMoveUp",function(a){var b=Number(DOM.attr(a.currentTarget,"data"));if(b-1<0)return;editControl.tempSave();var c=editControl.selectItem[b];editControl.selectItem[b]=editControl.selectItem[b-1],editControl.selectItem[b-1]=c,editControl.renderSelectItems(),editControl.preview(),editControl.selectItem.length<=0&&DOM.hide("#J_Preview_Box"),DOM.hide(DOM.query("#J_List0 .J_TopMoveDele"))}),Event.delegate(document,"click",".J_TopMoveDown",function(a){var b=Number(DOM.attr(a.currentTarget,"data")),c=editControl.selectItem.length;if(b+1>=c)return;editControl.tempSave();var d=editControl.selectItem[b];editControl.selectItem[b]=editControl.selectItem[b+1],editControl.selectItem[b+1]=d,editControl.renderSelectItems(),editControl.preview(),editControl.selectItem.length<=0&&DOM.hide("#J_Preview_Box"),DOM.hide(DOM.query("#J_List0 .J_TopMoveDele"))}),Event.delegate(document,"click",".J_BotMoveUp",function(a){var b=Number(DOM.attr(a.currentTarget,"data")),c=Number(DOM.attr(a.currentTarget,"pid"));if(c-1<0)return;editControl.tempSave();var d=editControl.selectItem[b].children[c];editControl.selectItem[b].children[c]=editControl.selectItem[b].children[c-1],editControl.selectItem[b].children[c-1]=d,editControl.renderSelectItems(),editControl.preview(),editControl.selectItem.length<=0&&DOM.hide("#J_Preview_Box"),DOM.hide(DOM.query("#J_List0 .J_TopMoveDele"))}),Event.delegate(document,"click",".J_BotMoveDown",function(a){var b=Number(DOM.attr(a.currentTarget,"data")),c=Number(DOM.attr(a.currentTarget,"pid")),d=editControl.selectItem[b].children.length;if(c+1>=d)return;editControl.tempSave();var e=editControl.selectItem[b].children[c];editControl.selectItem[b].children[c]=editControl.selectItem[b].children[c+1],editControl.selectItem[b].children[c+1]=e,editControl.renderSelectItems(),editControl.preview(),editControl.selectItem.length<=0&&DOM.hide("#J_Preview_Box"),DOM.hide(DOM.query("#J_List0 .J_TopMoveDele"))})},initListParam:function(){var a="",b="",c="",d="",e="",f="",g="",h="",i="",j="",k="",l="",m="",n="",o="",q="",r="";S.each(editControl.listParams,function(a){a["field_code"]=="color"&&(c+='<li class="J_ListParams"><input type="hidden" id ="J_color"  value="'+a.value+'"  class="J_Param_Value">'+'<input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>'+'<div class="ui-side-list">\u5217\u8868\u989c\u8272\u9009\u62e9\uff1a</div>'+'<div class="ui-content-list ui-content-color">',paramOptons.color&&S.each(paramOptons.color,function(b,d){clos=b.split("_"),c+='<span class="list-template-color J_SelectColor ',a["value"]==b&&(c+="a-current"),c+='" data="'+b+'" >',c+='<b style="background-color: #'+clos[0]+'"></b>',c+="</span>"}),c+="</div></li>");if(a["field_code"]=="items_per_line"){b+='<li class="J_ListParams">',b+='<div class="ui-side-list">',b+="\u6a21\u677f\u5bbd\u5ea6";var g=a.value;b+='\uff1a</div><div class="ui-content-list menu-item" style="width:auto;"><input type="hidden" id ="J_items_per_line_default"  value="'+g+'">'+'<input type="hidden" id ="J_items_per_line"  value="'+g+'"  class="J_Param_Value">'+'<input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>',p=0;for(var i in formats)a["value"].split("_")[0]==i&&(b+='<input type="hidden" id="J_frame_width" value ="'+i+'"/>'),b+='<a href="#2"',a["value"].split("_")[0]==i?b+='class="on-center J_width"':b+='class="off-center J_width"',b+='><span  class="w-100 J_list_width" id="'+i+'">'+i+"\u50cf\u7d20</span></a>";b+="</div></li>"}a["field_code"]=="more_link"&&(d+='<li class="title-params J_ListParams" ><div class="ui-side-list">\u66f4\u591a\uff1a</div><div class="ui-content-list"><input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>',d+='<input type="text" id="J_moreLink"  class="input-text-3 J_Param_Value" value="'+a.value+'">',d+="</div></li>"),a["field_code"]=="keywords"&&(h+='<li class="title-params J_ListParams" ><div class="ui-side-list">\u5173\u952e\u8bcd\uff1a</div><div class="ui-content-list"><input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>',h+='<input type="text" id="J_keywords"  class="input-text-3 J_Param_Value" value="'+a.value+'">',h+="</div></li>");if(a["field_code"]=="list_param1"){var s="";j+='<li class="title-params J_ListParams" ><div class="ui-side-list">'+a.field_name+"\uff1a</div>"+'<div class="ui-content-list"><input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>',j+='<input type="text" id="J_list_param1" '+s+' class="input-text-3 J_Param_Value" value="'+a.value+'">',j+="</div></li>"}if(a["field_code"]=="list_param2"){var s="";k+='<li class="title-params J_ListParams" ><div class="ui-side-list">'+a.field_name+"\uff1a</div>"+'<div class="ui-content-list"><input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>',k+='<input type="text" id="J_list_param2" '+s+' class="input-text-3 J_Param_Value" value="'+a.value+'">',k+="</div></li>"}if(a["field_code"]=="list_param3"){var s="";l+='<li class="title-params J_ListParams" ><div class="ui-side-list">'+a.field_name+"\uff1a</div>"+'<div class="ui-content-list"><input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>',l+='<input type="text" id="J_list_param3"  '+s+' class="input-text-3 J_Param_Value" value="'+a.value+'">',l+="</div></li>"}if(a["field_code"]=="list_param4"){var s='title="'+a.field_name+'"';m+='<li class="title-params J_ListParams" ><div class="ui-side-list">'+a.field_name+"\uff1a</div>"+'<div class="ui-content-list"><input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>',m+='<input type="text" id="J_list_param4"  '+s+' class="input-text-3 J_Param_Value" value="'+a.value+'">',m+="</div></li>"}if(a["field_code"]=="list_param5"){var s='title="'+a.field_name+'"';n+='<li class="title-params J_ListParams" ><div class="ui-side-list">'+a.field_name+"\uff1a</div>"+'<div class="ui-content-list"><input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>',n+='<input type="text" id="J_list_param5"  '+s+' class="input-text-3 J_Param_Value" value="'+a.value+'">',n+="</div></li>"}if(a["field_code"]=="list_param6"){var s='title="'+a.field_name+'"';o+='<li class="title-params J_ListParams" ><div class="ui-side-list">'+a.field_name+"\uff1a</div>"+'<div class="ui-content-list"><input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>',o+='<input type="text" id="J_list_param6"  '+s+' class="input-text-3 J_Param_Value" value="'+a.value+'">',o+="</div></li>"}if(a["field_code"]=="list_param7"){var s='title="'+a.field_name+'"';q+='<li class="title-params J_ListParams" ><div class="ui-side-list">'+a.field_name+"\uff1a</div>"+'<div class="ui-content-list"><input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>',q+='<input type="text" id="J_list_param7"  '+s+' class="input-text-3 J_Param_Value" value="'+a.value+'">',q+="</div></li>"}if(a["field_code"]=="list_param8"){var s='title="'+a.field_name+'"';r+='<li class="title-params J_ListParams" ><div class="ui-side-list">'+a.field_name+"\uff1a</div>"+'<div class="ui-content-list"><input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>',r+='<input type="text" id="J_list_param8"  '+s+' class="input-text-3 J_Param_Value" value="'+a.value+'">',r+="</div></li>"}a["field_code"]=="has_border"&&(e+='<li class="title-params J_ListParams"><div class="ui-side-list">\u662f\u5426\u4f7f\u7528\u8fb9\u6846\u7ebf\uff1a</div><div class="ui-content-list"><input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>',e+='<input type="hidden" class="J_Param_Value" id="J_Is_Border" value="1">',e+='<div id="J_ListBorder"><label id="J_RangeBorder_1" for="J_Is_Border_1" class="beautify_radio"><input type="radio" name="is_border" id="J_Is_Border_1" checked="checked" class="w-30" data="border" value="1">\u662f</label><label id="J_RangeBorder_0" for="J_Is_Border_0" class="beautify_radio"><input type="radio" name="is_border" id="J_Is_Border_0" data="border" class="w-30" value="0">\u5426</label></div>',e+="</div></li>"),a["field_code"]=="discolor"&&(f+='<li class="title-params J_ListParams" ><div class="ui-side-list">\u662f\u5426\u9694\u884c\u6362\u8272\uff1a</div><div class="ui-content-list"><input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>',f+='<input type="hidden" class="J_Param_Value" id="J_Is_Color" value="1">',f+='<div id="J_ListColor"><label id="J_RangeColor_1" for="J_Is_Color_1" class="beautify_radio"><input type="radio" name="is_color" id="J_Is_Color_1" checked="checked" class="w-30" data="color" value="1">\u662f</label><label id="J_RangeColor_0" for="J_Is_Color_0" class="beautify_radio"><input type="radio" name="is_color" id="J_Is_Color_0"  data="color" class="w-30 J_RangeType" value="0">\u5426</label>',f+="</div></li>")}),listParamsConfirmHtm="",ListStr=c+b+e+f+d+g+h+i+j+k+l+m+n+o+q+r+listParamsConfirmHtm,DOM.html("#J_listParams",ListStr),DOM.query(".J_SelectColor").length>0&&Event.on(DOM.query(".J_SelectColor"),"click",function(a){var b=DOM.attr(a.currentTarget,"data");DOM.removeClass(DOM.query(".list-template-color"),"a-current"),DOM.toggleClass(this,"a-current"),DOM.val("#J_color",b),editControl.preview()})},changeListOption:function(){var a=this.id;DOM.replaceClass(DOM.query(".J_width"),"on-center off-center","off-center"),DOM.replaceClass(DOM.parent(this),"on-center off-center","on-center"),DOM.val("#J_frame_width",a),S.each(paramOptons.items_per_line,function(b){b.split("_")[0]==a&&DOM.val("#J_items_per_line",b)}),editControl.preview()},toggle:function(a){var b=S.one("#J_ListBox");b.css("display")==="none"?b.slideDown(.8,function(){DOM.html("#J_ListBoxToggle","\u9690\u85cf\u6a21\u7248\u9884\u89c8")}):b.slideUp(.8,function(){DOM.html("#J_ListBoxToggle","\u663e\u793a\u6a21\u7248\u9884\u89c8")})},preview:function(){Event.on(".preview-hover","mouseenter mouseleave",function(a){var b=DOM.attr(a.currentTarget,"data"),c=DOM.attr(a.currentTarget,"pid");a.type=="mouseenter"?(DOM.show(".edit-preview-desc-"+b+"-"+c),Event.on(".J_radio-"+b+"-"+c,"click",function(a){var d=DOM.attr(a.currentTarget,"data"),e=DOM.val("#radio-"+b+"-"+c+"-"+d),f=DOM.attr(a.currentTarget,"data-id");DOM.val("#childName-"+b+"-"+c,e),DOM.val("#childUrl-"+b+"-"+c,f)})):DOM.hide(".edit-preview-desc-"+b+"-"+c)}),editControl.itemProcess();var a=editControl.postItems;a.reverse();var b=a.length;if(b<=0)return DOM.hide("#J_ContentDetail"),DOM.hide("#J_ToggleC"),DOM.replaceClass("#J_PreviewBtn","button-gray","button-disabled"),!1;DOM.show("#J_ContentDetail");var c=KISSY.JSON.stringify(a),d=new Array;S.each(DOM.query(".J_ListParams"),function(a,b){var c={};c.param_id=DOM.val(DOM.get(".J_Param_ParamId",a)),c.field_code=DOM.val(DOM.get(".J_Param_FieldCode",a)),c.value=H.util.strProcess(DOM.val(DOM.get(".J_Param_Value",a))),c.value.indexOf("undefined")>=0&&(c.value=DOM.val("#J_items_per_line_default")),d.push(c)});var e=KISSY.JSON.stringify(d),f=function(a){DOM.html(DOM.get("#J_ContentDetail"),a.payload),DOM.show("#J_ToggleC");var b=S.one("#J_Preview_Box");b.css("display")==="none"&&b.slideDown()},g=function(a){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})};c=c.replace(/%25/g,"%!").replace(/&/g,"%26"),e=e.replace(/%25/g,"%!");var h="items="+c+"&listParams="+e+"&proto_id="+protoId+"&form_key="+FORM_KEY;(new H.widget.asyncRequest).setURI(previewUrl).setMethod("POST").setHandle(f).setErrorHandle(g).setData(h).send()},addItem:function(){editControl.tempSave();if(typeId==9)var a={parent:"",parentUrl:"http://",children:[{name:"\u957f\u8896",url:"http://",isHight:"0"}]};else var a={parent:"\u5ba2\u670d\u5206\u7ec4\u540d\u79f0",parentUrl:"http://",children:[{name:"",url:"",isHight:"0"}]};editControl.selectItem.push(a),editControl.renderSelectItems(),editControl.preview();var b=editControl.selectItem.length-1;DOM.get("#J_List"+b+" .parentName").focus()},save:function(){editControl.itemProcess();var a=editControl.postItems,b=a.length;if(b==0){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u60a8\u8fd8\u6ca1\u6709\u6dfb\u52a0\u5206\u7c7b\u54e6",type:"error"});return}editControl.msg=new H.widget.msgBox({title:"",dialogType:"loading",content:"\u7cfb\u7edf\u4fdd\u5b58\u4e2d\uff0c\u8bf7\u7a0d\u5019"});var c=KISSY.JSON.stringify(a),d=new Array;S.each(S.all(".J_ListParams"),function(a,b){var c={};c.param_id=DOM.val(DOM.get(".J_Param_ParamId",a)),c.field_code=DOM.val(DOM.get(".J_Param_FieldCode",a)),c.value=H.util.strProcess(DOM.val(DOM.get(".J_Param_Value",a))),c.value.indexOf("undefined")>=0&&(c.value=DOM.val("#J_items_per_line_default")),d.push(c)});var e=KISSY.JSON.stringify(d),f=function(a){DOM.html(DOM.get("#J_ContentDetail"),a.payload.body),editControl.msg.hide(),listId=a.payload.list_id;var b=createUrl+"&listId="+listId;if(isVersionPer("material",!1))new H.widget.msgBox({title:"\u4fdd\u5b58\u6210\u529f",content:"\u4fdd\u5b58\u6210\u529f\uff0c\u4f60\u53ef\u4ee5\u53bb\u67e5\u770b\u5217\u8868\u6216\u8005\u5347\u7ea7\u5230\u5c0a\u4eab\u7248\u53bb\u6295\u653e",type:"confirm",buttons:[{value:"\u5347\u7ea7"},{value:"\u67e5\u770b\u5217\u8868"}],success:function(a){a=="\u5347\u7ea7"?isVersionPer("material"):window.location.href=listUrl}});else{if(editControl.editFlag==1)var c="\u91cd\u65b0\u6295\u653e";else var c="\u53bb\u6295\u653e ";new H.widget.msgBox({title:"\u4fdd\u5b58\u6210\u529f",content:"\u4fdd\u5b58\u6210\u529f\uff0c\u4f60\u53ef\u4ee5\u53bb\u67e5\u770b\u5217\u8868,\u6295\u653e\u5217\u8868",type:"confirm",buttons:[{value:c},{value:"\u67e5\u770b\u5217\u8868"},{value:"\u8fd4\u56de\u7f16\u8f91"}],success:function(a){a==c?window.location.href=b:a=="\u67e5\u770b\u5217\u8868"&&(window.location.href=listUrl)}})}},g=function(a){editControl.msg.hide(),new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})},h="";h="meal_id=0&",c=c.replace(/%25/g,"%!").replace(/&/g,"%26"),e=e.replace(/%25/g,"%!"),h+="items="+c+"&listParams="+e+"&list_id="+listId+"&proto_id="+protoId+"&form_key="+FORM_KEY,(new H.widget.asyncRequest).setURI(saveUrl).setMethod("POST").setHandle(f).setErrorHandle(g).setData(h).send()},renderSelectItems:function(){var a=editControl.selectItem,b=a.length,c=DOM.html(DOM.get("#J_Templet")),d={data:a},e=(new XTemplate(c)).render(d);DOM.html(DOM.get("#J_SelectItemBox"),e),editControl.Form.renderAll("#J_SelectItemBox"),editControl.Form.renderAllRadio("#J_ListBorder"),editControl.Form.renderAllRadio("#J_ListColor")},tempSave:function(){editControl.selectItem=[];var a=DOM.children("#J_SelectItemBox").length;for(var b=0;b<a;b++){var c={};c.parent=DOM.val("#J_List"+b+" .parentName"),c.parentUrl=DOM.val("#J_List"+b+" .parentUrl"),c.isCurrent=DOM.hasClass("#J_List"+b,"current")?1:0;var d=DOM.query("#J_List"+b+" .childName"),e=DOM.query("#J_List"+b+" .childUrl"),f=DOM.query("#J_List"+b+" .isHight"),g=d.length;c.children=[];for(var h=0;h<g;h++){var i={};i.name=DOM.val(d[h]),typeId==9?i.url=DOM.val(e[h]):i.url=DOM.val(e[h]).replace(/：/g,":"),i.isHight=DOM.prop(f[h],"checked")?1:0,c.children.push(i)}editControl.selectItem.push(c)}},itemProcess:function(){editControl.postItems=[];var a=DOM.children("#J_SelectItemBox").length;for(var b=0;b<a;b++){var c={};c.parent=H.util.strProcess(DOM.val("#J_List"+b+" .parentName")),c.parentUrl=H.util.strProcess(DOM.val("#J_List"+b+" .parentUrl")),c.isCurrent=DOM.hasClass("#J_List"+b,"current")?1:0;var d=DOM.query("#J_List"+b+" .childName"),e=DOM.query("#J_List"+b+" .childUrl"),f=DOM.query("#J_List"+b+" .isHight"),g=d.length;c.children=[];for(var h=0;h<g;h++){var i={};i.name=H.util.strProcess(DOM.val(d[h])),typeId==9?i.url=H.util.strProcess(DOM.val(e[h])):i.url=H.util.strProcess(DOM.val(e[h])).replace(/：/g,":"),i.isHight=DOM.prop(f[h],"checked")?1:0,c.children.push(i)}editControl.postItems.push(c)}}}},{requires:["overlay","switchable","xtemplate","utils/beautifyForm/index"]}); 