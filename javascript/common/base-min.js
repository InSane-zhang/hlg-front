function bind(a,b){var c=[];for(var d=2;d<arguments.length;d++)c.push(arguments[d]);var e=function(){var d=a||(this==window?!1:this),e=c.slice();for(var f=0;f<arguments.length;f++)e.push(arguments[f]);if(typeof b!="string")return b.apply(d,e);if(d[b])return d[b].apply(d,e)};return typeof b=="string"?e.name=b:b&&b.name&&(e.name=b.name),e.toString=function(){return bind._toString(a,c,b)},e}function to_array(a){var b=[];for(var c=0,d=a.length;c<d;++c)b.push(a[c]);return b}bind._toString=bind._toString||function(a,b,c){return typeof c=="string"?"late bind<"+c+">":"bound<"+c.toString()+">"},Function.prototype.bind=function(a){var b=[arguments[0],this],c=arguments.length;for(var d=1;d<c;d++)b.push(arguments[d]);return bind.apply(null,b)},Function.prototype.shield=function(a){if(typeof this!="function")throw new TypeException;var b=this.bind.apply(this,to_array(arguments));return function(){return b()}},Function.prototype.defer=function(a,b){if(typeof this!="function")throw new TypeError;return a=a||0,setTimeout(this,a,b)},function(a){function d(b){var c=this;if(!(c instanceof d))return new d(b);c.msgBoxImagePath="http://cdn.huanleguang.com/img/common/msgBox/",c.isShown=!1,c.divMsgBox,c.divMsgBoxContent,c.divMsgBoxImage,c.divMsgBoxButtons,c.divMsgBoxBackGround;var e=typeof b;c.defaults={content:e=="string"?b:"Message",title:"Warning",type:"alert",dialogType:"dialog",autoClose:!1,timeOut:0,showButtons:!0,buttons:[{value:"Ok"}],inputs:[{type:"text",name:"userName",header:"User Name"},{type:"password",name:"password",header:"Password"}],success:function(a){},beforeShow:function(){},afterShow:function(){},beforeClose:function(){},afterClose:function(){},opacity:.1},b=e=="string"?c.defaults:b;if(b.type!=null&&b.dialogType=="dialog")switch(b.type){case"alert":b.title=b.title==null?"\u8b66\u544a":b.title;break;case"info":b.title=b.title==null?"\u6d88\u606f":b.title;break;case"error":b.title=b.title==null?"\u9519\u8bef\u63d0\u793a":b.title;break;case"confirm":b.title=b.title==null?"\u6e29\u99a8\u63d0\u793a":b.title,b.buttons=b.buttons==null?[{value:"\u786e\u8ba4"},{value:"\u53d6\u6d88"},{value:"\u53d6\u6d88"}]:b.buttons;break;case"prompt":b.title=b.title==null?"\u63d0\u793a":b.title,b.buttons=b.buttons==null?[{value:"\u767b\u5f55"},{value:"\u53d6\u6d88"}]:b.buttons;break;default:image="<span class='img-32-4'></span>"}b.timeOut=b.timeOut==null?b.content==null?500:b.content.length*70:b.timeOut,c.options=a.merge(c.defaults,b||{}),c.options.autoClose&&setTimeout(function(){c.hide()},c.options.timeOut),c.image="";switch(c.options.type&&c.options.dialogType=="dialog"){case"alert":image="<span class='img-32-4'></span>";break;case"info":image="<span class='img-32-2'></span>";break;case"error":image="<span class='img-32-1'></span>";break;case"confirm":image="<span class='img-32-5'></span>";break;case"popup":image="<span class='img-32-4'></span>";default:image="<span class='img-32-4'></span>"}c._createHtml()}function e(a){var b=this;if(!(b instanceof e))return new e(a);this.form="",this.dataType="json",this.uri="",this.method="GET",this.data=null,this.bootloadable=!0,this.resList=[],a!=undefined&&this.setURI(a)}var a=KISSY,b=a.DOM,c=a.Event;doc=document,$1=a.all,window.H=window.H||{version:"1.3",util:{setLocation:function(a){window.location.href=a;try{window.event.returnValue=!1}catch(b){}},pageReload:function(a){return a=(a||window.location.toString()).replace(/t=(\d)+/g,"").replace(/([&|?])+$/,""),a=a+(-1===a.indexOf("?")?"?":"&")+"t="+KISSY.now(),window.location=a},checkPrice:function(a){var b=[],c=!1,d=null;if(isNaN(Number(a))==1||a<=0)c=!0,d="\u4ef7\u683c\u662f\u6570\u5b57\u54e6\uff01";return b.push(c),b.push(d),b},isNull:function(a){var b=[],c=!1,d=null;if(a==null||a=="")c=!0,d="\u8bf7\u586b\u5199\uff0c\u6b64\u9879\u4e0d\u80fd\u4e3a\u7a7a\uff01";return b.push(c),b.push(d),b},stringToDate:function(a){if(typeof a=="undefined")return new Date;if(typeof a=="date")return a;var b=Date.parse(a),c=new Date(b);if(isNaN(c)){a=a.replace(/:/g,"-"),a=a.replace(" ","-"),a=a.replace(".","-");var d=a.split("-");switch(d.length){case 7:c=new Date(d[0],--d[1],d[2],d[3],d[4],d[5],d[6]);break;case 6:c=new Date(d[0],--d[1],d[2],d[3],d[4],d[5]);break;default:c=new Date(d[0],--d[1],d[2])}}return c},escape:function(a){return a==null?"":a.replace(/\//g,"\\/").replace(/\./g,"\\.").replace(/\*/g,"\\*").replace(/\+/g,"\\+").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\$/g,"\\$").replace(/\?/g,"\\?").replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/\{/g,"\\{").replace(/\}/g,"\\}")},strProcess:function(a){return a.replace(/\\/g,"\\\\").replace(/\"/g,'\\"').replace(/[\t\n&]/g,"%26").replace(/%/g,"%25")}},widget:{},app:{}},a.mix(d.prototype,{_createHtml:function(){var d=a.all,e=this,f=e.options,g="msgBox"+(new Date).getTime(),h=g,i=g+"BackGround";if(f.dialogType=="dialog"){var j=g+"Content",k=g+"Image",l=g+"Buttons",m="";a.each(e.options.buttons,function(a,b){b==0?m+='<span class="msg-btn-orange"><input class="msgButton" type="button" name="'+a.value+'" value="'+a.value+'" /></span>':m+='<span class="msg-btn-gray"><input class="msgButton" type="button" name="'+a.value+'" value="'+a.value+'" /></span>'});var n="";a.each(e.options.inputs,function(a,b){var c=a.type;if(c=="checkbox"||c=="radiobutton")n+='<div class="msgInput"><input type="'+a.type+'"id="'+a.id+'" name="'+a.name+'" '+(a.checked==null?"":"checked ='"+a.checked+"'")+' value="'+(typeof a.value=="undefined"?"":a.value)+'" />'+"<text>"+a.header+"</text>"+"</div>";else{var d=typeof a.className=="undefined"?"input-text":a.className;n+='<div class="msgInput"><span class="msgInputHeader">'+a.header+"</span>"+'<span><input type="'+a.type+'"class= "'+d+'"id="'+a.id+'" name="'+a.name+'" value="'+(typeof a.value=="undefined"?"":a.value)+'" /></span>'+"</div>"}});var o="<div id="+i+' class="msgBoxBackGround"></div>';if(f.type=="popup")var p='<div class="msgBoxTitle"><span>'+e.options.title+"</span></div>";else var p='<div class="msgBoxTitle"><span>'+e.options.title+'</span> <a class="closeButton "></a></div>';if(f.content.search("div")<0)var q="<p><span>"+f.content+"</span></p>";else var q=f.content;var r='<div class="msgBoxContainer"><div id='+k+' class="msgBoxImage ui-msg">'+image+"</div><div id="+j+' class="msgBoxContent">'+q+"</div></div>",s="<div id="+l+' class="msgBoxButtons">'+m+"</div>",t='<div class="msgBoxInputs">'+n+"</div>";f.type=="prompt"?(d("body").append(o+"<div id="+h+' class="msgBox">'+p+"<div>"+r+(f.showButtons?s+"</div>":"</div>")+"</div>"),e.divMsgBox=d("#"+h),e.divMsgBoxContent=d("#"+j),e.divMsgBoxImage=d("#"+k),e.divMsgBoxButtons=d("#"+l),e.divMsgBoxBackGround=d("#"+i),e.divMsgBoxImage.remove(),e.divMsgBoxButtons.css({"text-align":"center","margin-top":"5px"}),e.divMsgBoxContent.css({width:"100%",height:"100%"}),e.divMsgBoxContent.html(t)):(d("body").append(o+"<div id="+h+' class="msgBox">'+p+"<div>"+r+(f.showButtons?s+"</div>":"</div>")+"</div>"),e.divMsgBox=d("#"+h),e.divMsgBoxContent=d("#"+j),e.divMsgBoxImage=d("#"+k),e.divMsgBoxButtons=d("#"+l),e.divMsgBoxBackGround=d("#"+i)),e.show(),c.on(e.divMsgBoxBackGround,"click",function(a){!e.options.showButtons||e.options.autoClose?e.hide():e.getFocus()}),c.on(b.get(".closeButton"),"click",function(a){e.hide()}),c.on(b.query(".msgButton"),"click",function(c){c.preventDefault();var f=d(this).val();if(e.options.type!="prompt")e.options.success(f);else{var g=[];a.each(b.query(".msgInput"),function(a){var b=d(a).attr("name"),c=d(a).val(),e=d(a).attr("type");e=="checkbox"||e=="radiobutton"?g.push({name:b,value:c,checked:d(a).attr("checked")}):g.push({name:b,value:c})}),e.options.success(f,g)}e.hide()})}else if(f.dialogType=="loading"){var o="<div id="+i+' class="msgBoxBackGround"></div>';f.content=f.content==null?"\u7cfb\u7edf\u5904\u7406\u4e2d\uff0c\u8bf7\u7a0d\u7b49...":f.content,d("body").append(o+"<div id="+h+' class="messages-prompt"><div class="fbloader"><img  src="http://img.huanleguang.com/hlg//fbloader.gif" width="16" height="11" /></div><div class="mini_dialog_content">'+f.content+"</div></div>"),e.divMsgBox=d("#"+h),e.divMsgBoxBackGround=d("#"+i),e.show()}else if(f.dialogType=="msg"){e.image="";switch(f.type){case"alert":var r='<ul id="noty_top_layout_container" class="ui-msg" style="top: 0px;left: 20%;position: fixed;_position:absolute;_left:expression(eval(document.documentElement.scrollLeft+20%));_top:expression(eval(document.documentElement.scrollTop));width: 60%;height: auto;margin: 0px;padding: 0px;list-style-type: none;z-index: 9999999;"><li style="overflow: hidden;"><div class="warning-msg"><div class="img-warning"></div><div class="text-16"> '+f.content+"</div>"+"</div></li></ul>";break;case"info":case"success":var r='<ul id="noty_top_layout_container" class="ui-msg" style="top: 0px;left: 20%;position: fixed;_position:absolute;_left:expression(eval(document.documentElement.scrollLeft+20%));_top:expression(eval(document.documentElement.scrollTop));width: 60%;height: auto;margin: 0px;padding: 0px;list-style-type: none;z-index: 9999999;"><li style="overflow: hidden;"><div class="success-msg"><div class="img-success"></div><div class="text-16"> '+f.content+"</div>"+"</div></li></ul>";break;case"error":var r='<ul id="noty_top_layout_container" class="ui-msg" style="top: 0px;left: 20%;position: fixed;_position:absolute;_left:expression(eval(document.documentElement.scrollLeft+20%));_top:expression(eval(document.documentElement.scrollTop));width: 60%;height: auto;margin: 0px;padding: 0px;list-style-type: none;z-index: 9999999;"><li style="overflow: hidden;"><div class="error-msg"><div class="img-error"></div><div class="text-16"> '+f.content+"</div>"+"</div></li></ul>";break;default:var r='<ul id="noty_top_layout_container" class="ui-msg" style="top: 0px;left: 20%;position: fixed;_position:absolute;_left:expression(eval(document.documentElement.scrollLeft+20%));_top:expression(eval(document.documentElement.scrollTop));width: 60%;height: auto;margin: 0px;padding: 0px;list-style-type: none;z-index: 9999999;"><li style="overflow: hidden;"><div class="notice-msg"><div class="img-notice"></div><div class="text-16"> '+f.content+"</div>"+"</div></li></ul>"}d("body").append("<div id="+h+' class="">'+r+"</div>"),e.divMsgBox=d("#"+h),e.show(),c.on(e.divMsgBox,"click",function(a){e.hide()})}},show:function(){var b=a.all,c=this;if(c.isShown)return;var d=c.options;if(d.dialogType=="dialog"){var e=c.center(),f=e.top,g=e.left;c.divMsgBox.css({opacity:0,top:f-50,left:g}),c.divMsgBox.css("background-image","url('"+c.msgBoxImagePath+"msgBoxBackGround.png')"),c.divMsgBoxBackGround.css({opacity:d.opacity}),c.options.beforeShow(),c.divMsgBoxBackGround.css({width:b(document).width(),height:c.getDocHeight()}),b(c.divMsgBoxId+","+c.divMsgBoxBackGroundId).fadeIn(0),c.divMsgBox.animate({opacity:1,top:f,left:g},.2),setTimeout(c.options.afterShow,200)}else if(d.dialogType=="loading"){var e=c.center(),f=e.top,g=e.left;c.divMsgBoxBackGround.css({opacity:d.opacity}),c.divMsgBoxBackGround.css({width:b(document).width(),height:c.getDocHeight()}),c.divMsgBox.css({top:f,left:g},.2)}else d.dialogType=="msg"&&(c.divMsgBox.css({opacity:0,top:f-50}),c.divMsgBox.animate({opacity:1,top:0},.2));c.isShown=!0;if(d.dialogType=="dialog"||d.dialogType=="loading"){b(window).on("resize",function(a){if(c.isShown){var b=c.center(),d=b.top,e=b.left;c.divMsgBox.css({top:d,left:e})}});function h(){if(c.isShown){var a=c.center(),b=a.top,d=a.left;c.divMsgBox.css({top:b,left:d})}}window.onscroll=h}},center:function(){var a=this,c,d,e=b.get("#"+a.divMsgBox.attr("id")),f=e.offsetWidth,g=e.offsetHeight;viewPortWidth=b.viewportWidth(),viewPortHeight=b.viewportHeight(),f<viewPortWidth?c=viewPortWidth/2-f/2+b.scrollLeft():c=b.scrollLeft(),g<viewPortHeight?d=viewPortHeight/2-g/2+b.scrollTop():d=b.scrollTop();var h={top:d,left:c};return h},hide:function(){var b=a.all,c=this;if(!c.isShown)return;if(c.options.dialogType=="dialog"||c.options.dialogType=="loading"){var d=c.center().top,e=c.center().left;c.options.beforeClose(),c.divMsgBox.animate({opacity:0,top:d-50,left:e},.2),c.divMsgBoxBackGround.fadeOut(300),setTimeout(function(){c.divMsgBox.remove(),c.divMsgBoxBackGround.remove()},300),setTimeout(c.options.afterClose,300)}else c.divMsgBox.animate({opacity:0,top:d-50},.5),setTimeout(function(){c.divMsgBox.remove()},300);c.isShown=!1},getDocHeight:function(){var a=document;return Math.max(Math.max(a.body.scrollHeight,a.documentElement.scrollHeight),Math.max(a.body.offsetHeight,a.documentElement.offsetHeight),Math.max(a.body.clientHeight,a.documentElement.clientHeight))},getFocus:function(){var a=this;a.divMsgBox.fadeOut(.2).fadeIn(.2)}}),H.widget.msgBox=d,a.mix(e.prototype,{handleSuccess:function(){return undefined},handleFailure:function(a){alert(a.desc)},mapRes:function(){var a=document.getElemenHLGByTagName("link"),b=document.getElemenHLGByTagName("script");if(a.length)for(var c=0,d=a.length;c<d;c++)this.resList.push(a[c].href);if(b.length)for(var c=0,d=b.length;c<d;c++)this.resList.push(b[c].src)},setMethod:function(a){return this.method=a.toString().toUpperCase(),this},getMethod:function(){return this.method},setData:function(a){return this.data=a,this},getData:function(){return this.data},setForm:function(a){return this.form=a,this},getForm:function(){return this.form},setURI:function(a){return this.uri=a,this},getURI:function(){return this.uri.toString()},setDataType:function(a){return this.dataType=a,this},getDataType:function(){return this.dataType},setHandle:function(a){return this.handleSuccess=a,this},setErrorHandle:function(a){return this.handleFailure=a,this},dispatchResponse:function(a,b){b.handleSuccess(a);var c=a.onload;if(c)try{(new Function(c))()}catch(d){}},disableBootload:function(){return this.bootloadable=!1,this},enableBootload:function(){return this.bootloadable=!0,this},dispatchErrorResponse:function(a,b,c){b&&(b=="timeout"?new H.widget.msgBox({content:"\u8bf7\u6c42\u8d85\u65f6\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u662f\u5426\u8fde\u63a5\u6b63\u5e38",dialogType:"loading",autoClose:!0,timeOut:8e3}):b.search("\u5b58\u50a8\u7a7a\u95f4\u4e0d\u8db3")>=0?new H.widget.msgBox({title:"\u6e29\u99a8\u63d0\u793a",content:'\u6d4f\u89c8\u5668\u95ee\u9898\u5bfc\u81f4\u672c\u6b21\u64cd\u4f5c\u65e0\u6cd5\u5904\u7406\uff0c<a href="http://bangpai.taobao.com/group/thread/609027-277519092.htm?spm=0.0.0.40.24059f" target="_blank">\u67e5\u770b\u89e3\u51b3\u529e\u6cd5</a>',type:"info"}):new H.widget.msgBox({content:"\u7cfb\u7edf\u51fa\u9519"+b+"\uff0c\u8bf7\u8054\u7cfb\u6b22\u4e50\u901b",dialogType:"loading",autoClose:!0,timeOut:8e3}))},send:function(){var b=this;b.method=="GET"&&b.data&&(b.uri+=(b.uri.indexOf("?")==-1?"?":"&")+b.data,b.data=null);var c=this;interpretResponse=function(a,b,c,d){var e=d;if(a.ajaxExpired!=null){window.location=a.ajaxRedirect;return}if(a.error)var f=e.handleFailure;else var f=e.dispatchResponse;f=f.shield(null,a,d),f=f.defer.bind(f),f()},a.ajax({form:b.form,type:b.method,url:b.uri,data:b.data,success:function(a,b,d){interpretResponse(a,b,d,c)},serializeArray:!1,error:this.dispatchErrorResponse,dataType:b.dataType,timeout:60,complete:function(a,b,c){c=null}})}}),H.widget.asyncRequest=e}(KISSY),Date.prototype.format=function(a){var b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var c in b)(new RegExp("("+c+")")).test(a)&&(a=a.replace(RegExp.$1,RegExp.$1.length==1?b[c]:("00"+b[c]).substr((""+b[c]).length)));return a}; 