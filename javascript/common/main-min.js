KISSY.add("common/main",function(a,b){var c=a.DOM,d=a.Event,e=a.Node.all;return mainControl={init:function(){var e=c.query("#J_NoticeBox li").length;e>1&&new b.Slide("#J_NoticeBox",{contentCls:"news-items",hasTriggers:!1,effect:"scrolly",easing:"easeOutStrong",interval:5,duration:.5}),d.on("#J_MenuMouse","mouseenter mouseleave",function(a){a.type=="mouseenter"?(c.addClass(a.currentTarget,"current"),c.width("#J_SubMenu",c.width("#J_MenuMouse")),c.show("#J_SubMenu")):(c.removeClass(a.currentTarget,"current"),c.hide("#J_SubMenu"))}),d.on("#J_renewal","mouseenter mouseleave",function(a){a.type=="mouseenter"?(c.addClass(a.currentTarget,"current"),c.show("#J_renewalMenu")):(c.removeClass(a.currentTarget,"current"),c.hide("#J_renewalMenu"))}),a.io.get(getMsgUrl,{type:"mess"},function(a){a.payload>0&&(c.addClass("#J_HasMsgBox","has-msg"),c.html("#J_MsgNum",a.payload))},"json");var f=c.query("#J_menu .J_menuItem");a.each(f,function(a){d.on(a,"mouseenter mouseleave",function(b){b.type=="mouseenter"?c.addClass(c.parent(a),"menu-hover"):b.type=="mouseleave"&&c.removeClass(c.parent(a),"menu-hover")})});var g=a.all("#J_menu div"),h=a.all("#J_menu ul");g.on("click",function(b){var c=a.one(b.target).next();if(c){var d=c.css("display");d=="none"?(h.slideUp(.2),c.slideDown(.2)):h.slideUp(.2)}return!1});var i=c.val("#J_MenuModuleId");c.show("#kefu-preview-"+i);var j=a.query("#J_menu .second-title");d.on(j,"click",function(a){var b=c.attr(a.currentTarget,"data"),d=c.query(".kefu-preview");c.hide(d),c.show("#kefu-preview-"+b)}),d.on("#online_help","mouseenter mouseleave",function(a){a.type=="mouseenter"?c.show("#J_help"):a.type=="mouseleave"&&c.hide("#J_help")}),d.on("#J_fkjy","click",function(b){if(!window.suggestDialog)KISSY.use("bui/overlay,editor",function(a,b,d){window.suggestDialog=new b.Dialog({title:'<div style="line-height:50px;font-weight:bold;font-size:14px;">\u53cd\u9988\u5efa\u8bae</div>',width:460,height:542,mask:!1,elAttrs:{id:"J_SuggestDialog"},footerStyle:{display:"none"},bodyContent:""});var e='<div class=""><form method="post" id="J_SuggestAddForm" action=""><ul><input type="hidden" name="type" value="2" /><input type="hidden" name="source" value="1" /><li><div class="align-right fl">\u7c7b\u578b:</div><div class="fl ml6"><select id="J_Suggest_ProjectType" name="project_type"><option value="1">\u4fc3\u9500\u6d3b\u52a8</option><option value="2">\u6a21\u677f</option><option value="3">\u4f1a\u5458</option><option value="4">\u6570\u636e</option><option value="5">\u6279\u91cf\u5de5\u5177</option><option value="6">\u6807\u9898\u4f18\u5316</option><option value="7">\u79fb\u52a8\u7aef</option><option value="8">\u5176\u5b83</option></select></div></li><li><div class="align-right fl">\u6807\u9898:</div><div class="fl ml6"><input type="text" id="J_Suggest_Title" name="title" value="" class="suggest_input_text"></div></li><li><div class="align-right fl">\u65fa\u65fa:</div><div class="fl ml6"><input type="text" id="J_Suggest_Shopnick" name="shop_nick" value="" class="suggest_input_text"></div></li><li><div id="editorContainer" class="ks-editor"><textarea class="ks-editor-textarea  required-entry"  title="Template Content" id="J_Suggest_Content" name="content"></textarea></div></li><li style="line-height:0;min-height:0;margin-bottom:0;"><div class="ui-msg mt15" style="display: none; width:420px;" id="J_Suggest_ParamsErrorBox"><div class="error-msg"><div class="img-16-1"></div><div class="text-16 color-red" id="J_Suggest_ParamsErrorMsg"></div></div></div><div class="ui-msg mt15" style="display: none;width:420px;" id="J_Suggest_ParamsSucessBox"><div class="success-msg"><div class="img-16-6"></div><div class="text-16" id="J_Suggest_ParamsSucessMsg"></div></div></div></li></ul></form><div class="bui-stdmod-footer"><button class="bui-button bui-button-primary clickable" id="J_SubmitPost" >\u786e\u5b9a</button><button class="bui-button J_SuggestCancle">\u5173\u95ed</button></div></div>';window.suggestDialog.set("bodyContent",e),window.suggestDialog.render(),c.val("#J_Suggest_Shopnick",c.val("#J_ShopNick"));var f={focused:!1,attachForm:!0,srcNode:"#editorContainer",width:"100%",height:"200px"};KISSY.use("editor/plugin/smiley/,editor/plugin/font-size/,editor/plugin/image/",function(a,b,c,e){f.plugins=[b,c,new e({upload:{serverUrl:uploadImgURL,serverParams:{waterMark:function(){return a.one("#ke_img_up_watermark_1")[0].checked}},suffix:"png,jpg,jpeg,gif",fileInput:"Filedata",sizeLimit:1e3,extraHtml:"<p style='margin-top:10px;'><input type='checkbox' id='ke_img_up_watermark_1' checked='checked'> \u56fe\u7247\u52a0\u6c34\u5370\uff0c\u9632\u6b62\u522b\u4eba\u76d7\u7528</p>"}})],window.suggestEditor=(new d(f)).render()}),window.suggestDialog.show()});else{window.suggestDialog.show(),c.val("#J_Suggest_Title","");var e="";window.suggestEditor.set("data",e),c.addClass("#J_SubmitPost","clickable")}d.remove("#J_SubmitPost");var f=null;d.delegate(document,"click dblclick","#J_SubmitPost",function(b){b.type=="click"&&(clearTimeout(f),f=setTimeout(function(){window.suggestEditor.sync(),ParamsErrorBox=KISSY.one("#J_Suggest_ParamsErrorBox");var b=c.val("#J_Suggest_Title"),d=c.val("#J_Suggest_Shopnick"),e=c.val("#J_Suggest_Content");if(b==""||b=="undefined"){c.html("#J_Suggest_ParamsErrorMsg","\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a"),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),a.later(function(){c.hide("#J_Suggest_ParamsErrorBox")},2e3,!1);return}if(d==""||d=="undefined"){c.html("#J_Suggest_ParamsErrorMsg","\u65fa\u65fa\u4e0d\u80fd\u4e3a\u7a7a"),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),a.later(function(){c.hide("#J_Suggest_ParamsErrorBox")},2e3,!1);return}if(e==""||e=="undefined"){c.html("#J_Suggest_ParamsErrorMsg","\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),a.later(function(){c.hide("#J_Suggest_ParamsErrorBox")},2e3,!1);return}if(c.hasClass("#J_SubmitPost","clickable")){var f=function(b){ParamsSucessBox=KISSY.one("#J_Suggest_ParamsSucessBox"),c.html("#J_Suggest_ParamsSucessMsg","\u63d0\u4ea4\u6210\u529f\uff01"),ParamsSucessBox.css("display")==="none"&&ParamsSucessBox.slideDown(),a.later(function(){c.hide("#J_Suggest_ParamsSucessBox"),window.suggestDialog.hide()},1e3,!1),c.removeClass("#J_SubmitPost","clickable")},g=function(a){},h="";(new H.widget.asyncRequest).setURI(suggestUrl).setMethod("POST").setForm("#J_SuggestAddForm").setHandle(f).setErrorHandle(g).setData(h).send()}},300));if(b.type=="dblclick"){clearTimeout(f),window.suggestEditor.sync(),ParamsErrorBox=KISSY.one("#J_Suggest_ParamsErrorBox");var d=encodeURIComponent(c.val("#J_Suggest_Title")),e=c.val("#J_Suggest_Shopnick"),g=c.val("#J_Suggest_Content");if(d==""||d=="undefined"){c.html("#J_Suggest_ParamsErrorMsg","\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a"),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),a.later(function(){c.hide("#J_Suggest_ParamsErrorBox")},2e3,!1);return}if(e==""||e=="undefined"){c.html("#J_Suggest_ParamsErrorMsg","\u65fa\u65fa\u4e0d\u80fd\u4e3a\u7a7a"),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),a.later(function(){c.hide("#J_Suggest_ParamsErrorBox")},2e3,!1);return}if(g==""||g=="undefined"){c.html("#J_Suggest_ParamsErrorMsg","\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),a.later(function(){c.hide("#J_Suggest_ParamsErrorBox")},2e3,!1);return}if(c.hasClass("#J_SubmitPost","clickable")){var h=function(b){ParamsSucessBox=KISSY.one("#J_Suggest_ParamsSucessBox"),c.html("#J_Suggest_ParamsSucessMsg","\u63d0\u4ea4\u6210\u529f\uff01"),ParamsSucessBox.css("display")==="none"&&ParamsSucessBox.slideDown(),a.later(function(){c.hide("#J_Suggest_ParamsSucessBox"),window.suggestDialog.hide()},1e3,!1),c.removeClass("#J_SubmitPost","clickable")},i=function(a){},j="";(new H.widget.asyncRequest).setURI(suggestUrl).setMethod("POST").setForm("#J_SuggestAddForm").setHandle(h).setErrorHandle(i).setData(j).send()}}}),d.delegate(document,"click",".J_SuggestCancle",function(a){window.suggestDialog.hide()})})}}},{requires:["switchable"]}); 