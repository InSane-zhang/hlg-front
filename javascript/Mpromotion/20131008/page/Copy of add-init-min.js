KISSY.add("page/mods/check",function(a){return checkUtil={checkSpecTitle:function(a){var b=[],c=!1,d=null,e=/(淘宝)|(限时折扣)|(限时打折)|(良品)|(淘金币)|(天天特价)|(满就送)/i;if(e.test(a)){var f=e.exec(a);f!=null&&(c=!0,d="\u542b\u6709\u8fdd\u7981\u5b57"+f[0]+"\uff01")}return b.push(c),b.push(d),b},checkPromoName:function(a){var b=[],c=!1,d=null,e=/^[\u4E00-\u9FA5\uf900-\ufa2d\A-Za-z0-9]{2,5}$/;if(!e.test(a))if(a.length<2||a.length>5)c=!0,d="\u957f\u5ea62~5\u4e2a\u5b57\u7b26\uff01";else{var f=/[^\u4E00-\u9FA5\uf900-\ufa2d\A-Za-z0-9]+/,g=a.match(f);g!=null&&(c=!0,d="\u542b\u6709\u975e\u6cd5\u5b57\u7b26"+g[0]+"\uff01")}return b.push(c),b.push(d),b},checkPromoDesc:function(a){var b=[],c=!1,d=null,e=/^[\u4E00-\u9FA5\uf900-\ufa2d\w\s\，！。《》（）、—]{0,30}$/;if(!e.test(a))if(a.length>30)c=!0,d="\u957f\u5ea630\u4e2a\u5b57\u4ee5\u5185\uff01";else{var f=/[^\u4E00-\u9FA5\uf900-\ufa2d\w\s\，！。《》（）、—]+/,g=a.match(f);g!=null&&(c=!0,d="\u542b\u6709\u975e\u6cd5\u5b57\u7b26"+g[0]+"\uff01")}return b.push(c),b.push(d),b},checkUrl:function(a){var b=[],c=!1,d=null,e=/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?/;return e.test(a)||(c=!0,d="\u975e\u6cd5URl\u5730\u5740\uff01"),b.push(c),b.push(d),b},checkDiscount:function(a){var b=[],c=!1,d=null;if(isNaN(Number(a))||a<=0||a>=10)c=!0,d="\u6298\u6263\u8303\u56f4\u5728 0.00~9.99\u4e4b\u95f4\u54e6\uff01";else{var e=/(^[0-9]([.][0-9]{1,2})?$)|(^1[0-9]([.][0-9]{1,2})?$)|(^2[0-3]([.][0-9]{1,2})?$)|(^10([.]0{1,2})?$)/;e.test(a)||(c=!0,d="\u6298\u6263\u8303\u56f4\u5728 0.00~9.99\u4e4b\u95f4\u54e6\uff01")}return b.push(c),b.push(d),b},strProcess:function(a){return a.replace(/\\/g,"\\\\").replace(/\"/g,'\\"').replace(/[\t\n&]/g,"%26").replace(/%/g,"%25")},FormatNumber:function(a,b){var a,b,c,d;a=""+a+"",strLen=a.length,dotPos=a.indexOf(".",0);if(dotPos==-1){c=a+".";for(i=0;i<b;i++)c+="0";return c}if(strLen-dotPos-1>=b){nAfter=dotPos+b+1,d=1;for(j=0;j<b;j++)d*=10;return c=Math.floor(parseFloat(a)*d)/d,c}c=a;for(i=0;i<b-strLen+dotPos+1;i++)c+="0";return c},isNull:function(a){var b=[],c=!1,d=null;if(a==null||a=="")c=!0,d="\u8bf7\u586b\u5199\uff0c\u6b64\u9879\u4e0d\u80fd\u4e3a\u7a7a\uff01";return b.push(c),b.push(d),b}}}),KISSY.add("page/mods/item-handle",function(a){return itemHandle={strProcess:function(a){return a.replace(/\\/g,"\\\\").replace(/\"/g,'\\"').replace(/[\t\n&]/g,"%26")},checkPrice:function(a){return KISSY.isNumber(a)===!1||a<=0?!1:!0},isNull:function(a){return a==null||a==""?!0:!1},isDate:function(a){if(a==null)return!1;if(a.length!=19)return!1;var b=a.substring(0,4),c=a.substring(5,7),e=a.substring(8,10),f=a.substring(11,13),g=a.substring(14,16),h=a.substring(17,19);if(parseInt(b)<2011)return!1;y=parseInt(b,10),d=parseInt(e,10);switch(c){case"01":case"03":case"05":case"07":case"08":case"10":case"12":if(d>31)return!1;break;case"02":if(y%4==0&&d>29||y%4!=0&&d>28)return!1;break;case"04":case"06":case"09":case"11":if(d>30)return!1;break;default:return!1}return parseInt(f)>23||parseInt(g)>59||parseInt(h)>59?!1:a.substring(4,5)!="-"||a.substring(7,8)!="-"||a.substring(13,14)!=":"||a.substring(16,17)!=":"?!1:!0},generalTgParams:function(a,b){var c=[],d=[];result=itemHandle._generalTbSpecParams(a,b),paramsGeneral=result[0];var e=paramsGeneral[0],f=paramsGeneral[1],g=paramsGeneral[2],b=result[1];if(b)DOM.addClass(DOM.get("#J_PromoValue_"+a),"text-error");else{d.push(e),d.push(f);var h=DOM.val(DOM.get("#J_Promo_Start_Time")),i=DOM.val(DOM.get("#J_Promo_End_Time")),j=Number(DOM.val(DOM.get("#J_ItemParam_startNum_"+a))),k=Number(DOM.val(DOM.get("#J_ItemParam_minNum_"+a))),l=Number(DOM.val(DOM.get("#J_ItemParam_maxNum_"+a))),m=Number(DOM.val(DOM.get("#J_ItemParam_maxBuy_"+a))),n=DOM.val(DOM.get("#J_ItemParam_startAt_"+a)),o=DOM.val(DOM.get("#J_ItemParam_endAt_"+a)),p=DOM.val(DOM.get("#J_ItemParam_lastBuy_"+a)),q=DOM.val(DOM.get("#J_ItemParam_time_interval_"+a)),r=DOM.val(DOM.get("#J_ItemParam_tgtype_"+a));!KISSY.isNumber(j)||j<0?(new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u56e2\u8d2d\u521d\u59cb\u53c2\u56e2\u4eba\u6570\u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e0\uff01",type:"error"}),DOM.get("#J_ItemParam_startNum_"+a).focus(),DOM.addClass(DOM.get("#J_ItemParam_startNum_"+a),"text-error"),b=!0):!KISSY.isNumber(k)||k<0?(new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u6700\u5c11\u53c2\u56e2\u4eba\u6570\u5fc5\u987b\u5927\u4e8e0\uff01",type:"error"}),DOM.get("#J_ItemParam_minNum_"+a).focus(),DOM.addClass(DOM.get("#J_ItemParam_minNum_"+a),"text-error"),b=!0):!KISSY.isNumber(l)||l<0||l<k?(new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u6700\u5927\u53c2\u56e2\u4eba\u6570\u5fc5\u987b\u5927\u4e8e0\u4e14\u5927\u4e8e\u7b49\u4e8e\u6700\u5c0f\u53c2\u56e2\u4eba\u6570\uff01",type:"error"}),DOM.get("#J_ItemParam_maxNum_"+a).focus(),DOM.addClass(DOM.get("#J_ItemParam_maxNum_"+a),"text-error"),b=!0):!KISSY.isNumber(m)||m<0?(new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u6bcf\u4eba\u6700\u5927\u8d2d\u4e70\u91cf\u5fc5\u987b\u5927\u4e8e0\uff01",type:"error"}),DOM.get("#J_ItemParam_maxBuy_"+a).focus(),DOM.addClass(DOM.get("#J_ItemParam_maxBuy_"+a),"text-error"),b=!0):itemHandle.isNull(n)||!itemHandle.isDate(n)?(new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u56e2\u8d2d\u5f00\u59cb\u65f6\u95f4\u5fc5\u987b\u4e3a\u65e5\u671f\u683c\u5f0f(\u4f8b2010-01-01 18:00:00\uff01",type:"error"}),DOM.get("#J_ItemParam_startAt_"+a).focus(),DOM.addClass(DOM.get("#J_ItemParam_startAt_"+a),"text-error"),b=!0):itemHandle.isNull(o)||!itemHandle.isDate(o)?(new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u56e2\u8d2d\u7ed3\u675f\u65f6\u95f4\u5fc5\u987b\u4e3a\u65e5\u671f\u683c\u5f0f(\u4f8b2010-01-01 18:00:00)\uff09\uff01",type:"error"}),DOM.get("#J_ItemParam_endAt_"+a).focus(),DOM.addClass(DOM.get("#J_ItemParam_endAt_"+a),"text-error"),b=!0):itemHandle.isNull(p)||!itemHandle.isDate(p)?(new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u4ed8\u6b3e\u622a\u81f3\u65f6\u95f4\u5fc5\u987b\u4e3a\u65e5\u671f\u683c\u5f0f\uff01",type:"error"}),DOM.get("#J_ItemParam_lastBuy_"+a).focus(),DOM.addClass(DOM.get("#J_ItemParam_lastBuy_"+a),"text-error"),b=!0):n<h&&(new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u56e2\u8d2d\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u65e9\u4e8e\u6d3b\u52a8\u5f00\u59cb\u65f6\u95f4"+h+"\uff01",type:"error"}),DOM.get("#J_ItemParam_startAt_"+a).focus(),DOM.addClass(DOM.get("#J_ItemParam_startAt_"+a),"text-error"),b=!0)}return d.push(j),d.push(k),d.push(l),d.push(m),d.push(p),d.push(n),d.push(o),d.push(g),d.push(r),d.push(q),c.push(b),c.push(d),c},_generalTbSpecParams:function(a,b){var c=[],d=DOM.get("#J_IsInt_"+a).value,e=Number(DOM.val(DOM.get("#J_SpecPrice_"+a))),f=Number(DOM.val(DOM.get("#J_ItemPrice_"+a))),g=Number(DOM.attr(DOM.get("#J_DecreaseNum_"+a),"title")),h=Number(DOM.val(DOM.get("#J_IsSku_"+a))),i=DOM.val(DOM.get("#J_Discount")),j=DOM.val("#J_minPrivilege"),k=DOM.val(DOM.get("#J_joinType")),l=0;if(h==1){var m="1";l=Number(DOM.val(DOM.get("#J_PromoValue_"+a)))}else if(d!=0||Number(DOM.val(DOM.get("#J_FinalType_"+a)))==3){var m="0";l=Number((f-e).toFixed(2))}else{var m=Number(DOM.get("#J_PromoType_"+a).value);m=="0"?l=Number(DOM.val(DOM.get("#J_Promo2Value_"+a))):l=Number(DOM.val(DOM.get("#J_PromoValue_"+a)))}if(e>=f||itemHandle.checkPrice(l)===!1||itemHandle.checkPrice(e)==0)new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u7279\u4ef7\u91d1\u989d\u6709\u8bef\uff08\u7279\u4ef7\u5fc5\u987b\u5c0f\u4e8e\u539f\u4ef7\uff09\uff0c\u8bf7\u68c0\u67e5\u540e\u518d\u52a0\u5165\uff01",type:"error"}),b=!0;else if(m=="0")if(type=="tbspec"||type=="tbspec_buyerLimit"||type=="onetbspec"||type=="tg"){if(DOM.val("#J_joinAgain")!="again"){if(k=="all")var n=j;else var n=l;n<=2&&(new H.widget.msgBox({title:"\u6e29\u99a8\u63d0\u9192",content:'\u60a8\u8981\u52a0\u5165\u7684\u5b9d\u8d1d\u4e2d\u6709\u6298\u6263\u7b49\u4e8e\u6216\u4f4e\u4e8e <em class="color-red">2</em> \u6298\uff0c\u786e\u5b9a\u52a0\u5165\u5417\uff1f',type:"confirm",buttons:[{value:"\u786e\u5b9a"},{value:"\u53d6\u6d88"}],success:function(a){a=="\u786e\u5b9a"&&l>Number((f*((10-i)/10)).toFixed(2))&&(new H.widget.msgBox({title:"\u8bf7\u4fee\u6539\u5e97\u94fa\u6700\u4f4e\u6298\u6263",content:'\u60a8\u8bbe\u7f6e\u7684\u5b9d\u8d1d\u6700\u4f4e\u6298\u6263\u7387\u4e3a <em class="color-red">'+n+"</em> \u6298\uff0c"+'\u60a8\u7684\u5e97\u94fa\u6700\u4f4e\u6298\u6263\u4e3a <em class="color-red">'+i+"</em> \u6298\u53ef\u80fd\u4f1a\u4e0d\u751f\u6548\uff0c\u8bf7\u4fee\u6539\u5e97\u94fa\u6700\u4f4e\u6298\u6263\u4f4e\u4e8e\u5b9d\u8d1d\u6298\u6263 "+'<a target="_blank" href="http://ecrm.taobao.com/promotion/show_other_activity.htm">\u4fee\u6539\u5e97\u94fa\u6700\u4f4e\u6298\u6263>></a>',type:"confirm",buttons:[{value:"\u5df2\u4fee\u6539\u5b8c\u6298\u6263\u4ef7\uff0c\u786e\u5b9a\u52a0\u5165\u6d3b\u52a8"}],success:function(a){a=="\u5df2\u4fee\u6539\u5b8c\u6298\u6263\u4ef7\uff0c\u786e\u5b9a\u52a0\u5165\u6d3b\u52a8"&&(DOM.val("#J_joinAgain","again"),promotionControl.getLowestDisAdd())}}),b=!0)}}),b=!0)}}else l>Number((f*.3).toFixed(2))&&(new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u4f18\u60e0\u91d1\u989d\u6709\u8bef\uff0c\u6298\u6263\u6709\u6548\u8303\u56f4\u5728 7.00~9.99\u4e4b\u95f4\uff01",type:"error"}),b=!0);else if(type=="tbspec"||type=="tbspec_buyerLimit"||type=="tg"||type=="onetbspec"){if(DOM.val("#J_joinAgain")!="again"){if(k=="all")var n=j;else var n=l;n<=2&&(new H.widget.msgBox({title:"\u6e29\u99a8\u63d0\u9192",content:'\u60a8\u8981\u52a0\u5165\u7684\u5b9d\u8d1d\u4e2d\u6709\u6298\u6263\u7b49\u4e8e\u6216\u4f4e\u4e8e <em class="color-red">2</em> \u6298\uff0c\u786e\u5b9a\u52a0\u5165\u5417\uff1f',type:"confirm",buttons:[{value:"\u786e\u5b9a"},{value:"\u53d6\u6d88"}],success:function(a){a=="\u786e\u5b9a"&&l<i&&(new H.widget.msgBox({title:"\u8bf7\u4fee\u6539\u5e97\u94fa\u6700\u4f4e\u6298\u6263",content:'\u60a8\u8bbe\u7f6e\u7684\u5b9d\u8d1d\u6700\u4f4e\u6298\u6263\u4e3a <em class="color-red">'+n+"</em> \u6298\uff0c\u60a8\u7684\u5e97\u94fa\u6700\u4f4e\u6298\u6263\u4e3a "+'<em class="color-red">'+i+"</em> \u6298\u53ef\u80fd\u4f1a\u4e0d\u751f\u6548\uff0c\u8bf7\u4fee\u6539\u5e97\u94fa\u6700\u4f4e\u6298\u6263\u4f4e\u4e8e\u5b9d\u8d1d\u6298\u6263 "+'<a target="_blank" href="http://ecrm.taobao.com/promotion/show_other_activity.htm">\u4fee\u6539\u5e97\u94fa\u6700\u4f4e\u6298\u6263>></a>',type:"confirm",buttons:[{value:"\u5df2\u4fee\u6539\u5b8c\u6298\u6263\uff0c\u786e\u5b9a\u52a0\u5165\u6d3b\u52a8"}],success:function(a){a=="\u5df2\u4fee\u6539\u5b8c\u6298\u6263\uff0c\u786e\u5b9a\u52a0\u5165\u6d3b\u52a8"&&(DOM.val("#J_joinAgain","again"),promotionControl.getLowestDisAdd())}}),b=!0)}}),b=!0)}}else if(!KISSY.isNumber(l)||l<7||l>=10)new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u4f20\u5165\u4e86\u4e0d\u5408\u6cd5\u6216\u4e0d\u6b63\u786e\u7684\u53c2\u6570,\u6709\u6548\u8303\u56f4\u5728 7.00~9.99\u4e4b\u95f4\uff01",type:"error"}),DOM.addClass(DOM.get("#J_PromoValue_"+a),"text-error"),b=!0;else{var o=/(^[0-9]([.][0-9]{1,2})?$)|(^1[0-9]([.][0-9]{1,2})?$)|(^2[0-3]([.][0-9]{1,2})?$)|(^10([.]0{1,2})?$)/;o.test(l)||(new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u4f20\u5165\u4e86\u4e0d\u5408\u6cd5\u6216\u4e0d\u6b63\u786e\u7684\u53c2\u6570,\u6709\u6548\u8303\u56f4\u5728 7.00~9.99\u4e4b\u95f4\uff01",type:"error"}),DOM.addClass(DOM.get("#J_PromoValue_"+a),"text-error"),b=!0)}return l.toFixed(2),c.push(m),c.push(l),c.push(g),[c,b]},generalSpecParams:function(a,b){var c=[],d=[],e=Number(DOM.val(DOM.get("#J_PromoPrice_"+a)));itemHandle.checkPrice(e)===!1&&(b=!0,DOM.addClass(DOM.get("#J_PromoPrice_"+a),"text-error")),d.push(e);if(DOM.get("#J_ItemSkus_"+a)==null)return d.push(""),c.push(b),c.push(d),c;var f=DOM.val(DOM.get("#J_ItemSkus_"+a)),g=DOM.val(DOM.get("#J_PropsName_"+a)),h=DOM.val(DOM.get("#J_PropsValue_"+a)),i=[],j="",k="",l=DOM.query("#J_SkuTable_"+a+" .J_SkuOrigPrice"),m=DOM.query("#J_SkuTable_"+a+" .J_SkuPromoPrice"),n=l.length;for(var o=0;o<n;o++)spp=Number(m[o].value),sop=Number(l[o].value),itemHandle.checkPrice(spp)===!1?(DOM.addClass(m[o],"text-error"),b=!0):DOM.removeClass(m[o],"text-error"),k+=m[o].value+",",j+=l[o].value+",";return j=j.substring(0,j.length-1),k=k.substring(0,k.length-1),i.push(j),i.push(k),i.push(f),i.push(g),i.push(h),d.push(i),c.push(b),c.push(d),c},generalTbSpecParams:function(a,b){var c=[],d=[];result=itemHandle._generalTbSpecParams(a,b),d=result[0];var b=result[1];return b&&DOM.addClass(DOM.get("#J_PromoValue_"+a),"text-error"),c.push(b),c.push(d),c},generalJtjParams:function(a,b){var c=[],d=DOM.val("#J_IsSku_"+a),e=Number(DOM.val(DOM.get("#J_ItemPrice_"+a))),f=DOM.query("#J_PromoType_"+a+" .J_promoType"),g=DOM.query("#J_PromoType_"+a+" .J_PromoValue"),h=DOM.query("#J_PromoType_"+a+" .J_PromoIsInt");if(h.length<=0)var i=DOM.get("#J_IsInt_"+a).value;var j=g.length;for(var k=0;k<j;k++){if(h.length>0)var i=Number(DOM.val(h[k]));if(i!=0){var l="0",m=g[k].id.replace("PromoValue","SpecPrice"),n=Number(DOM.val(DOM.get("#"+m)));newValue=Number((e-n).toFixed(2))}else{var l=Number(DOM.val(f[k]));if(l=="0"){var m=g[k].id.replace("PromoValue","SpecPrice"),n=Number(DOM.val(DOM.get("#"+m)));newValue=Number((e-n).toFixed(2))}else newValue=Number(DOM.val(g[k]))}n>=e&&(DOM.addClass(g[k],"text-error"),new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u7279\u4ef7\u91d1\u989d\u6709\u8bef\uff08\u7279\u4ef7\u5fc5\u987b\u5c0f\u4e8e\u539f\u4ef7\uff09\uff0c\u8bf7\u68c0\u67e5\u540e\u518d\u52a0\u5165\uff01",type:"error"}),b=!0);if(d=="1"||l=="1")if(!KISSY.isNumber(newValue)||newValue<=0||newValue>=10)DOM.addClass(g[k],"text-error"),new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u4f20\u5165\u4e86\u4e0d\u5408\u6cd5\u6216\u4e0d\u6b63\u786e\u7684\u53c2\u6570,\u6709\u6548\u8303\u56f4\u5728 0.00~9.99\u4e4b\u95f4\uff01",type:"error"}),b=!0;else{var o=/(^[0-9]([.][0-9]{1,2})?$)|(^1[0-9]([.][0-9]{1,2})?$)|(^2[0-3]([.][0-9]{1,2})?$)|(^10([.]0{1,2})?$)/;o.test(newValue)||(new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u4f20\u5165\u4e86\u4e0d\u5408\u6cd5\u6216\u4e0d\u6b63\u786e\u7684\u53c2\u6570,\u6709\u6548\u8303\u56f4\u5728 0.00~9.99\u4e4b\u95f4\uff01",type:"error"}),DOM.addClass(g[k],"text-error"),b=!0)}else itemHandle.checkPrice(newValue)===!1&&(DOM.addClass(g[k],"text-error"),b=!0);if(b==1)break;param=[l,newValue],c.push(param)}return[b,c]}}},{requires:[]}),KISSY.add("utils/beautifyForm/index",function(a){function g(b,c){var d=this;defaultCfg={init:!0};if(!(d instanceof g))return new g(b,c);var e=a.merge(defaultCfg,c);d._init(b,e)}var b=a.DOM,c=a.Event,d=document,e=b.get("body"),f=!1;return a.UA.safari!="undefined"&&a.UA.safari<3&&(f=!0),a.UA.ie==6&&b.replaceClass("#J_BodyHtml","has-js","no-js"),a.augment(g,{_init:function(a,b){var c=this;c.renderAll(a)},renderAll:function(a){var c=this;a=typeof a=="undefined"?"#J_BodyHtml":a;var d=b.filter(b.query(a+" input"),function(a){if(a.type=="checkbox"||a.type=="radio")return!0});for(var e=d.length-1;e>=0;e--)c.renderInput(d[e])},renderInput:function(a){var c=this,d=b.get(a),e=b.parent(d);e.tagName.toUpperCase()=="LABEL"&&e.className.indexOf("beautify_")>-1?e.className=="beautify_check"?c.renderCheckbox(d):e.className=="beautify_radio"&&c.renderRadio(d):e.tagName.toUpperCase()=="SPAN"&&b.hasClass(d,"beautify_input")&&c.renderCheckPro(d)},renderAllCheckPro:function(a){var c=this,d=b.filter(b.query(a+" input"),function(a){if((a.type=="checkbox"||a.type=="radio")&&b.hasClass(a,"beautify_input"))return!0});if(d.length<1)return;for(var e=d.length-1;e>=0;e--)c.renderCheckPro(d[e])},renderAllCheckbox:function(c){var d=this,e=b.filter(b.query(c+" input"),function(a){if(a.type=="checkbox")return!0});if(e.length<1){a.log("\u6b64id\u4e0b\u6ca1\u6709input(renderAllCheckbox)");return}for(var f=e.length-1;f>=0;f--)d.renderCheckbox(e[f])},renderAllRadio:function(c){var d=this,e=b.filter(b.query(c+" input"),function(a){if(a.type=="radio")return!0});if(e.length<1){a.log("\u6b64id\u4e0b\u6ca1\u6709input(renderAllRadio)");return}for(var f=e.length-1;f>=0;f--)d.renderRadio(e[f])},renderCheckPro:function(d){var e=this,g=b.get(d),h=b.prop(g,"type")=="checkbox",i=b.parent(g,"label")||b.parent(g,"span");if(!b.hasClass(g,"beautify_input")){a.log("input\u5fc5\u987b\u6709class=\u201dbeautify_input\u201c(renderCheckPro)");return}h?f&&g.checked==1||g.checked?(b.removeClass(i,"radio-checkoff-span"),b.addClass(i,"radio-checkon-span"),b.addClass(b.parent(i),"radio-checkstyle")):(b.removeClass(i,"radio-checkon-span"),b.addClass(i,"radio-checkoff-span"),b.removeClass(b.parent(i),"radio-checkstyle")):f&&g.checked==1||g.checked?(b.removeClass(i,"beautify_radio_off"),b.addClass(i,"beautify_radio_on"),b.addClass(b.parent(i),"radio-checkstyle")):(b.removeClass(i,"beautify_radio_on"),b.addClass(i,"beautify_radio_off"),b.removeClass(b.parent(i),"radio-checkstyle")),c.on(i,"click",function(a){a.stopPropagation();if(a.target.tagName.toUpperCase()=="LABEL")return;e.toggleCheckPro(g)})},renderCheckbox:function(a){var d=this,e=b.get(a),g=b.parent(e,"label")||b.parent(e,"span");if(!b.hasClass(g,"beautify_check"))return;e.disabled==1?f&&e.checked==1||e.checked?g.className="beautify_check c_on_disable":g.className="beautify_check beautify_check_disable":(f&&e.checked==1||e.checked?g.className="beautify_check c_on":g.className="beautify_check c_off",c.on(g,"click",function(a){a.stopPropagation();if(a.target.tagName.toUpperCase()=="LABEL")return;d.toggleCheckbox(e)}))},renderRadio:function(a){var d=this,e=b.get(a),g=b.parent(e,"label")||b.parent(e,"span");if(!b.hasClass(g,"beautify_radio"))return;e.disabled==1?f&&e.checked==1||e.checked?g.className="beautify_radio r_on_disable":g.className="beautify_radio beautify_radio_disable":(f&&e.checked==1||e.checked?g.className="beautify_radio r_on":g.className="beautify_radio r_off",c.on(g,"click",function(a){a.stopPropagation();if(a.target.tagName.toUpperCase()=="LABEL")return;d.toggleRadio(e)}))},setCheckboxOn:function(a){var c=b.get(a),d=b.parent(c,"label");d.className="beautify_check c_on",c.checked=!0},setCheckboxOff:function(a){var c=b.get(a),d=b.parent(c,"label");d.className="beautify_check c_off",c.checked=!1},setCheckboxDisabled:function(a){var c=b.get(a),d=b.parent(c,"label");f&&c.checked==1||c.checked?d.className="beautify_check c_on_disable":d.className="beautify_check beautify_check_disable",c.disabled=!0},setCheckboxNoDisabled:function(a){var c=b.get(a),d=b.parent(c,"label");f&&c.checked==1||c.checked?d.className="beautify_check c_on_disable":d.className="beautify_check beautify_check_disable",c.disabled=!1},toggleCheckbox:function(a){var c=b.get(a),d=b.parent(c,"label");d.className=="beautify_check c_off"?(d.className=="beautify_check c_on_disable"?d.className="beautify_check c_on_disable":d.className="beautify_check c_on",f&&c.click()):d.className=="beautify_check c_on_disable"?(d.className="beautify_check c_on_disable",f&&c.click()):d.className=="beautify_check beautify_check_disable"?(d.className="beautify_check beautify_check_disable",f&&c.click()):(d.className="beautify_check c_off",f&&c.click())},toggleRadio:function(a){var c=b.get(a),d=b.attr(c,"name"),e=b.parent(c,"label");if(e.className=="beautify_radio r_off"||c.checked){var g=b.filter(b.query("input"),function(a){if(a.type=="radio")return!0});for(var h=0;h<g.length;h++){var i=b.parent(g[h]);if(i.className.indexOf("beautify_radio")==-1)continue;if(b.attr(g[h],"name")!==d)continue;i.className="beautify_radio r_off"}e.className="beautify_radio r_on",f&&c.click()}else e.className=="beautify_radio beautify_radio_disable"?(e.className="beautify_radio beautify_radio_disable",f&&c.click()):(e.className="beautify_radio r_off",f&&c.click())},setRadioOn:function(a){var c=b.get(a),d=b.attr(c,"name"),e=b.parent(c,"label");if(e.className=="beautify_radio r_off"||c.checked){var f=b.filter(b.query("input"),function(a){if(a.type=="radio")return!0});for(var g=0;g<f.length;g++){var h=b.parent(f[g]);if(h.className.indexOf("beautify_radio")==-1)continue;if(b.attr(f[g],"name")!==d)continue;h.className="beautify_radio r_off"}e.className="beautify_radio r_on",c.checked=!0}},toggleCheckPro:function(a){var c=b.get(a),d=b.prop(c,"type")=="checkbox",e=b.attr(c,"name"),g=b.parent(a,"span");if(d)b.hasClass(g,"radio-checkon-span")?(b.removeClass(b.parent(g),"radio-checkstyle"),b.removeClass(g,"radio-checkon-span"),b.hasClass(g,"radio-checkoff-span")||b.addClass(g,"radio-checkoff-span")):(b.addClass(b.parent(g),"radio-checkstyle"),b.toggleClass(g,"radio-checkon-span","radio-checkoff-span"));else if(b.hasClass(g,"beautify_radio_off")){var h=b.filter(b.query(".beautify_input"),function(a){if(a.type=="radio")return!0});for(var c=0;c<h.length;c++){var i=h[c],j=b.parent(h[c]);if(i.className.indexOf("beautify_input")==-1)continue;if(b.attr(i,"name")!==e)continue;j.className="beautify_radio_off",b.removeClass(b.parent(j),"radio-checkstyle")}b.addClass(b.parent(g),"radio-checkstyle"),g.className="beautify_radio_on",f&&c.click()}else b.addClass(b.parent(g),"radio-checkstyle"),g.className="beautify_radio_on",f&&c.click()},setRadioPro:function(a){var c=b.get(a),d=b.attr(c,"name"),e=b.parent(a,"span"),f=b.filter(b.query(".beautify_input"),function(a){if(a.type=="radio")return!0});for(var c=0;c<f.length;c++){var g=f[c],h=b.parent(f[c]);if(g.className.indexOf("beautify_input")==-1)continue;if(b.attr(g,"name")!==d)continue;h.className="beautify_radio_off",b.removeClass(b.parent(h),"radio-checkstyle")}b.addClass(b.parent(e),"radio-checkstyle"),e.className="beautify_radio_on",b.get(a).checked=!0},setRadioProOff:function(a){var c=b.get(a),d=b.attr(c,"name"),e=b.parent(a,"span"),f=b.filter(b.query(".beautify_input"),function(a){if(a.type=="radio")return!0});for(var c=0;c<f.length;c++){var g=f[c],h=b.parent(f[c]);if(g.className.indexOf("beautify_input")==-1)continue;if(b.attr(g,"name")!==d)continue;h.className="beautify_radio_on"}e.className="beautify_radio_off",b.get(a).checked=!1},setCheckboxProOn:function(a){var c=b.get(a),d=b.attr(c,"name"),e=b.parent(a,"span");b.addClass(b.parent(e),"radio-checkstyle"),b.toggleClass(e,"radio-checkon-span","radio-checkoff-span"),b.get(a).checked=!0},setCheckboxProOff:function(a){var c=b.get(a),d=b.attr(c,"name"),e=b.parent(a,"span");b.removeClass(b.parent(e),"radio-checkstyle"),b.removeClass(e,"radio-checkon-span"),b.hasClass(e,"radio-checkoff-span")||b.addClass(e,"radio-checkoff-span"),b.get(a).checked=!1}}),g}),KISSY.add("utils/showPages/index",function(a){function e(a){var b=this;if(!(b instanceof e))return new e(a);this.pageNum=4,this.name=a,this.page=1,this.pageCount=200,this.argName="page"}var b=a.DOM,c=a.Event,d=document;return a.mix(e.prototype,{jump:function(){return undefined},checkPages:function(){isNaN(parseInt(this.page))&&(this.page=1),isNaN(parseInt(this.pageCount))&&(this.pageCount=1),this.page<1&&(this.page=1),this.pageCount<1&&(this.pageCount=1),this.page>this.pageCount&&(this.page=this.pageCount),this.page=parseInt(this.page),this.pageCount=parseInt(this.pageCount)},_createHtml:function(a){var b=this,c="",d=this.page-1,e=this.page+1;if(a==""||typeof a=="undefined")a=1;switch(a){case 1:c+='<div class="page-bottom"> <div class="sabrosus">',c+='<font class="number">',c+="\u5171"+this.pageCount+"\u9875&nbsp;",c+='<input style="" type="text"  class="page-input" id="pageInput'+b.name+'"  value="\u9875\u7801" onkeypress="return window.'+b.name+".formatInputPage(event);\" onfocus=\"this.className='page-input page-input-text-on ';if(this.value=='\u9875\u7801'){this.value = '';}\" onblur=\"this.className='page-input';if(this.value==''){this.value = '\u9875\u7801'}\">",c+='<input type="button" value="Go" class="btm-go" onclick="javascript:var page = document.getElementById(\'pageInput'+b.name+"').value; if(isNaN(Number(page))|| Number(page)==0) { var turnTo = 1;} else if(page>"+this.pageCount+"){ var turnTo = "+this.pageCount+";} else{var turnTo = page;}  window."+b.name+'.toPage(turnTo);" >',c+="</font>",d<1?c+='<span class="pre-none page-pic-no"></span>':c+='<span title="\u4e0a\u4e00\u9875" class="pre page-pic-no" onclick="'+b.name+".toPage("+d+');"></span>',e>this.pageCount?c+='<span class="next-none page-pic-no"></span>':c+='<span title="\u4e0b\u4e00\u9875" class="next page-pic-no" onclick="'+b.name+".toPage("+e+');"></span>',c+='<div style="clear:both"></div></div></div> ';break;case 2:if(this.pageCount>1){c+='<div class="page-bottom"> <div class="sabrosus">',this.pageCount>5&&(c+='<font class="number">',c+="\u5171"+this.pageCount+"\u9875&nbsp;",c+='<input style="" type="text"  class="page-input" id="pageInput'+b.name+'"  value="\u9875\u7801" onkeypress="return window.'+b.name+".formatInputPage(event);\" onfocus=\"this.className='page-input page-input-text-on ';if(this.value=='\u9875\u7801'){this.value = '';}\" onblur=\"this.className='page-input';if(this.value==''){this.value = '\u9875\u7801'}\">",c+='<input type="button" value="Go" class="btm-go" onclick="javascript:var page = document.getElementById(\'pageInput'+b.name+"').value; if(isNaN(Number(page))|| Number(page)==0) { var turnTo = 1;} else if(page>"+this.pageCount+"){ var turnTo = "+this.pageCount+";} else{var turnTo = page;}  window."+b.name+'.toPage(turnTo);" >',c+="</font>"),d<1?c+='<span class="pre-none page-pic-no"></span>':c+='<span title="\u4e0a\u4e00\u9875" class="pre page-pic-no" onclick="'+b.name+".toPage("+d+');"></span>',this.page==1;if(this.page-2<=0){var f=1;if(this.pageCount>this.page+4)var g=this.page+4;else var g=this.pageCount}else if(this.page+2>=this.pageCount){var f=this.pageCount-4;if(this.pageCount>this.page+4)var g=this.page+4;else var g=this.pageCount}else{var f=this.page-2;if(this.pageCount>this.page+2)var g=this.page+2;else var g=this.pageCount}for(var h=f;h<=g;h++)h>0&&(h==this.page?c+='<span class="current a-padding">'+h+"</span>":c+='<a class="a-padding" href="javascript:'+b.name+".toPage("+h+');">'+h+"</a>");this.page+5<this.pageCount&&(c+='<a class="a-padding" title="" href="javascript:'+b.name+".toPage("+(this.page+3)+');">...</a>'),this.page==this.pageCount,e>this.pageCount?c+='<span class="next-none page-pic-no"></span>':c+='<span title="\u4e0b\u4e00\u9875" class="next page-pic-no" onclick="'+b.name+".toPage("+e+');"></span>',c+='<div style="clear:both"></div></div></div> '}break;case 3:c+='<div class="page-top"><div class="sabrosus"><span class="count">'+this.page+" / "+this.pageCount+"</span>",d<1?c+=' <span class="pre-none page-pic-no"></span>':c+='<a class="border-left-dedede" href="javascript:'+b.name+".toPage("+d+');" title="\u4e0a\u4e00\u9875"><span class="pre page-pic-no"></span></a>',e>this.pageCount?c+='<span class="next-none page-pic-no"></span>':c+='<a href="javascript:'+b.name+".toPage("+e+');" title="\u4e0b\u4e00\u9875"><span class="next page-pic-no"></span></a>',c+='<div style="clear:both"></div></div></div>'}return c},formatInputPage:function(a){var b=navigator.appName=="Microsoft Internet Explorer"?!0:!1;if(!b)var c=a.which;else var c=event.keyCode;return c==8||c==46||c>=48&&c<=57?!0:!1},toPage:function(a,b){var c=1,d=this;typeof a=="object"?c=a.options[a.selectedIndex].value:c=a,d.jump(c,b,"")},printHtml:function(a,c){return this.checkPages(),b.html(a,this._createHtml(c)),this},setPageCount:function(a){return this.pageCount=a,this},getPageCount:function(){return this.pageCount},setRender:function(a){return this.jump=a,this},setPageNum:function(a){return this.pageNum=a,this},setPage:function(a){return this.page=a,this}}),e}),KISSY.add("page/Copy of add-init",function(S,checkUtil,itemHandle,beautifyForm,Select,Tooltip,Calendar,Overlay,XTemplate,showPages,Switchable){var DOM=S.DOM,Event=S.Event;return promotionControl={isEidt:promotionForm.id.value!="0"?!0:!1,isChange:!1,NameError:!1,DescError:!1,tooltip:null,x:new beautifyForm,editMjsRemove:[],mjsData:eval("("+mjsJson+")"),mjsRemove:eval("("+itemsJson+")"),mjspartData:eval("("+mjspartJson+")"),mjspartAttend:eval("("+mjspartAttendJson+")"),mjspartNothing:eval("("+mjspartNothingJson+")"),jtjData:eval("("+jtjJson+")"),init:function(){if(parentType=="mjs"||parentType=="mjscp")promotionControl.tooltip||(promotionControl.tooltip=(new Tooltip.Tip({trigger:".J_promptHelp",alignType:"top",offset:10,elCls:"ui-tip"})).render());if(parentType=="tbspec"||parentType=="freepost"||parentType=="onetbspec"||parentType=="buyerlimit"||parentType=="mjscp"){var a=[{text:"\u666e\u901a\u4f1a\u5458",value:"10"},{text:"\u9ad8\u7ea7\u4f1a\u5458",value:"20"},{text:"VIP\u4f1a\u5458",value:"30"},{text:"\u81f3\u5c0aVIP",value:"40"}],b=S.JSON.parse(privilegeObj);a=a.concat(b);var c=new Select.Select({render:"#J_chooseObj",valueField:"#J_chooseObjHide",items:a,visibleMode:"display"});c.render();var e=DOM.val("#J_Preferential");c.setSelectedValue(e),c.on("change",function(a){promotionControl.isChange=!0})}parentType=="mjscp"&&promotionControl.loadingCheck(),parentType=="mjs"||parentType=="mjscp"||parentType=="freepost"?(promotionControl.mjsData.length>0&&promotionControl.renderMjs(),promotionControl.mjsRemove.length>0&&promotionControl.renderRemoveItem()):parentType=="mjspartjtj"?(promotionControl.mjspartData.length>0&&promotionControl.renderMjspart(),promotionControl.mjspartAttend.length>0&&promotionControl.renderMjspartAttend(),promotionControl.mjspartNothing.length>0&&promotionControl.renderMjspartNothing()):parentType=="jtj"&&promotionControl.jtjData.length>0&&promotionControl.renderJtj(),parentType=="mjs"||parentType=="mjscp"||parentType=="freepost"?Event.on("#J_addMjs","click",promotionControl.addMjs):parentType=="mjspartjtj"?Event.on("#J_addMjs","click",promotionControl.addMjspart):parentType=="jtj"&&Event.on("#J_addMjs","click",promotionControl.addJtj),parentType=="jtj"&&new Calendar.DatePicker({trigger:".J_tiems",showTime:!0,autoRender:!0,autoSetValue:!0,delegateTigger:!0}),Event.delegate(document,"click",".bui-ext-close",function(){DOM.remove(".bui-dialog"),parentType!="mjspartjtj"&&(DOM.val("#J_mjsSalesType")==0?promotionControl.x.setRadioPro("#J_mjsJian"):promotionControl.x.setRadioPro("#J_mjsYuan"))}),Event.delegate(document,"click","#J_searchBtn",function(){promotionControl.searchPromoItems()}),Event.delegate(document,"click",".J_removeBtn",function(a){var b=DOM.attr(a.currentTarget,"pid");if(parentType=="mjspartjtj"){var c=DOM.val("#J_joinItemType");c=="join"?(promotionControl.addMjspartAttend(b),promotionControl.renderMjspartAttend()):(promotionControl.addMjspartNothing(b),promotionControl.renderMjspartNothing())}else promotionControl.addRemoveItem(b),promotionControl.renderRemoveItem()}),Event.delegate(document,"click",".J_cancelBtn",function(a){var b=DOM.attr(a.currentTarget,"pid");if(parentType=="mjspartjtj"){var c=DOM.val("#J_joinItemType");c=="join"?(promotionControl.cancelMjspartAttend(b),promotionControl.renderMjspartAttend()):(promotionControl.cancelMjspartNothing(b),promotionControl.renderMjspartNothing())}else promotionControl.cancelRemoveItem(b),promotionControl.renderRemoveItem()}),Event.delegate(document,"click",".J_editCancelBtn",function(a){var b=DOM.attr(a.currentTarget,"pid");promotionControl.editRemoveItem(b)}),Event.delegate(document,"click",".J_editUndoBtn",function(a){var b=DOM.attr(a.currentTarget,"pid");promotionControl.editCancelItem(b)}),Event.delegate(document,"mouseenter mouseleave",".J_listItem",function(a){a.type=="mouseenter"?DOM.addClass(a.currentTarget,"current"):a.type=="mouseleave"&&DOM.removeClass(a.currentTarget,"current")}),Event.on(".J_joinItem","click",function(a){var b=DOM.attr(a.currentTarget,"data");DOM.val("#J_joinItemType",b)}),Event.on(".J_nothingItem","click",function(a){var b=DOM.attr(a.currentTarget,"data");DOM.val("#J_joinItemType",b)}),Event.on("#J_trimPrice","click",function(a){a.currentTarget.checked==1&&(DOM.val("#J_tiaozheng",1),DOM.hide("#J_batchBox"))}),Event.on("#J_batchPrice","click",function(a){a.currentTarget.checked==1&&(DOM.val("#J_tiaozheng",0),promotionControl.x.setRadioOn("#J_onePrice1"),DOM.show("#J_batchBox"))}),Event.on("#J_IsPromodesc","click",function(a){a.currentTarget.checked==1?(promotionControl.checkTbItemNum(a.currentTarget),DOM.val(a.currentTarget,1),DOM.show("#J_PromodescBox"),DOM.show("#J_editShopDesc")):(DOM.val(a.currentTarget,0),DOM.hide("#J_PromodescBox"),DOM.hide("#J_editShopDesc"))}),Event.on("#J_promoExplain","click",function(a){a.currentTarget.checked==1?DOM.show("#J_shopDesc"):DOM.hide("#J_shopDesc")}),Event.on("#J_caps","click",function(a){a.currentTarget.checked==1?DOM.val("#J_timeInterval",12):DOM.val("#J_timeInterval",0)}),Event.on("#J_B","click",function(a){a.currentTarget.checked==1&&(DOM.hide("#J_setDiscount"),DOM.hide("#J_overcomeItem"),DOM.show("#J_PromoDescTempletBox"),DOM.val("#J_RangeTypeValue","PART"),parentType=="tbspec"?DOM.val("#J_TypeId",2):parentType=="mjs"?DOM.val("#J_TypeId",108):parentType=="mjscp"?DOM.val("#J_TypeId",208):parentType=="freepost"&&DOM.val("#J_TypeId",106),(parentType=="mjs"||parentType=="mjscp"||parentType=="freepost")&&changePromoDescTem(DOM.val("#J_TypeId"),"PART"))}),Event.on("#J_Quandian","click",function(a){a.currentTarget.checked==1&&(DOM.show("#J_setDiscount"),DOM.show("#J_overcomeItem"),parentType=="tbspec"?DOM.val("#J_TypeId",12):parentType=="mjs"?promotionControl.mjsRemove.length>0?(DOM.val("#J_TypeId",117),DOM.hide("#J_PromoDescTempletBox"),DOM.val("#J_RangeTypeValue","PART_NOT")):(DOM.val("#J_TypeId",107),DOM.show("#J_PromoDescTempletBox"),DOM.val("#J_RangeTypeValue","ALL")):parentType=="mjscp"?promotionControl.mjsRemove.length>0?(DOM.val("#J_TypeId",217),DOM.hide("#J_PromoDescTempletBox"),DOM.val("#J_RangeTypeValue","PART_NOT")):(DOM.val("#J_TypeId",207),DOM.show("#J_PromoDescTempletBox"),DOM.val("#J_RangeTypeValue","ALL")):parentType=="freepost"&&(promotionControl.mjsRemove.length>0?(DOM.val("#J_TypeId",115),DOM.hide("#J_PromoDescTempletBox"),DOM.val("#J_RangeTypeValue","PART_NOT")):(DOM.val("#J_TypeId",105),DOM.show("#J_PromoDescTempletBox"),DOM.val("#J_RangeTypeValue","ALL"))),(parentType=="mjs"||parentType=="mjscp"||parentType=="freepost")&&changePromoDescTem(DOM.val("#J_TypeId"),"ALL"))}),Event.on("#J_mjsYuan","click",function(a){if(a.currentTarget.checked==1){parentType=="freepost"&&(DOM.get("#J_Quandian").checked==1?promotionControl.mjsRemove.length>0?DOM.val("#J_TypeId",115):DOM.val("#J_TypeId",105):DOM.val("#J_TypeId",106)),DOM.show("#J_discountDetail");if(DOM.val("#J_mjsSalesType")==0){promotionControl.tempSaveMjs();var b="";for(var c=0;c<promotionControl.mjsData.length;c++)b+=promotionControl.mjsData[c].con_value;if(b==""||b==0)promotionControl.isChange=!0,DOM.val("#J_mjsSalesType",1),promotionControl.renderMjs();else{var d='<div class="pop-reset-mjs"><p>\u60a8\u5c06\u6d3b\u52a8\u6761\u4ef6\u7531 <b>\u6ee1\u4ef6\u4f18\u60e0</b> \u5207\u6362\u4e3a <b class="color-red">\u6ee1\u5143\u4f18\u60e0</b></p><ul id="J_termMjsList"></ul></div>';(new Overlay.Dialog({title:"\u91cd\u65b0\u8bbe\u7f6e\u5c42\u7ea7\u6761\u4ef6",width:520,mask:!0,buttons:[{text:"\u786e\u5b9a",elCls:"bui-button bui-button-primary",handler:function(){promotionControl.isChange=!0,DOM.val("#J_mjsSalesType",1);var a=DOM.children("#J_termMjsList");for(var b=0;b<a.length;b++)promotionControl.mjsData[b].con_value=DOM.val(DOM.get("#J_replaceVal"+b));promotionControl.renderMjs(),this.destroy()}},{text:"\u53d6\u6d88",elCls:"bui-button J_buttonCancel",handler:function(){DOM.val("#J_mjsSalesType")==0&&promotionControl.x.setRadioPro("#J_mjsJian"),this.destroy()}}],bodyContent:d})).show(),promotionControl.replaceTerm()}}}}),Event.on("#J_mjsJian","click",function(a){if(a.currentTarget.checked==1){parentType=="freepost"&&(DOM.get("#J_Quandian").checked==1?promotionControl.mjsRemove.length>0?DOM.val("#J_TypeId",115):DOM.val("#J_TypeId",105):DOM.val("#J_TypeId",106)),DOM.show("#J_discountDetail");if(DOM.val("#J_mjsSalesType")==1){promotionControl.tempSaveMjs();var b="";for(var c=0;c<promotionControl.mjsData.length;c++)b+=promotionControl.mjsData[c].con_value;if(b==""||b==0)promotionControl.isChange=!0,DOM.val("#J_mjsSalesType",0),promotionControl.renderMjs();else{var d='<div class="pop-reset-mjs"><p>\u60a8\u5c06\u6d3b\u52a8\u6761\u4ef6\u7531 <b>\u6ee1\u5143\u4f18\u60e0</b> \u5207\u6362\u4e3a <b class="color-red">\u6ee1\u4ef6\u4f18\u60e0</b></p><ul id="J_termMjsList"></ul></div>';(new Overlay.Dialog({title:"\u91cd\u65b0\u8bbe\u7f6e\u5c42\u7ea7\u6761\u4ef6",width:520,mask:!0,buttons:[{text:"\u786e\u5b9a",elCls:"bui-button bui-button-primary",handler:function(){promotionControl.isChange=!0,DOM.val("#J_mjsSalesType",0);var a=DOM.children("#J_termMjsList");for(var b=0;b<a.length;b++)promotionControl.mjsData[b].con_value=DOM.val(DOM.get("#J_replaceVal"+b));promotionControl.renderMjs(),this.destroy()}},{text:"\u53d6\u6d88",elCls:"bui-button J_buttonCancel",handler:function(){DOM.val("#J_mjsSalesType")==1&&promotionControl.x.setRadioPro("#J_mjsYuan"),this.destroy()}}],bodyContent:d})).show()}}promotionControl.replaceTerm()}}),Event.on("#J_unconditional","click",function(a){a.currentTarget.checked==1&&(DOM.hide("#J_discountDetail"),DOM.val("#J_TypeId",130))}),Event.on("#J_promoName","focusin",function(a){if(parentType=="mjs"||parentType=="freepost"||parentType=="mjscp"){var b=S.one("#J_showCase");b.fadeIn(2)}else DOM.show(".J_editFlag")}),S.each(DOM.query(".J_flagItem"),function(a){Event.on(a,"click",function(a){var b=DOM.text(a.currentTarget);DOM.val("#J_promoName",b),DOM.text("#J_previewFlag",b)})});if(parentType!="jtj"||parentType!="spec"){var f=new Calendar.DatePicker({trigger:"#J_startDate",showTime:!0,autoRender:!0,autoSetValue:!1}),g=new Calendar.DatePicker({trigger:"#J_endDate",showTime:!0,autoRender:!0,autoSetValue:!1});f.on("selectedchange",function(a){var b=H.util.stringToDate(S.one("#J_endDate").val()),c=a.value;if(b!=""&&c.getTime()>=b.getTime())DOM.hide("#J_endMsg"),DOM.show("#J_endNote"),DOM.show("#J_staartMsg"),DOM.text("#J_staartMsg","\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u5927\u4e8e\u7ed3\u675f\u65f6\u95f4\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9");else{DOM.hide("#J_endMsg"),DOM.show("#J_endNote"),DOM.hide("#J_staartMsg"),S.one("#J_startDate").val(a.text);var e=a.text.split(" ")[0].split("-"),f=e[0]+"\u5e74"+e[1]+"\u6708"+e[2]+"\u65e5";DOM.text("#J_promoDescStart",f);var g=parseInt((b.getTime()-c.getTime())/1e3);d=parseInt(g/86400%1e4),h=parseInt(g/3600%24),str="\u6d3b\u52a8\u6301\u7eed "+d+" \u5929 "+h+" \u5c0f\u65f6",DOM.html("#J_endNote",str),promotionControl.isChange=!0}}),g.on("selectedchange",function(a){var b=a.value,c=H.util.stringToDate(S.one("#J_startDate").val()),e=H.util.stringToDate(b);if(e.getTime()<=c.getTime()&&c!="")DOM.hide("#J_staartMsg"),DOM.hide("#J_endNote"),DOM.show("#J_endMsg"),DOM.text("#J_endMsg","\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u5c0f\u4e8e\u5f00\u59cb\u65f6\u95f4\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9");else{DOM.hide("#J_staartMsg"),DOM.show("#J_endNote"),DOM.hide("#J_endMsg"),S.one("#J_endDate").val(a.text);var f=a.text.split(" ")[0].split("-"),g=f[0]+"\u5e74"+f[1]+"\u6708"+f[2]+"\u65e5";DOM.text("#J_promoDescEnd",g);var i=parseInt((e.getTime()-c.getTime())/1e3);d=parseInt(i/86400%1e4),h=parseInt(i/3600%24),str="\u6d3b\u52a8\u6301\u7eed "+d+" \u5929 "+h+" \u5c0f\u65f6",DOM.html("#J_endNote",str),promotionControl.isChange=!0}})}promotionControl.handleInputs(),Event.on(".J_removeItem","click",function(a){var b=DOM.attr(a.currentTarget,"way");if(b=="radio")var c="\u9009\u62e9\u5b9d\u8d1d",d="tip-add-details";else var c="\u6392\u9664\u5b9d\u8d1d",d="tip-details";var e='<div class="main-screen"><ul><li class="fl"><div class="price-among"><span>\u4ef7\u683c\u533a\u95f4</span><input type="text" class="price-start" id="J_startPrice"><i>-</i><input type="text" class="price-end" id="J_endPrice"></div></li><div class="uboxstyle-1 fl J_Seach_1" id="J_SelectItemCidBox"><input type="hidden" id="J_SelectItemCid"></div><li class="fr"><div class="search-promo"><input type="text" id="J_SearchTitle" onblur="this.className=\'search-input\';if(this.value==\'\'){this.value = \'\u5173\u952e\u5b57\u3001\u94fe\u63a5\u3001\u5546\u54c1\u7f16\u7801\'}" onfocus="this.className=\'search-input\';if(this.value==\'\u5173\u952e\u5b57\u3001\u94fe\u63a5\u3001\u5546\u54c1\u7f16\u7801\'){this.value = \'\';}" value="\u5173\u952e\u5b57\u3001\u94fe\u63a5\u3001\u5546\u54c1\u7f16\u7801" class="search-input"><a class="search-btn" id="J_searchBtn">\u641c\u7d22\u5b9d\u8d1d</a></div></li></ul></div><div class="ui-list"><div class="loading" id="J_LeftLoading" style="display:none;"></div><div class="list-bd" id="J_MainLeftContent"><div id="J_LEmpty" class="'+d+'"></div>'+'<ul id="J_PromoItems" class="remove-list"></ul>'+"</div>"+'<div id="J_PromotionItemPaging" class="ui-page"></div>'+"</div>";(new Overlay.Dialog({title:c,width:700,height:625,mask:!0,footerStyle:{display:"none"},bodyContent:e})).show(),promoSelect=new Select.Select({render:"#J_SelectItemCidBox",valueField:"#J_SelectItemCid",items:S.JSON.parse(sellerCats),visibleMode:"display"}),promoSelect.render(),promoSelect.setSelectedValue("0")}),Event.on("#J_hasMore","click",function(){var a=promotionControl.editMjsRemove.length;for(i=0;i<a;i++)promotionControl.editMjsRemove.splice(i,a);var b='<div class="ui-list"><div class="list-bd" id="J_editRemoveList"><div class="edit-remove-item"><ul id="J_moreItemListUl" class="remove-list ks-switchable-content"></ul><div><ul class="ks-switchable-nav"></ul></div></div>';(new Overlay.Dialog({title:"\u7f16\u8f91\u5df2\u6392\u9664\u5b9d\u8d1d",width:700,height:545,mask:!0,buttons:[{text:"\u786e\u5b9a",elCls:"bui-button bui-button-primary",handler:function(){for(var a=0;a<promotionControl.editMjsRemove.length;a++)for(var b=0;b<promotionControl.mjsRemove.length;b++)promotionControl.mjsRemove[b].id==promotionControl.editMjsRemove[a].id&&promotionControl.mjsRemove.splice(b,1);promotionControl.renderRemoveItem();if(promotionControl.mjsRemove.length==0||promotionControl.mjsRemove.length=="")parentType=="mjs"?DOM.val("#J_TypeId",107):parentType=="freepost"?DOM.val("#J_TypeId",105):parentType=="mjscp"&&DOM.val("#J_TypeId",207),DOM.show("#J_PromoDescTempletBox"),DOM.val("#J_RangeTypeValue","ALL");this.destroy()}},{text:"\u53d6\u6d88",elCls:"bui-button J_buttonCancel",handler:function(){this.destroy()}}],bodyContent:b})).show(),promotionControl.renderMoreItem();var c=new Switchable.Slide("#J_editRemoveList",{effect:"scrolly",easing:"easeOutStrong",steps:5,triggerType:"click",autoplay:!1})}),promotionControl.getPromoItemNum(),Event.on("#J_updateDiscount","click",function(){DOM.val("#J_isDiscount","1");var a=IsExpired();if(a>-5e3){var b=function(a){promotionControl.getPromoItemNum()},c=function(a){KISSY.Event.fire(".J_TopExpired","click")},d="";(new H.widget.asyncRequest).setURI(isExpiredUrl).setMethod("GET").setHandle(b).setErrorHandle(c).setData(d).send()}else promotionControl.getPromoItemNum()});var j=null;Event.on("#J_BtnPublish","click dblclick",function(a){if(!promotionControl.isChange&&promotionControl.isEidt){window.location.href=nextTargerUrl;return}var b=DOM.attr(".J_TopExpired","data");if(DOM.val("#J_TypeId")==12){var c=DOM.val("#J_promoDesc"),d=DOM.val("#J_startDate"),e=DOM.val("#J_endDate"),f=DOM.val("#J_promoName"),g=DOM.val("#J_onsaleNum"),h=DOM.val("#J_instockNum"),i=DOM.val("#J_promoDiscount"),k='<div class="pop-is-promo"><div class="ui-about-list" style="margin:0;"><ul><li><div class="ui-side-list">\u6d3b\u52a8\u540d\u79f0\uff1a</div><div class="ui-content-list">'+c+"</div> "+"</li> "+"<li>"+'<div class="ui-side-list">\u6d3b\u52a8\u65f6\u95f4\uff1a</div>'+'<div class="ui-content-list">'+d+" - "+e+" </div>  "+"</li> "+"<li>"+'<div class="ui-side-list">\u6d3b\u52a8\u6807\u7b7e\uff1a</div>'+'<div class="ui-content-list"><a class="promo-flag">'+f+"</a></div> "+"</li> "+"<li>"+' <div class="ui-side-list">\u6d3b\u52a8\u4e2d\u5b9d\u8d1d\uff1a</div>'+' <div class="ui-content-list"><b class="color-red">'+h+"</b> \u4ef6</div>"+"</li> "+"<li>"+' <div class="ui-side-list">\u6d3b\u52a8\u6298\u6263\uff1a</div>'+'<div class="ui-content-list"><b class="color-red">'+i+"</b> \u6298</div>"+"</li> "+"</ul>"+"</div>	"+"</div>";(new Overlay.Dialog({title:"\u5168\u5e97\u53c2\u4e0e\u6298\u6263",width:450,mask:!0,buttons:[{text:"\u786e\u5b9a",elCls:"bui-button bui-button-primary",handler:function(){a.type=="click"&&(clearTimeout(j),j=setTimeout(function(){var a=IsExpired();if(a>-5e3){var b=function(a){promotionControl.save()},c=function(a){(new Overlay.Dialog({title:"\u8bf7\u6388\u6743",width:400,height:200,mask:!0,buttons:[{text:"\u786e\u5b9a",elCls:"bui-button bui-button-primary",handler:function(){this.destroy()}}],bodyContent:'<div class="pop-accredit">\u4eb2\uff0c\u6388\u6743\u5df2\u8fc7\u671f\uff0c\u8bf7\u6388\u6743&nbsp;&nbsp;<a target="_blank" href="https://oauth.taobao.com/authorize?client_id=12029422&scope=item,promotion,usergrade&response_type=code&redirect_uri=http://promo.huanleguang.com">\u7acb\u5373\u6388\u6743</a></div>'})).show()},d="";(new H.widget.asyncRequest).setURI(isExpiredUrl).setMethod("GET").setHandle(b).setErrorHandle(c).setData(d).send()}else promotionControl.save()},300));if(a.type=="dblclick"){clearTimeout(j);var c=IsExpired();if(c>-5e3){var d=function(a){promotionControl.save()},e=function(a){(new Overlay.Dialog({title:"\u8bf7\u6388\u6743",width:400,height:200,mask:!0,buttons:[{text:"\u786e\u5b9a",elCls:"bui-button bui-button-primary",handler:function(){this.destroy()}}],bodyContent:'<div class="pop-accredit">\u4eb2\uff0c\u6388\u6743\u5df2\u8fc7\u671f\uff0c\u8bf7\u6388\u6743&nbsp;&nbsp;<a target="_blank" href="'+b+'">\u7acb\u5373\u6388\u6743</a></div>'})).show()},f="";(new H.widget.asyncRequest).setURI(isExpiredUrl).setMethod("GET").setHandle(d).setErrorHandle(e).setData(f).send()}else promotionControl.save()}}},{text:"\u5173\u95ed",elCls:"bui-button J_buttonCancel",handler:function(){this.destroy()}}],bodyContent:k})).show()}else{a.type=="click"&&(clearTimeout(j),j=setTimeout(function(){var a=IsExpired();if(a>-5e3){var c=function(a){promotionControl.save()},d=function(a){(new Overlay.Dialog({title:"\u8bf7\u6388\u6743",width:400,height:200,mask:!0,buttons:[{text:"\u786e\u5b9a",elCls:"bui-button bui-button-primary",handler:function(){this.destroy()}}],bodyContent:'<div class="pop-accredit">\u4eb2\uff0c\u6388\u6743\u5df2\u8fc7\u671f\uff0c\u8bf7\u6388\u6743&nbsp;&nbsp;<a target="_blank" href="'+b+'">\u7acb\u5373\u6388\u6743</a></div>'})).show()},e="";(new H.widget.asyncRequest).setURI(isExpiredUrl).setMethod("GET").setHandle(c).setErrorHandle(d).setData(e).send()}else promotionControl.save()},300));if(a.type=="dblclick"){clearTimeout(j);var l=IsExpired();if(l>-5e3){var m=function(a){promotionControl.save()},n=function(a){(new Overlay.Dialog({title:"\u8bf7\u6388\u6743",width:400,height:200,mask:!0,buttons:[{text:"\u786e\u5b9a",elCls:"bui-button bui-button-primary",handler:function(){this.destroy()}}],bodyContent:'<div class="pop-accredit">\u4eb2\uff0c\u6388\u6743\u5df2\u8fc7\u671f\uff0c\u8bf7\u6388\u6743&nbsp;&nbsp;<a target="_blank" href="'+b+'">\u7acb\u5373\u6388\u6743</a></div>'})).show()},o="";(new H.widget.asyncRequest).setURI(isExpiredUrl).setMethod("GET").setHandle(m).setErrorHandle(n).setData(o).send()}else promotionControl.save()}}})},getPromoItemNum:function(a){var b=function(a){DOM.hide("#J_loadingDiscount"),DOM.show("#J_storeDiscount"),DOM.text("#J_storeDiscount",a.payload+" \u6298")},c=function(a){DOM.hide("#J_loadingDiscount"),DOM.show("#J_storeDiscount"),DOM.text("#J_storeDiscount","\u83b7\u53d6\u4e0d\u5230")};DOM.show("#J_loadingDiscount"),DOM.hide("#J_storeDiscount");var d=DOM.val("#J_isDiscount"),e="fg="+d;(new H.widget.asyncRequest).setURI(getLowestDisUrl).setMethod("GET").setHandle(b).setErrorHandle(c).setData(e).send()},onePriceWay:function(a){var b=DOM.attr(a,"pid");promotionControl.x.setRadioOn("#J_onePrice"+b)},renderJtj:function(){var a=promotionControl.jtjData,b=DOM.html(DOM.get("#J_Rule_jtj")),c={data:a},d=(new XTemplate(b)).render(c);DOM.html(DOM.get("#J_privilegeTier"),d);for(var e=0;e<a.length;e++)if(e>0){var f=H.util.stringToDate(S.one("#J_EndDateJtj"+(e-1)).val()),g=f.getTime()+864e5,h=g+864e5,i=(new Date(g)).format("yyyy-MM-dd hh:mm:ss"),j=(new Date(h)).format("yyyy-MM-dd hh:mm:ss");DOM.val("#J_StartDateJtj"+e,i),DOM.val("#J_EndDateJtj"+e,j)}},addJtj:function(){promotionControl.tempSaveJtj();var a={start_data:"",end_data:""};promotionControl.jtjData.push(a),promotionControl.renderJtj()},deleJtj:function(a){promotionControl.tempSaveJtj(),promotionControl.jtjData.splice(a,1),promotionControl.renderJtj()},tempSaveJtj:function(){promotionControl.jtjData=[];var a=DOM.children("#J_privilegeTier");KISSY.each(a,function(a,b){var c={};c.start_data=DOM.val(DOM.get(".J_StartDateJtj",a)),c.end_data=DOM.val(DOM.get(".J_EndDateJtj",a)),promotionControl.jtjData.push(c)})},renderMjspart:function(){var a=promotionControl.mjspartData;a.length<7?DOM.show("#J_addMjs"):DOM.hide("#J_addMjs");var b=DOM.html(DOM.get("#J_Rule_N")),c={data:a},d=(new XTemplate(b)).render(c);DOM.html(DOM.get("#J_privilegeTier"),d),a.length>0&&DOM.text("#J_maxPrivilege","\u7b2c "+(a.length+1)+" \u4ef6\u8d77\uff0c\u539f\u4ef7\u8d2d\u4e70 ");var e=DOM.val("#J_joinItemPrice"),f=0;for(i=0;i<a.length;i++){f+=Number(a[i].con_price);var g=e*(i+1);DOM.val("#J_decreaseMoney"+i,g-f),DOM.html("#J_privilegeData"+i,"\u62cd\u4e0b "+(i+1)+" \u4ef6\u65f6\uff0c\u8ba2\u5355\u603b\u4ef7 <b>"+g+"</b> \u5143\uff0c\u4f18\u60e0\u4e86<b> "+(g-f)+"</b> \u5143")}},addMjspart:function(){promotionControl.tempSaveMjspart();var a=promotionControl.mjspartData,b={con_price:"",decrease_money:"",con_value:""};promotionControl.mjspartData.push(b),promotionControl.renderMjspart()},deleMjspart:function(a){promotionControl.tempSaveMjspart(),promotionControl.mjspartData.splice(a,1),promotionControl.renderMjspart()},tempSaveMjspart:function(){promotionControl.mjspartData=[];var a=DOM.children("#J_privilegeTier");KISSY.each(a,function(a,b){var c={};c.con_price=DOM.val(DOM.get(".J_conPrice",a)),c.decrease_money=DOM.val(DOM.get(".J_decreaseMoney",a)),c.con_value=DOM.val(DOM.get(".J_con_value",a)),promotionControl.mjspartData.push(c)})},replaceTerm:function(){promotionControl.tempSaveMjs();var a=promotionControl.mjsData,b=DOM.html(DOM.get("#J_replace_Mjs")),c={data:a},d=(new XTemplate(b)).render(c);DOM.html(DOM.get("#J_termMjsList"),d);for(i=0;i<a.length;i++){var e=a[i].freeAreasName.split(",");e.length<=18&&e!=""?DOM.text("#J_mailRegionPop"+i,"\u5305\u90ae\uff1a\u4ec5"+a[i].freeAreasName):e.length>=19&&e.length<29?DOM.text("#J_mailRegionPop"+i,"\u5305\u90ae\uff1a\u4e0d\u5305\u62ec"+a[i].free_post_areasName):e.length>=29&&e.length<35?DOM.text("#J_mailRegionPop"+i,"\u5168\u56fd\u5305\u90ae\uff1a\u4e0d\u542b"+a[i].free_post_areasName):e.length==35&&DOM.text("#J_mailRegionPop"+i,"\u5168\u56fd\u5305\u90ae")}},renderMjs:function(){var a=promotionControl.mjsData,b=DOM.html(DOM.get("#J_Rule_Mjs")),c={data:a},d=(new XTemplate(b)).render(c);DOM.html(DOM.get("#J_privilegeTier"),d);var e=DOM.html(DOM.get("#J_Templet_desc")),f=(new XTemplate(e)).render(c);DOM.html(DOM.get("#J_promoShowList"),f);for(var g=0;g<a.length;g++){var h=a[g].freeAreasName.split(",");h.length<=18&&h!=""?(DOM.text("#J_mailRegion"+g,"\u5305\u90ae\uff1a\u4ec5"+a[g].freeAreasName),DOM.text("#J_freeMailList"+g,"\u4ec5"+a[g].freeAreasName)):h.length>=19&&h.length<29?(DOM.text("#J_mailRegion"+g,"\u5305\u90ae\uff1a\u4e0d\u5305\u62ec"+a[g].free_post_areasName),DOM.text("#J_freeMailList"+g,"\u4e0d\u5305\u62ec"+a[g].free_post_areasName)):h.length>=29&&h.length<35?(DOM.text("#J_mailRegion"+g,"\u5168\u56fd\u5305\u90ae\uff1a\u4e0d\u542b"+a[g].free_post_areasName),DOM.text("#J_freeMailList"+g,"\u4e0d\u542b"+a[g].free_post_areasName)):h.length==35&&(DOM.text("#J_mailRegion"+g,"\u5168\u56fd\u5305\u90ae"),DOM.text("#J_freeMailList"+g,"")),promotionControl.x.renderAllCheckbox("#J_tierItem"+g),parentType=="mjscp"&&promotionControl.x.renderAllRadio("#J_tierItem"+g),Event.on("#J_enableMultiple_"+g,"click",function(a){var b=DOM.attr(a.currentTarget,"data");a.currentTarget.checked==1?(DOM.val(a.currentTarget,1),DOM.show("#J_cappingNo"+b)):(DOM.val(a.currentTarget,0),DOM.hide("#J_cappingNo"+b))}),Event.on("#J_isDiscount"+g,"click",function(a){var b=DOM.attr(a.currentTarget,"data");a.currentTarget.checked==1?(DOM.val(a.currentTarget,1),DOM.show("#J_isShowDiscount"+b)):(DOM.val(a.currentTarget,0),DOM.hide("#J_isShowDiscount"+b))}),Event.on("#J_isDiscountMoney"+g,"click",function(a){var b=DOM.attr(a.currentTarget,"data");a.currentTarget.checked==1?(DOM.val(a.currentTarget,1),DOM.show("#J_isShowMoney"+b)):(DOM.val(a.currentTarget,0),DOM.hide("#J_isShowMoney"+b))}),Event.on("#J_isSendGift"+g,"click",function(a){var b=DOM.attr(a.currentTarget,"data");a.currentTarget.checked==1?(DOM.val(a.currentTarget,1),DOM.show("#J_giftEdit"+b),DOM.show("#J_isShowGift"+b)):(DOM.val(a.currentTarget,0),DOM.hide("#J_giftEdit"+b),DOM.hide("#J_isShowGift"+b))}),Event.on("#J_isSetArea"+g,"click",function(a){var b=DOM.attr(a.currentTarget,"data");a.currentTarget.checked==1?(DOM.val(a.currentTarget,1),DOM.show("#J_areaEdit"+b),DOM.show("#J_freeMailText"+b)):(DOM.val(a.currentTarget,0),DOM.hide("#J_areaEdit"+b),DOM.hide("#J_freeMailText"+b))}),Event.on("#J_isSendLottery"+g,"click",function(a){var b=DOM.attr(a.currentTarget,"data");promotionControl.checkCpAgreement(a.currentTarget),a.currentTarget.checked==1?(DOM.val(a.currentTarget,1),DOM.show("#J_lotteryEdit"+b)):(DOM.val(a.currentTarget,0),DOM.hide("#J_lotteryEdit"+b))}),Event.on("#J_ssq"+g,"click",function(a){var b=DOM.attr(a.currentTarget,"data");a.currentTarget.checked==1&&DOM.val("#J_lotteryTypeId"+b,1)}),Event.on("#J_3d"+g,"click",function(a){var b=DOM.attr(a.currentTarget,"data");a.currentTarget.checked==1&&DOM.val("#J_lotteryTypeId"+b,2)}),Event.on("#J_qlc"+g,"click",function(a){var b=DOM.attr(a.currentTarget,"data");a.currentTarget.checked==1&&DOM.val("#J_lotteryTypeId"+b,7)}),Event.on("#J_setRegion"+g,"click",function(a){var b=DOM.attr(a.currentTarget,"pid"),c='<div class="pop-area" id="J_areaList"><div class="fast-area"><a id="J_allArea">\u5168\u9009</a><a id="J_theArea">\u6e05\u7a7a</a><a id="J_hotArea">\u6c5f\u6d59\u6cf8</a></div><div class="pop-area-list"><ul><li id="J_hd"><span class="sort-area"><label class="beautify_check" for="J_sortHd"><input type="checkbox" value="Hd" id="J_sortHd" class="J_areaSort">\u534e\u4e1c</label></span><label class="beautify_check" for="J_310000"><input pid="310000" value="\u4e0a\u6d77" type="checkbox" id="J_310000" class="J_areaItem">\u4e0a\u6d77</label><label class="beautify_check" for="J_320000"><input pid="320000" value="\u6c5f\u82cf" type="checkbox" id="J_320000" class="J_areaItem">\u6c5f\u82cf</label><label class="beautify_check" for="J_330000"><input pid="330000" value="\u6d59\u6c5f" type="checkbox" id="J_330000" class="J_areaItem">\u6d59\u6c5f</label><label class="beautify_check" for="J_350000"><input pid="350000" value="\u798f\u5efa" type="checkbox" id="J_350000" class="J_areaItem">\u798f\u5efa</label><label class="beautify_check" for="J_340000"><input pid="340000" value="\u5b89\u5fbd" type="checkbox" id="J_340000" class="J_areaItem">\u5b89\u5fbd</label><label class="beautify_check" for="J_360000"><input pid="360000" value="\u6c5f\u897f" type="checkbox" id="J_360000" class="J_areaItem">\u6c5f\u897f</label></li><li id="J_hb"><span class="sort-area"><label class="beautify_check" for="J_sortHb"><input type="checkbox" value="Hb" id="J_sortHb" class="J_areaSort">\u534e\u5317</label></span><label class="beautify_check" for="J_110000"><input pid="110000" value="\u5317\u4eac" type="checkbox" id="J_110000" class="J_areaItem">\u5317\u4eac</label><label class="beautify_check" for="J_120000"><input pid="120000" value="\u5929\u6d25" type="checkbox" id="J_120000" class="J_areaItem">\u5929\u6d25</label><label class="beautify_check" for="J_130000"><input pid="130000" value="\u6cb3\u5317" type="checkbox" id="J_130000" class="J_areaItem">\u6cb3\u5317</label><label class="beautify_check" for="J_370000"><input pid="370000"  value="\u5c71\u4e1c"type="checkbox" id="J_370000" class="J_areaItem">\u5c71\u4e1c</label><label class="beautify_check" for="J_140000"><input pid="140000" value="\u5c71\u897f" type="checkbox" id="J_140000" class="J_areaItem">\u5c71\u897f</label><label class="beautify_check" for="J_150000"><input pid="150000" value="\u5185\u8499\u53e4" type="checkbox" id="J_150000" class="J_areaItem">\u5185\u8499\u53e4</label></li><li id="J_hn"><span class="sort-area"><label class="beautify_check" for="J_sortHn"><input type="checkbox" value="Hn" id="J_sortHn" class="J_areaSort">\u534e\u5357</label></span><label class="beautify_check" for="J_440000"><input pid="440000" value="\u5e7f\u4e1c" type="checkbox" id="J_440000" class="J_areaItem">\u5e7f\u4e1c</label><label class="beautify_check" for="J_450000"><input pid="450000" value="\u5e7f\u897f" type="checkbox" id="J_450000" class="J_areaItem">\u5e7f\u897f</label><label class="beautify_check" for="J_460000"><input pid="460000" value="\u6d77\u5357" type="checkbox" id="J_460000" class="J_areaItem">\u6d77\u5357</label></li><li id="J_hz"><span class="sort-area"><label class="beautify_check" for="J_sortHz"><input type="checkbox" value="Hz" id="J_sortHz" class="J_areaSort">\u534e\u4e2d</label></span><label class="beautify_check" for="J_410000"><input pid="410000" value="\u6cb3\u5357" type="checkbox" id="J_410000" class="J_areaItem">\u6cb3\u5357</label><label class="beautify_check" for="J_420000"><input pid="420000" value="\u6e56\u5317" type="checkbox" id="J_420000" class="J_areaItem">\u6e56\u5317</label><label class="beautify_check" for="J_430000"><input pid="430000" value="\u6e56\u5357" type="checkbox" id="J_430000" class="J_areaItem">\u6e56\u5357</label></li><li id="J_db"><span class="sort-area"><label class="beautify_check" for="J_sortDb"><input type="checkbox" value="Db" id="J_sortDb" class="J_areaSort">\u4e1c\u5317</label></span><label class="beautify_check" for="J_210000"><input pid="210000" value="\u8fbd\u5b81" type="checkbox" id="J_210000" class="J_areaItem">\u8fbd\u5b81</label><label class="beautify_check" for="J_220000"><input pid="220000" value="\u5409\u6797" type="checkbox" id="J_220000" class="J_areaItem">\u5409\u6797</label><label class="beautify_check" for="J_230000"><input pid="230000" value="\u9ed1\u9f99\u6c5f" type="checkbox" id="J_230000" class="J_areaItem">\u9ed1\u9f99\u6c5f</label></li><li id="J_xn"><span class="sort-area"><label class="beautify_check" for="J_sortXn"><input type="checkbox" value="Xn" id="J_sortXn" class="J_areaSort">\u897f\u5357</label></span><label class="beautify_check" for="J_500000"><input pid="500000" type="checkbox" value="\u91cd\u5e86" id="J_500000" class="J_areaItem">\u91cd\u5e86</label><label class="beautify_check" for="J_510000"><input pid="510000" type="checkbox" value="\u56db\u5ddd" id="J_510000" class="J_areaItem">\u56db\u5ddd</label><label class="beautify_check" for="J_520000"><input pid="520000" type="checkbox" value="\u8d35\u5dde" id="J_520000" class="J_areaItem">\u8d35\u5dde</label><label class="beautify_check" for="J_530000"><input pid="530000" type="checkbox" value="\u4e91\u5357" id="J_530000" class="J_areaItem">\u4e91\u5357</label></li><li id="J_xb"><span class="sort-area"><label class="beautify_check" for="J_sortXb"><input type="checkbox" value="Xb" id="J_sortXb" class="J_areaSort">\u897f\u5317</label></span><label class="beautify_check" for="J_610000"><input pid="610000" type="checkbox" value="\u9655\u897f" id="J_610000" class="J_areaItem">\u9655\u897f</label><label class="beautify_check" for="J_620000"><input pid="620000" type="checkbox" value="\u7518\u8083" id="J_620000" class="J_areaItem">\u7518\u8083</label><label class="beautify_check" for="J_630000"><input pid="630000" type="checkbox" value="\u9752\u6d77" id="J_630000" class="J_areaItem">\u9752\u6d77</label><label class="beautify_check" for="J_640000"><input pid="640000" type="checkbox" value="\u5b81\u590f" id="J_640000" class="J_areaItem">\u5b81\u590f</label></li></ul></div><div class="pop-area-other"><ul><li id="J_qt"><span class="sort-area"><label class="beautify_check" for="J_sortQt"><input type="checkbox" value="Qt" id="J_sortQt" class="J_areaSort">\u5176\u4ed6</label></span><label class="beautify_check" for="J_540000"><input type="checkbox" pid="540000" value="\u897f\u85cf" id="J_540000" class="J_areaItem">\u897f\u85cf</label><label class="beautify_check" for="J_650000"><input type="checkbox" pid="650000" value="\u65b0\u7586" id="J_650000" class="J_areaItem">\u65b0\u7586</label><label class="beautify_check" for="J_810000"><input type="checkbox" pid="810000" value="\u9999\u6e2f" id="J_810000" class="J_areaItem">\u9999\u6e2f</label><label class="beautify_check" for="J_820000"><input type="checkbox" pid="820000" value="\u6fb3\u95e8" id="J_820000" class="J_areaItem">\u6fb3\u95e8</label><label class="beautify_check" for="J_710000"><input type="checkbox" pid="710000" value="\u53f0\u6e7e" id="J_710000" class="J_areaItem">\u53f0\u6e7e</label><label class="beautify_check" for="J_990000"><input type="checkbox" pid="990000" value="\u6d77\u5916" id="J_990000" class="J_areaItem">\u6d77\u5916</label></li></ul></div></div>';(new Overlay.Dialog({title:"\u8bbe\u7f6e\u514d\u90ae\u5730\u533a",width:480,height:470,mask:!0,buttons:[{text:"\u786e\u5b9a",elCls:"bui-button bui-button-primary",handler:function(){promotionControl.isChange=!0;var a=DOM.query("#J_areaList .J_areaItem"),c=[],d=[],e=[],f=[];for(var g=0;g<a.length;g++)a[g].checked==1?(c.push(a[g].value),d.push(DOM.attr(a[g],"pid"))):(e.push(a[g].value),f.push(DOM.attr(a[g],"pid")));DOM.val("#J_free_post_areasName"+b,e.join(",")),DOM.val("#J_free_post_areasId"+b,f.join(",")),DOM.val("#J_freeAreasName"+b,c.join(",")),DOM.val("#J_freeAreasId"+b,d.join(",")),promotionControl.tempSaveMjs(),promotionControl.renderMjs(),this.destroy()}},{text:"\u53d6\u6d88",elCls:"bui-button J_buttonCancel",handler:function(){this.destroy()}}],bodyContent:c})).show(),promotionControl.x.renderAllCheckbox("#J_areaList");var d=DOM.val("#J_freeAreasId"+b);promotionControl.renderArea(d)}),parentType=="mjs"&&promotionControl.tooltip.set("title",'<div class="ui-tip-text">\u5f53\u8ba2\u5355\u6761\u4ef6\u8fbe\u52302\u500d\u4ee5\u4e0a\u65f6<br/><span class="color-red">\u51cf\u94b1\u91d1\u989d</span>\u548c<span class="color-red">\u793c\u7269\u4ef6\u6570</span>\u4e5f\u7b49\u500d<br/>\u63d0\u4f9b \uff08\u9001\u5f69\u7968\u65e0\u6548\uff09</div>'),parentType=="mjscp"&&promotionControl.tooltip.set("title",'<div class="ui-tip-text">\u4e70\u5bb6\u7684 \u201c\u6211\u7684\u5f69\u7968  - \u5f69\u7968\u8be6\u60c5\u201c \u4e2d\u663e\u793a</div>'),g>0&&promotionControl.miniMjs(g-1)}},renderArea:function(a){Event.on("#J_allArea","click",function(){var a=DOM.query("#J_areaList input");for(var b=0;b<a.length;b++)promotionControl.x.setCheckboxOn(a[b])}),Event.on("#J_theArea","click",function(){var a=DOM.query("#J_areaList input");for(var b=0;b<a.length;b++)promotionControl.x.setCheckboxOff(a[b])}),Event.on("#J_hotArea","click",function(){var a=DOM.query("#J_areaList input");for(var b=0;b<a.length;b++)promotionControl.x.setCheckboxOff(a[b]);promotionControl.x.setCheckboxOn("#J_310000"),promotionControl.x.setCheckboxOn("#J_320000"),promotionControl.x.setCheckboxOn("#J_330000")}),Event.on("#J_sortHd","click",function(a){promotionControl.checkAll("#J_hd","#J_sortHd")}),Event.on(DOM.query("#J_hd .J_areaItem"),"click",function(a){if(this.checked){var b=DOM.query("#J_hd .J_areaItem"),c=b.length,d=!0;for(s=0;s<c;s++){if(b[s].disabled)continue;if(!b[s].checked){d=!1;break}}d&&promotionControl.x.setCheckboxOn(DOM.get("#J_sortHd"))}else promotionControl.x.setCheckboxOff(DOM.get("#J_sortHd"))}),Event.on("#J_sortHb","click",function(a){promotionControl.checkAll("#J_hb","#J_sortHb")}),Event.on(DOM.query("#J_hb .J_areaItem"),"click",function(a){if(this.checked){var b=DOM.query("#J_hb .J_areaItem"),c=b.length,d=!0;for(s=0;s<c;s++){if(b[s].disabled)continue;if(!b[s].checked){d=!1;break}}d&&promotionControl.x.setCheckboxOn(DOM.get("#J_sortHb"))}else promotionControl.x.setCheckboxOff(DOM.get("#J_sortHb"))}),Event.on("#J_sortHn","click",function(a){promotionControl.checkAll("#J_hn","#J_sortHn")}),Event.on(DOM.query("#J_hn .J_areaItem"),"click",function(a){if(this.checked){var b=DOM.query("#J_hn .J_areaItem"),c=b.length,d=!0;for(s=0;s<c;s++){if(b[s].disabled)continue;if(!b[s].checked){d=!1;break}}d&&promotionControl.x.setCheckboxOn(DOM.get("#J_sortHn"))}else promotionControl.x.setCheckboxOff(DOM.get("#J_sortHn"))}),Event.on("#J_sortHz","click",function(a){promotionControl.checkAll("#J_hz","#J_sortHz")}),Event.on(DOM.query("#J_hz .J_areaItem"),"click",function(a){if(this.checked){var b=DOM.query("#J_hz .J_areaItem"),c=b.length,d=!0;for(s=0;s<c;s++){if(b[s].disabled)continue;if(!b[s].checked){d=!1;break}}d&&promotionControl.x.setCheckboxOn(DOM.get("#J_sortHz"))}else promotionControl.x.setCheckboxOff(DOM.get("#J_sortHz"))}),Event.on("#J_sortDb","click",function(a){promotionControl.checkAll("#J_db","#J_sortDb")}),Event.on(DOM.query("#J_db .J_areaItem"),"click",function(a){if(this.checked){var b=DOM.query("#J_db .J_areaItem"),c=b.length,d=!0;for(s=0;s<c;s++){if(b[s].disabled)continue;if(!b[s].checked){d=!1;break}}d&&promotionControl.x.setCheckboxOn(DOM.get("#J_sortDb"))}else promotionControl.x.setCheckboxOff(DOM.get("#J_sortDb"))}),Event.on("#J_sortXn","click",function(a){promotionControl.checkAll("#J_xn","#J_sortXn")}),Event.on(DOM.query("#J_xn .J_areaItem"),"click",function(a){if(this.checked){var b=DOM.query("#J_xn .J_areaItem"),c=b.length,d=!0;for(s=0;s<c;s++){if(b[s].disabled)continue;if(!b[s].checked){d=!1;break}}d&&promotionControl.x.setCheckboxOn(DOM.get("#J_sortXn"))}else promotionControl.x.setCheckboxOff(DOM.get("#J_sortXn"))}),Event.on("#J_sortXb","click",function(a){promotionControl.checkAll("#J_xb","#J_sortXb")}),Event.on(DOM.query("#J_xb .J_areaItem"),"click",function(a){if(this.checked){var b=DOM.query("#J_xb .J_areaItem"),c=b.length,d=!0;for(s=0;s<c;s++){if(b[s].disabled)continue;if(!b[s].checked){d=!1;break}}d&&promotionControl.x.setCheckboxOn(DOM.get("#J_sortXb"))}else promotionControl.x.setCheckboxOff(DOM.get("#J_sortXb"))}),Event.on("#J_sortQt","click",function(a){promotionControl.checkAll("#J_qt","#J_sortQt")}),Event.on(DOM.query("#J_qt .J_areaItem"),"click",function(a){if(this.checked){var b=DOM.query("#J_qt .J_areaItem"),c=b.length,d=!0;for(s=0;s<c;s++){if(b[s].disabled)continue;if(!b[s].checked){d=!1;break}}d&&promotionControl.x.setCheckboxOn(DOM.get("#J_sortQt"))}else promotionControl.x.setCheckboxOff(DOM.get("#J_sortQt"))});var b=a.split(","),c=["310000","320000","330000","350000","340000","360000"],d=["110000","120000","130000","370000","140000","150000"],e=["440000","450000","460000"],f=["410000","420000","430000"],g=["210000","220000","230000"],h=["500000","510000","520000","530000"],i=["610000","620000","630000","640000"],j=["540000","650000","810000","820000","710000","990000"],k=[],l=[],m=[],n=[],o=[],p=[],q=[],r=[];for(var s=0;s<b.length;s++){b!=""&&promotionControl.x.setCheckboxOn("#J_"+b[s]);for(var t=0;t<c.length;t++)c[t]==b[s]&&k.push(c[t]);for(var t=0;t<d.length;t++)d[t]==b[s]&&l.push(d[t]);for(var t=0;t<e.length;t++)e[t]==b[s]&&m.push(e[t]);for(var t=0;t<f.length;t++)f[t]==b[s]&&n.push(f[t]);for(var t=0;t<g.length;t++)g[t]==b[s]&&o.push(g[t]);for(var t=0;t<h.length;t++)h[t]==b[s]&&p.push(h[t]);for(var t=0;t<i.length;t++)i[t]==b[s]&&q.push(i[t]);for(var t=0;t<j.length;t++)j[t]==b[s]&&r.push(j[t])}k.length==c.length&&promotionControl.x.setCheckboxOn("#J_sortHd"),l.length==d.length&&promotionControl.x.setCheckboxOn("#J_sortHb"),m.length==e.length&&promotionControl.x.setCheckboxOn("#J_sortHn"),n.length==f.length&&promotionControl.x.setCheckboxOn("#J_sortHz"),o.length==g.length&&promotionControl.x.setCheckboxOn("#J_sortDb"),p.length==h.length&&promotionControl.x.setCheckboxOn("#J_sortXn"),q.length==i.length&&promotionControl.x.setCheckboxOn("#J_sortXb"),r.length==j.length&&promotionControl.x.setCheckboxOn("#J_sortQt")},checkAll:function(a,b){var c=DOM.query(".J_areaItem",a),d=c.length;for(i=0;i<d;i++){var e=c[i].value;if(c[i].disabled)continue;DOM.get(b).checked==1?promotionControl.x.setCheckboxOn(c[i]):promotionControl.x.setCheckboxOff(c[i])}},addMjs:function(){promotionControl.isChange=!0,promotionControl.tempSaveMjs();var a=promotionControl.mjsData;if(a.length>6){new H.widget.msgBox({title:"\u6e29\u99a8\u63d0\u793a",content:"\u6ee1\u5c31\u9001\u6700\u591a\u652f\u63017\u4e2a\u5c42\u7ea7",type:"error",autoClose:!0,timeOut:3e3});return}promotionControl.msg=null;for(i=0;i<a.length;i++){var b=promotionControl.checkRule(i,i);if(b==1)return}if(DOM.get("#J_mjsYuan").checked==1)var c={con_value:"",type:"1",discount_rate:"",discount_money:"",gift_name:"",gift_url:"",enable_multiple:"",send_gift:"0",discount:"1",decrease:"0",free_postage:"0",is_sendLottery:"0",stake_count:"1",lottery_type_id:"1",sweety_words:"\u5c0f\u5e97\u9001\u60a8\u5f69\u7968\u5566\uff0c\u795d\u4eb2\u4e2d\u5956\uff01",free_post_areasName:"\u897f\u85cf,\u65b0\u7586,\u9999\u6e2f,\u6fb3\u95e8,\u53f0\u6e7e,\u6d77\u5916",free_post_areasId:"540000,650000,810000,820000,710000,990000",freeAreasName:"\u4e0a\u6d77,\u6c5f\u82cf,\u6d59\u6c5f,\u798f\u5efa,\u5b89\u5fbd,\u6c5f\u897f,\u5317\u4eac,\u5929\u6d25,\u6cb3\u5317,\u5c71\u4e1c,\u5c71\u897f,\u5185\u8499\u53e4,\u5e7f\u4e1c,\u5e7f\u897f,\u6d77\u5357,\u6cb3\u5357,\u6e56\u5317,\u6e56\u5357,\u5409\u6797,\u5409\u6797,\u9ed1\u9f99\u6c5f,\u91cd\u5e86,\u56db\u5ddd,\u8d35\u5dde,\u4e91\u5357,\u9655\u897f,\u7518\u8083,\u9752\u6d77,\u5b81\u590f",freeAreasId:"310000,320000,330000,350000,340000,360000,110000,120000,130000,370000,140000,150000,440000,450000,460000,410000,420000,430000,210000,220000,230000,500000,510000,520000,530000,610000,620000,630000,640000"};else var c={con_value:"",type:"0",discount_rate:"",discount_money:"",gift_name:"",gift_url:"",enable_multiple:"",send_gift:"0",discount:"1",decrease:"0",free_postage:"0",is_sendLottery:"0",stake_count:"1",lottery_type_id:"1",sweety_words:"\u5c0f\u5e97\u9001\u60a8\u5f69\u7968\u5566\uff0c\u795d\u4eb2\u4e2d\u5956\uff01",free_post_areasName:"\u897f\u85cf,\u65b0\u7586,\u9999\u6e2f,\u6fb3\u95e8,\u53f0\u6e7e,\u6d77\u5916",free_post_areasId:"540000,650000,810000,820000,710000,990000",freeAreasName:"\u4e0a\u6d77,\u6c5f\u82cf,\u6d59\u6c5f,\u798f\u5efa,\u5b89\u5fbd,\u6c5f\u897f,\u5317\u4eac,\u5929\u6d25,\u6cb3\u5317,\u5c71\u4e1c,\u5c71\u897f,\u5185\u8499\u53e4,\u5e7f\u4e1c,\u5e7f\u897f,\u6d77\u5357,\u6cb3\u5357,\u6e56\u5317,\u6e56\u5357,\u5409\u6797,\u5409\u6797,\u9ed1\u9f99\u6c5f,\u91cd\u5e86,\u56db\u5ddd,\u8d35\u5dde,\u4e91\u5357,\u9655\u897f,\u7518\u8083,\u9752\u6d77,\u5b81\u590f",freeAreasId:"310000,320000,330000,350000,340000,360000,110000,120000,130000,370000,140000,150000,440000,450000,460000,410000,420000,430000,210000,220000,230000,500000,510000,520000,530000,610000,620000,630000,640000"};promotionControl.mjsData.push(c),promotionControl.renderMjs()},deleMjs:function(a){promotionControl.isChange=!0,promotionControl.tempSaveMjs(),promotionControl.mjsData.splice(a,1),promotionControl.renderMjs()},maxiMjs:function(a){var b=KISSY.one("#J_Content_Detail_"+a),c=KISSY.one("#J_Mini_Detail_"+a);DOM.show(DOM.get(".tier-stop","#J_tierItem"+a)),DOM.hide(DOM.get(".tier-an","#J_tierItem"+a)),b.css("display")==="none"&&(c.slideUp(.1),b.slideDown(.7))},miniMjs:function(a){var b=KISSY.one("#J_Content_Detail_"+a),c=KISSY.one("#J_Mini_Detail_"+a);DOM.hide(DOM.get(".tier-stop","#J_tierItem"+a)),DOM.show(DOM.get(".tier-an","#J_tierItem"+a));if(DOM.get("#J_mjsYuan").checked==1)var d="\u5143";else var d="\u4ef6";var a=a,e=DOM.val("#J_conValue"+a)||0,f=DOM.text("#J_mailRegion"+a),g=DOM.get("#J_isSetArea"+a).checked;if(parentType=="mjs")var h=DOM.val("#J_decreaseMoney"+a)||0,i=DOM.val("#J_discountRate"+a)||0,j=DOM.val("#J_giftName"+a),k=DOM.val("#J_giftUrl"+a),l=DOM.get("#J_enableMultiple_"+a).checked,m=DOM.get("#J_isDiscount"+a).checked,n=DOM.get("#J_isDiscountMoney"+a).checked,o=DOM.get("#J_isSendGift"+a).checked,p=!1,q=0,r=0,s="";else if(parentType=="mjscp")var h=DOM.val("#J_decreaseMoney"+a)||0,n=DOM.get("#J_isDiscountMoney"+a).checked,p=DOM.get("#J_isSendLottery"+a).checked,r=DOM.val("#J_stakeCount"+a)||1,s=DOM.val("#J_Content"+a)||"\u5c0f\u5e97\u9001\u60a8\u5f69\u7968\u5566\uff0c\u795d\u4eb2\u4e2d\u5956\uff01",q=Number(DOM.val("#J_lotteryTypeId"+a))||Number(1),i=0,m=!1,j="",k="",l=!1,o=!1;else var h="",i="",j="",k="",l=!1,m=!1,n=!1,o=!1,p=!1,q=0,r=0,s="";var t={num:a,type:d,con_value:e,decrease_money:h,discount_rate:i,gift_name:j,gift_url:k,enable_multiple:l,enable_multiple:l,discount:m,IsDecrease:n,IsFreePost:g,IsSend_gift:o,is_sendLottery:p,lottery_type_id:q,stake_count:r,sweety_words:s,freeAreasName:f};if(e==0&&m==0&&n==0&&g==0&&o==0&&p==0||m==0&&n==0&&g==0&&o==0&&p==0)var u='<span style="color:#F00">\u672a\u8bbe\u7f6e\u4f18\u60e0\u5185\u5bb9&nbsp;&nbsp;&nbsp;<a onclick="promotionControl.maxiMjs('+a+');" >[\u91cd\u65b0\u7f16\u8f91]</a></span>';else var v=DOM.html(DOM.get("#J_Templet_Mjs")),w={data:t},u=(new XTemplate(v)).render(t);c.html(u),b.css("display")!="none"&&(c.slideDown(.7),b.slideUp(.3))},tempSaveMjs:function(){promotionControl.mjsData=[];var a=DOM.children("#J_privilegeTier"),b=0;DOM.get("#J_mjsYuan").checked==1&&(b=1),KISSY.each(a,function(a,c){var d={};d.type=b,d.con_value=DOM.val(DOM.get(".J_conValue",a)),d.free_post_areasName=DOM.val(DOM.get(".J_free_post_areasName",a)),d.free_post_areasId=DOM.val(DOM.get(".J_free_post_areasId",a)),d.freeAreasName=DOM.val(DOM.get(".J_freeAreasName",a)),d.freeAreasId=DOM.val(DOM.get(".J_freeAreasId",a)),DOM.get("#J_isSetArea"+c).checked==1?d.free_postage=1:d.free_postage=0,parentType=="mjs"?(d.discount_rate=DOM.val(DOM.get(".J_discountRate",a)),d.discount_money=DOM.val(DOM.get(".J_decreaseMoney",a)),d.gift_name=DOM.val(DOM.get(".J_giftName",a)),d.gift_url=DOM.val(DOM.get(".J_giftUrl",a)),DOM.get("#J_enableMultiple_"+c).checked==1?d.enable_multiple=1:d.enable_multiple=0,DOM.get("#J_isSendGift"+c).checked==1?d.send_gift=1:d.send_gift=0,DOM.get("#J_isDiscount"+c).checked==1?d.discount=1:d.discount=0,DOM.get("#J_isDiscountMoney"+c).checked==1?d.decrease=1:d.decrease=0,d.is_sendLottery=0):parentType=="mjscp"?(d.discount_money=DOM.val(DOM.get(".J_decreaseMoney",a)),DOM.get("#J_isDiscountMoney"+c).checked==1?d.decrease=1:d.decrease=0,DOM.get("#J_isSendLottery"+c).checked==1?d.is_sendLottery=1:d.is_sendLottery=0,d.stake_count=DOM.val(DOM.get(".J_stakeCount",a)),d.sweety_words=DOM.val(DOM.get(".J_Content",a)),d.lottery_type_id=Number(DOM.val(DOM.get(".J_lotteryTypeId",a))),d.discount=0,d.discount_rate=0,d.gift_name="",d.gift_url="",d.enable_multiple=0,d.send_gift=0):(d.discount_rate=0,d.discount_money=0,d.gift_name="",d.gift_url="",d.enable_multiple=0,d.send_gift=0,d.discount=0,d.decrease=0,d.is_sendLottery=0),promotionControl.mjsData.push(d)})},clearNoNum:function(a){a.value=a.value.replace(/[^\d.]/g,""),a.value=a.value.replace(/^\./g,""),a.value=a.value.replace(/\.{2,}/g,"."),a.value=a.value.replace(".","$#$").replace(/\./g,"").replace("$#$",".")},setPreviewDesc:function(a,b,c){DOM.text(a,b),c&&(b!=""?DOM.show(c):DOM.hide(c))},autoCheck:function(a,b){a!=""?promotionControl.x.setCheckboxOn("#"+b):promotionControl.x.setCheckboxOff("#"+b)},searchPromoItems:function(){var a=function(a){DOM.hide("#J_LeftLoading"),DOM.show("#J_MainLeftContent"),totalRecords=a.payload.totalRecords,totalRecords>0?DOM.get("#J_LEmpty").style.display="none":DOM.get("#J_LEmpty").style.display="",DOM.html("#J_PromoItems",a.payload.body),pageCount=Math.ceil(totalRecords/a.payload.pageNum),promotionControl.paginator=(new showPages("promotionControl.paginator")).setRender(promotionControl.handlePagination).setPageCount(pageCount).printHtml("#J_PromotionItemPaging",2);var b=promotionControl.mjsRemove;for(i=0;i<b.length;i++)DOM.show("#J_cancelBtn"+b[i].id),DOM.hide("#J_removeBtn"+b[i].id),DOM.addClass("#J_listItem"+b[i].id,"choose");if(parentType=="mjspartjtj"){var c=DOM.val("#J_joinItemType");if(c=="join")var b=promotionControl.mjspartAttend;else var b=promotionControl.mjspartNothing;DOM.text(".J_removeBtn","\u6dfb\u52a0\u8be5\u5b9d\u8d1d"),DOM.text(".J_cancelBtn","\u53d6\u6d88\u6dfb\u52a0");for(i=0;i<b.length;i++)DOM.show("#J_cancelBtn"+b[i].id),DOM.hide("#J_removeBtn"+b[i].id),DOM.addClass("#J_listItem"+b[i].id,"choose")}},b=function(a){DOM.hide("#J_LeftLoading"),DOM.show("#J_MainLeftContent"),new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})},c=DOM.val("#J_startPrice"),d=DOM.val("#J_endPrice"),e=DOM.val("#J_SelectItemCid");if(DOM.val(DOM.get("#J_SearchTitle"))!="\u5173\u952e\u5b57\u3001\u94fe\u63a5\u3001\u5546\u54c1\u7f16\u7801")var f=encodeURIComponent(DOM.val(DOM.get("#J_SearchTitle")));else var f="";var g="&start_price="+c+"&end_price="+d+"&cid="+e+"&q="+f+"&pageSize="+5;DOM.show("#J_LeftLoading"),DOM.hide("#J_MainLeftContent"),(new H.widget.asyncRequest).setURI(loadItemFromTbUrl).setMethod("GET").setHandle(a).setErrorHandle(b).setData(g).setDataType("json").send()},handlePagination:function(a){pageId=a;var b=function(a){totalRecords=a.payload.totalRecords,totalRecords>0?DOM.get("#J_LEmpty").style.display="none":DOM.get("#J_LEmpty").style.display="",pageCount=Math.ceil(totalRecords/a.payload.pageNum),DOM.html("#J_PromoItems",a.payload.body),promotionControl.paginator.setPage(pageId).setPageCount(pageCount).printHtml("#J_PromotionItemPaging",2),DOM.hide("#J_LeftLoading"),DOM.show("#J_MainLeftContent");var b=promotionControl.mjsRemove;for(i=0;i<b.length;i++)DOM.show("#J_cancelBtn"+b[i].id),DOM.hide("#J_removeBtn"+b[i].id),DOM.addClass("#J_listItem"+b[i].id,"choose");if(parentType=="mjspartjtj"){var c=DOM.val("#J_joinItemType");if(c=="join")var b=promotionControl.mjspartAttend;else var b=promotionControl.mjspartNothing;DOM.text(".J_removeBtn","\u6dfb\u52a0\u8be5\u5b9d\u8d1d"),DOM.text(".J_cancelBtn","\u53d6\u6d88\u6dfb\u52a0");for(i=0;i<b.length;i++)DOM.show("#J_cancelBtn"+b[i].id),DOM.hide("#J_removeBtn"+b[i].id),DOM.addClass("#J_listItem"+b[i].id,"choose")}},c=DOM.val("#J_startPrice"),d=DOM.val("#J_endPrice"),e=DOM.val("#J_SelectItemCid");if(DOM.val(DOM.get("#J_SearchTitle"))!="\u5173\u952e\u5b57\u3001\u94fe\u63a5\u3001\u5546\u54c1\u7f16\u7801")var f=encodeURIComponent(DOM.val(DOM.get("#J_SearchTitle")));else var f="";var g="&start_price="+c+"&end_price="+d+"&cid="+e+"&q="+f+"&page_id="+pageId+"&pageSize="+5;DOM.show("#J_LeftLoading"),DOM.hide("#J_MainLeftContent"),(new H.widget.asyncRequest).setURI(loadItemFromTbUrl).setMethod("GET").setHandle(b).setData(g).send()},addRemoveItem:function(pid){promotionControl.isChange=!0;var items=promotionControl.mjsRemove,id=pid,title=H.util.strProcess(DOM.val(DOM.get("#J_ItemTitle_"+pid))),price=DOM.val(DOM.get("#J_ItemPrice_"+pid)),picUrl=DOM.val(DOM.get("#J_ItemPic_"+pid)),outId=H.util.strProcess(DOM.val(DOM.get("#J_ItemOuterId_"+pid)));o='{"id":"'+id+'", "outer_id":"'+outId+'", "title":"'+title+'", "price":"'+price+'", "pic_url":"'+picUrl+'"}',o=eval("("+o+")"),promotionControl.mjsRemove.push(o),DOM.hide("#J_removeBtn"+pid),DOM.show("#J_cancelBtn"+pid),items.length>0&&(parentType=="mjs"?DOM.val("#J_TypeId",117):parentType=="freepost"?DOM.val("#J_TypeId",115):parentType=="mjscp"&&DOM.val("#J_TypeId",217),DOM.hide("#J_PromoDescTempletBox"),DOM.val("#J_RangeTypeValue","PART_NOT"))},cancelRemoveItem:function(a){promotionControl.isChange=!0;var b=promotionControl.mjsRemove;for(var c=0,d=b.length;c<d;c++)if(b[c].id==a){promotionControl.mjsRemove.splice(c,1);break}promotionControl.renderRemoveItem(),DOM.show("#J_removeBtn"+a),DOM.hide("#J_cancelBtn"+a),b.length==0&&(parentType=="mjs"?DOM.val("#J_TypeId",107):parentType=="freepost"?DOM.val("#J_TypeId",105):parentType=="mjscp"&&DOM.val("#J_TypeId",207),DOM.show("#J_PromoDescTempletBox"),DOM.val("#J_RangeTypeValue","ALL"))},renderRemoveItem:function(){var a=promotionControl.mjsRemove,b=DOM.html(DOM.get("#J_remove_Mjs")),c={data:a},d=(new XTemplate(b)).render(c);DOM.html(DOM.get("#J_itemListUl"),d),Event.on(DOM.children("#J_itemListUl"),"mouseenter mouseleave",function(a){a.type=="mouseenter"?DOM.addClass(a.currentTarget,"current"):DOM.removeClass(a.currentTarget,"current")}),a.length>4?(DOM.text("#J_MoreNum",a.length),DOM.show("#J_hasMore")):DOM.hide("#J_hasMore"),a.length>0?DOM.show("#J_removeItemList"):DOM.hide("#J_removeItemList"),a.length==0&&(parentType=="mjs"?DOM.val("#J_TypeId",107):parentType=="freepost"?DOM.val("#J_TypeId",105):parentType=="mjscp"&&DOM.val("#J_TypeId",207),DOM.show("#J_PromoDescTempletBox"),DOM.val("#J_RangeTypeValue","ALL"))},renderMoreItem:function(){var a=promotionControl.mjsRemove,b=DOM.html(DOM.get("#J_removeMore_Mjs")),c={data:a},d=(new XTemplate(b)).render(c);DOM.html(DOM.get("#J_moreItemListUl"),d)},editRemoveItem:function(pid){promotionControl.isChange=!0;var items=promotionControl.editMjsRemove,id=pid,title=H.util.strProcess(DOM.val(DOM.get("#J_ItemTitle_"+pid))),price=DOM.val(DOM.get("#J_ItemPrice_"+pid)),picUrl=DOM.val(DOM.get("#J_ItemPic_"+pid)),outId=H.util.strProcess(DOM.val(DOM.get("#J_ItemOuterId_"+pid)));o='{"id":"'+id+'", "outer_id":"'+outId+'", "title":"'+title+'", "price":"'+price+'", "pic_url":"'+picUrl+'"}',o=eval("("+o+")"),promotionControl.editMjsRemove.push(o),DOM.hide("#J_editCancelBtn"+pid),DOM.show("#J_editUndoBtn"+pid)},editCancelItem:function(a){var b=promotionControl.editMjsRemove;for(var c=0,d=b.length;c<d;c++)if(b[c].id==a){promotionControl.editMjsRemove.splice(c,1);break}DOM.show("#J_editCancelBtn"+a),DOM.hide("#J_editUndoBtn"+a)},addMjspartAttend:function(pid){promotionControl.isChange=!0;var items=promotionControl.mjspartAttend;for(var i=0,len=items.length;i<len;i++)promotionControl.mjspartAttend.splice(i,1);var itemType=DOM.val("#J_joinItemType"),id=pid,title=H.util.strProcess(DOM.val(DOM.get("#J_ItemTitle_"+pid))),price=DOM.val(DOM.get("#J_ItemPrice_"+pid)),picUrl=DOM.val(DOM.get("#J_ItemPic_"+pid)),outId=H.util.strProcess(DOM.val(DOM.get("#J_ItemOuterId_"+pid)));o='{"id":"'+id+'", "outer_id":"'+outId+'", "title":"'+title+'", "price":"'+price+'", "pic_url":"'+picUrl+'"}',o=eval("("+o+")"),itemType=="join"&&(DOM.val("#J_joinItemPrice",o.price),DOM.val(".J_conPrice",o.price),promotionControl.mjspartAttend.push(o)),DOM.show(".J_removeBtn"),DOM.hide(".J_cancelBtn"),DOM.hide("#J_removeBtn"+pid),DOM.show("#J_cancelBtn"+pid)},cancelMjspartAttend:function(a){promotionControl.isChange=!0;var b=DOM.val("#J_joinItemType"),c=promotionControl.mjspartAttend;for(var d=0,e=c.length;d<e;d++)if(c[d].id==a){promotionControl.mjspartAttend.splice(d,1);break}promotionControl.renderMjspartAttend(),DOM.show("#J_removeBtn"+a),DOM.hide("#J_cancelBtn"+a),b=="join"&&DOM.val("#J_joinItemPrice",0)},renderMjspartAttend:function(){var a=promotionControl.mjspartAttend,b=DOM.html(DOM.get("#J_attendItem")),c={data:a},d=(new XTemplate(b)).render(c);DOM.html(DOM.get("#J_joinitemList"),d),a.length>0?(DOM.hide("#J_chooseJoinItem"),DOM.show("#J_againJoinItem"),Event.fire(".bui-ext-close","click")):(DOM.show("#J_chooseJoinItem"),DOM.hide("#J_againJoinItem"))},addMjspartNothing:function(pid){promotionControl.isChange=!0;var items=promotionControl.mjspartNothing;for(var i=0,len=items.length;i<len;i++)promotionControl.mjspartNothing.splice(i,1);var id=pid,title=H.util.strProcess(DOM.val(DOM.get("#J_ItemTitle_"+pid))),price=DOM.val(DOM.get("#J_ItemPrice_"+pid)),picUrl=DOM.val(DOM.get("#J_ItemPic_"+pid)),outId=H.util.strProcess(DOM.val(DOM.get("#J_ItemOuterId_"+pid)));o='{"id":"'+id+'", "outer_id":"'+outId+'", "title":"'+title+'", "price":"'+price+'", "pic_url":"'+picUrl+'"}',o=eval("("+o+")"),promotionControl.mjspartNothing.push(o),DOM.show(".J_removeBtn"),DOM.hide(".J_cancelBtn"),DOM.hide("#J_removeBtn"+pid),DOM.show("#J_cancelBtn"+pid)},cancelMjspartNothing:function(a){promotionControl.isChange=!0;var b=promotionControl.mjspartNothing;for(var c=0,d=b.length;c<d;c++)if(b[c].id==a){promotionControl.mjspartNothing.splice(c,1);break}promotionControl.renderMjspartAttend(),DOM.show("#J_removeBtn"+a),DOM.hide("#J_cancelBtn"+a)},renderMjspartNothing:function(){var a=promotionControl.mjspartNothing,b=DOM.html(DOM.get("#J_attendItem")),c={data:a},d=(new XTemplate(b)).render(c);DOM.html(DOM.get("#J_irrelevanItemList"),d),a.length>0?(DOM.hide("#J_chooseNothingItem"),DOM.hide("#J_promoTipN"),DOM.show("#J_promoRemind"),DOM.show("#J_againNothingItem"),Event.fire(".bui-ext-close","click")):(DOM.show("#J_chooseNothingItem"),DOM.show("#J_promoTipN"),DOM.hide("#J_promoRemind"),DOM.hide("#J_againNothingItem"))},checkAction:function(a){for(var b=0;b<promotionControl.mjsData.length;b++)a==b?promotionControl.maxiMjs(a):promotionControl.miniMjs(b);var c=KISSY.Node.all;if(KISSY.one("#J_tierItem"+a)){var d=KISSY.one("#J_tierItem"+a).offset();c(window).stop(),c(window).animate({scrollTop:d.top},1,"easeOut")}},checkRule:function(a,b){var c=KISSY.one("#J_ParamsErrorBox1"),d=!1,e=DOM.val("#J_conValue"+a),f=checkUtil.isNull(e),d=f[0];if(d)return promotionControl.msg&&promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1",f[1]+'<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),DOM.val("#J_conValue"+a,""),DOM.addClass(DOM.get("#J_conValue"+a),"text-error"),d=!0;DOM.hide(c),DOM.removeClass(DOM.get("#J_conValue"+a),"text-error"),f=itemHandle.checkPrice(e),d=f[0],msg=f[1];if(d)return promotionControl.msg&&promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1",f[1]+'<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),DOM.val("#J_conValue"+a,""),DOM.addClass(DOM.get("#J_conValue"+a),"text-error"),d=!0;DOM.hide(c),DOM.removeClass(DOM.get("#J_conValue"+a),"text-error");if(DOM.get("#J_mjsYuan").checked==1)var g=1;else var g=0;if(parentType=="mjscp"){if(DOM.get("#J_isSendLottery"+a).checked===!1)return promotionControl.msg&&promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1","\u5c42\u7ea7"+(b+1)+"\u5fc5\u987b\u9009\u4e2d\u5f69\u7968\uff01"+'<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),d=!0;DOM.hide(c);if(DOM.get("#J_isDiscountMoney"+a).checked===!1&&DOM.get("#J_isSetArea"+a).checked===!1)return promotionControl.msg&&promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1","\u5c42\u7ea7"+(b+1)+"\u7684\u4f18\u60e0\u5185\u5bb9\u5fc5\u987b\u9009\u4e2d\u5f69\u7968+\u81f3\u5c11\u5176\u4ed6\u4e00\u9879\uff01"+'<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),d=!0;DOM.hide(c);if(DOM.get("#J_isSendLottery"+a).checked===!0){var h=DOM.val("#J_stakeCount"+a),f=H.util.isNull(h),d=f[0];if(d)return promotionControl.msg&&promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1",f[1]+'<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),DOM.addClass(DOM.get("#J_stakeCount"+a),"text-error"),d=!0;DOM.hide(c),DOM.removeClass(DOM.get("#J_stakeCount"+a),"text-error");var i=KISSY.trim(DOM.val("#J_Content"+a)),j=i.replace(/[^\x00-\xff]/g,"**").length;if(j>40)return promotionControl.msg&&promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1",'\u5f69\u7968\u8d60\u8a00\u4e0d\u80fd\u8d85\u8fc740\u4e2a\u5b57\u7b26<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),d=!0;DOM.hide(c)}}else{if(DOM.get("#J_isDiscount"+a).checked===!1&&DOM.get("#J_isDiscountMoney"+a).checked===!1&&DOM.get("#J_isSetArea"+a).checked===!1&&DOM.get("#J_isSendGift"+a).checked===!1)return promotionControl.msg&&promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1","\u5c42\u7ea7"+(b+1)+"\u7684\u4f18\u60e0\u5185\u5bb9\u5fc5\u987b\u9009\u62e9\u4e00\u9879\u4ee5\u4e0a\uff01"+'<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),d=!0;DOM.hide(c);if(DOM.get("#J_isDiscount"+a).checked===!0){var k=DOM.val("#J_discountRate"+a);f=checkUtil.checkDiscount(k),d=f[0],msg=f[1];if(d)return promotionControl.msg&&promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1",msg+'<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),DOM.val("#J_isDiscount"+a,""),DOM.addClass(DOM.get("#J_isDiscount"+a),"text-error"),d=!0;DOM.hide(c),DOM.removeClass(DOM.get("#J_isDiscount"+a),"text-error")}if(g==1&&DOM.get("#J_isDiscount"+a).checked===!0&&DOM.get("#J_isDiscountMoney"+a).checked===!0){var l=e*k/10-o;if(l<=0)return promotionControl.msg&&promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1","\u5c42\u7ea7"+(b+1)+"\u6ee1"+e+"\u5143\u6253"+k+"\u6298\u51cf"+o+"\u5143\u540e\u603b\u4ef7\u7b49\u4e8e"+l+'\u5c0f\u4e8e0<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),DOM.val("#J_decreaseMoney"+a,""),DOM.addClass(DOM.get("#J_decreaseMoney"+a),"text-error"),d=!0;DOM.hide(c),DOM.removeClass(DOM.get("#J_decreaseMoney"+a),"text-error")}if(DOM.get("#J_isSendGift"+a).checked===!0){var m=DOM.val("#J_giftName"+a),n=DOM.val("#J_giftUrl"+a),f=checkUtil.isNull(m),d=f[0];if(d)return promotionControl.msg&&promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1",f[1]+'<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),DOM.addClass(DOM.get("#J_giftName"+a),"text-error"),d=!0;DOM.hide(c),DOM.removeClass(DOM.get("#J_giftName"+a),"text-error");var f=checkUtil.isNull(n),d=f[0];if(d)return promotionControl.msg&&promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1",f[1]+'<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),DOM.addClass(DOM.get("#J_giftUrl"+a),"text-error"),d=!0;DOM.hide(c),DOM.removeClass(DOM.get("#J_giftUrl"+a),"text-error");var f=checkUtil.checkUrl(n),d=f[0];if(d)return promotionControl.msg&&promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1",f[1]+'<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),DOM.addClass(DOM.get("#J_giftUrl"+a),"text-error"),d=!0;DOM.hide(c),DOM.removeClass(DOM.get("#J_giftUrl"+a),"text-error")}}if(DOM.get("#J_isDiscountMoney"+a).checked===!0){var o=DOM.val("#J_decreaseMoney"+a);f=itemHandle.checkPrice(o),d=f[0],msg=f[1];if(d)return promotionControl.msg&&promotionControl.msg.hide(),DOM.val("#J_decreaseMoney"+a)==""?DOM.html("#J_ParamsErrorMsg1",'\u4ef7\u683c\u4e0d\u80fd\u4e3a\u7a7a\u54e6 <a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'):DOM.html("#J_ParamsErrorMsg1",f[1]+'<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),DOM.val("#J_decreaseMoney"+a,""),DOM.addClass(DOM.get("#J_decreaseMoney"+a),"text-error"),d=!0;DOM.hide(c),DOM.removeClass(DOM.get("#J_decreaseMoney"+a),"text-error");if(g==1){var l=e-o;if(l<=0)return promotionControl.msg&&promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1","\u5c42\u7ea7"+(b+1)+'\u6298\u6263\u4ef7\u4e0d\u80fd\u9ad8\u4e8e\u6761\u4ef6\u4ef7<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),DOM.val("#J_decreaseMoney"+a,""),DOM.addClass(DOM.get("#J_decreaseMoney"+a),"text-error"),d=!0;DOM.hide(c),DOM.removeClass(DOM.get("#J_decreaseMoney"+a),"text-error")}}if(DOM.get("#J_isSetArea"+a).checked===!0){var p=DOM.val("#J_freeAreasName"+a).split(",");if(p.length==0||p==""){var i="\u5c42\u7ea7"+(b+1)+"\u514d\u90ae\u5730\u533a\u672a\u8bbe\u7f6e\uff01";return promotionControl.msg&&promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1",i+'<a href="javascript:promotionControl.checkAction('+a+')">\u70b9\u6b64\u4fee\u6539</a>'),c.css("display")==="none"&&c.slideDown(),d=!0}DOM.hide(c)}return d},checkCpAgreement:function(a){if(DOM.val("#J_IsSign")==1)return;promotionControl.x.setCheckboxOff(a);var b=function(b){b.payload.sign?(DOM.val("#J_IsSign","1"),promotionControl.x.setCheckboxOn(a)):(new H.widget.msgBox({title:"\u7b7e\u8ba2\u534f\u8bae",content:'\u8bf7\u5148\u5f00\u901a<a href="'+b.payload.sign_url+'" target="_blank">\u652f\u4ed8\u5b9d\u4ee3\u8d2d\u534f\u8bae</a>',type:"info"}),DOM.val("#J_IsSign","0"))},c=function(a){var b=KISSY.one("#J_ParamsErrorBox");DOM.html("#J_ParamsErrorMsg",a.desc),b.css("display")==="none"&&b.slideDown()},d="";(new H.widget.asyncRequest).setURI(checkSignUrl).setMethod("GET").setHandle(b).setErrorHandle(c).setData(d).setDataType("json").send()},loadingCheck:function(){var a=function(a){a.payload.sign?DOM.val("#J_IsSign","1"):(new H.widget.msgBox({title:"\u7b7e\u8ba2\u534f\u8bae",content:'\u8bf7\u5148\u5f00\u901a<a href="'+a.payload.sign_url+'" target="_blank">\u652f\u4ed8\u5b9d\u4ee3\u8d2d\u534f\u8bae</a>',type:"info"}),DOM.val("#J_IsSign","0"))},b=function(a){new H.widget.msgBox({title:"\u6e29\u99a8\u63d0\u793a",content:a.desc,type:"info"})},c="";(new H.widget.asyncRequest).setURI(checkSignUrl).setMethod("GET").setHandle(a).setErrorHandle(b).setData(c).setDataType("json").send()},checkTbItemNum:function(a){if(DOM.val("#J_RangeTypeValue")!="ALL"){a.checked?DOM.show("#J_PromodescBox"):DOM.hide("#J_PromodescBox");return}if(DOM.val("#J_TbItemsNum")==1){var b=DOM.val("#J_TbItemsTotalNum");new H.widget.msgBox({title:"\u6e29\u99a8\u63d0\u793a",content:"\u5b9d\u8d1d\u6570 0~1000\u624d\u80fd\u4f7f\u7528\u5168\u5e97\u8be6\u60c5\u6a21\u677f\uff0c\u60a8\u5e97\u94fa\u603b\u5171"+b+"\u4e2a\u5b9d\u8d1d\u3002",type:"info"}),DOM.prop(a,"checked",!1),DOM.hide("#J_PromodescBox");return}if(DOM.val("#J_TbItemsNum")==9999){a.checked?DOM.show("#J_PromodescBox"):DOM.hide("#J_PromodescBox");return}DOM.prop(a,"checked",!1);var c=function(b){b.payload.num>3e3||b.payload.num==0?(new H.widget.msgBox({title:"\u6e29\u99a8\u63d0\u793a",content:"\u5b9d\u8d1d\u6570 0~1000\u624d\u80fd\u4f7f\u7528\u5168\u5e97\u8be6\u60c5\u6a21\u677f\uff0c\u60a8\u5e97\u94fa\u603b\u5171"+b.payload.num+"\u4e2a\u5b9d\u8d1d\u3002",type:"info"}),DOM.val("#J_TbItemsNum",1),DOM.prop(a,"checked",!1),DOM.hide("#J_PromodescBox")):(DOM.prop(a,"checked",!0),DOM.val("#J_TbItemsNum",9999)),DOM.val("#J_TbItemsTotalNum",b.payload.num)},d=function(a){var b=KISSY.one("#J_ParamsErrorBox");DOM.html("#J_ParamsErrorMsg",a.payload.desc),b.css("display")==="none"&&b.slideDown()},e="";(new H.widget.asyncRequest).setURI(getTbItemsNumUrl).setMethod("GET").setHandle(c).setErrorHandle(d).setData(e).setDataType("json").send()},save:function(a){a=="preview"?promotionControl.msg={hide:function(){}}:(promotionControl.msg=null,promotionControl.msg=new H.widget.msgBox({title:"",dialogType:"loading",content:"\u6b63\u5728\u4fdd\u5b58\u4e2d\uff0c\u8bf7\u7a0d\u5019"}));var b=promotionForm.promo_name.value,c=promotionForm.promo_desc.value;promotionControl.PromoNameAction(b);if(promotionControl.NameError==1){promotionControl.msg.hide();return}ParamsErrorBox=KISSY.one("#J_ParamsErrorBox"),ParamsErrorBox1=KISSY.one("#J_ParamsErrorBox1"),ParamsErrorBox.hide();var d=promotionForm.type_id.value;if(d!="20"){if(S.one("#J_startDate")){var e=DOM.val("#J_startDate"),f=S.one("#J_endDate").val();if(f!=""&&e>=f){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg","\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u5927\u4e8e\u7ed3\u675f\u65f6\u95f4\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9"),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),DOM.addClass("#J_startDate","text-error");return}DOM.hide(ParamsErrorBox)}if(S.one("#J_endDate")){var f=S.one("#J_endDate").val(),g=new Date,h=new Date(g.getTime()+Number(DiffTime)),i=H.util.stringToDate(S.one("#J_startDate").val()),j=H.util.stringToDate(f),k=H.util.stringToDate(invaliDate);if(j.getTime()<=i){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg","\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u5c0f\u4e8e\u5f00\u59cb\u65f6\u95f4\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9"),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),DOM.addClass("#J_endDate","text-error");return}if(j.getTime()<=h.getTime()){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg","\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u5c0f\u4e8e\u5f53\u524d\u65f6\u95f4\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9"),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),DOM.addClass("#J_endDate","text-error");return}DOM.hide(ParamsErrorBox)}}switch(d){case"10":case"11":case"12":var l=document.getElementsByName("params[type]"),m=l.length;for(var n=0;n<m;n++)if(l[n].checked){q=l[n].value;if(q=="1"){if(promotionControl.isEidt)var o=document.getElementsByName("is_change_item").checked=!1;break}switch(q){case"2":save=document.getElementsByName("params[save]"),r=H.util.checkPrice(Math.abs(save[0].value)),s=r[0],msg=r[1];if(s){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg",msg),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),save[0].value="",save[0].focus(),DOM.addClass(save[0],"text-error");return}DOM.removeClass(save[0],"text-error"),DOM.hide(ParamsErrorBox);break;case"3":spec=document.getElementsByName("params[spec]"),r=H.util.checkPrice(spec[0].value),s=r[0],msg=r[1];if(s){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg",msg),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),spec[0].value="",spec[0].focus(),DOM.addClass(spec[0],"text-error");return}DOM.removeClass(spec[0],"text-error"),DOM.hide(ParamsErrorBox);break;case"4":discount=document.getElementsByName("params[discount]"),r=H.util.checkPrice(discount[0].value),s=r[0],msg=r[1];if(s){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg",msg),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),discount[0].value="",discount[0].focus(),DOM.addClass(discount[0],"text-error");return}DOM.hide(ParamsErrorBox),DOM.removeClass(discount[0],"text-error")}break}break;case"2":case"9":case"32":if(promotionControl.isEidt&&d!=32)var o=document.getElementsByName("is_change_item"),p=o[0].checked;else var p=!0;if(p){var q=document.getElementsByName("params[type]");a=q[0].value,discount=document.getElementsByName("params[value]");var r=checkUtil.isNull(discount[0].value),s=r[0];if(promotionControl.isEidt){if(s){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg",msg),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),discount[0].focus(),DOM.addClass(discount[0],"text-error");return}DOM.hide(ParamsErrorBox),DOM.removeClass(discount[0],"text-error")}if(!s){if(d=="9"||d=="12")var t=0,u="\u6298\u6263\u6682\u65f6\u4e0d\u80fd\u4f4e\u4e8e7\u6298!";else var t=0,u="\u6298\u6263\u8303\u56f4\u57280.00~9.99\u6298!";if(discount[0].value>=10||discount[0].value<t){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg",u),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),discount[0].value="",discount[0].focus(),DOM.addClass(discount[0],"text-error");return}DOM.hide(ParamsErrorBox),DOM.removeClass(discount[0],"text-error"),r=checkUtil.checkDiscount(discount[0].value),s=r[0],msg=r[1];if(s){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg",msg),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),discount[0].value="",discount[0].focus(),DOM.addClass(discount[0],"text-error");return}DOM.hide(ParamsErrorBox),DOM.removeClass(discount[0],"text-error")}if(d=="9"){var v=document.getElementsByName("params[start_num]"),w=document.getElementsByName("params[min_num]"),x=document.getElementsByName("params[max_num]");if(isNaN(Number(v[0].value))||v[0].value<0)v[0].value="0";if(isNaN(Number(w[0].value))||w[0].value<0)w[0].value="0";if(isNaN(Number(x[0].value))||x[0].value<=0||Number(x[0].value)<Number(w[0].value)){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg","\u53c2\u56e2\u4eba\u6570\u4e0a\u7ebf\u5927\u4e8e\u7b49\u4e8e\u53c2\u56e2\u4eba\u6570\u4e0b\u7ebf"),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),x[0].value="",x[0].focus(),DOM.addClass(x[0],"text-error");return}DOM.hide(ParamsErrorBox),DOM.removeClass(x[0],"text-error")}}if(d=="32"){var y=DOM.val("#J_LimitNumValue");r=H.util.checkPrice(y),s=r[0],msg=r[1];if(s){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg","\u9650\u8d2d \u6570\u91cf \u5927\u4e8e0\u54e6"),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),DOM.val("#J_LimitNumValue",""),DOM.addClass("#J_LimitNumValue","text-error");return}DOM.hide(ParamsErrorBox),DOM.removeClass("#J_LimitNumValue","text-error"),DOM.val("#J_LimitNumValue",Number(y).toFixed(0))}break;case"20":var z=DOM.children("#J_privilegeTier"),m=z.length;times=[];if(m>1)for(var A=1;A<m;A++){var i=DOM.val("#J_StartDateJtj"+(A-1)),j=DOM.val("#J_StartDateJtj"+A),h=new Date,B=H.util.stringToDate(i),C=H.util.stringToDate(j),k=H.util.stringToDate(invaliDate);if(C.getTime()<=B.getTime()){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg","\u65f6\u95f4\u6709\u8bef\uff0c\u6d3b\u52a8\u65f6\u95f4\u6bb5\u4e0d\u80fd\u91cd\u53e0"),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),DOM.addClass(z[A],"text-error");return}DOM.hide(ParamsErrorBox),DOM.removeClass(z[A],"text-error")}for(var D=0;D<promotionControl.jtjData.length;D++){var E=DOM.val("#J_StartDateJtj"+D),F=DOM.val("#J_EndDateJtj"+D),G=[E,F];times.push(G)}DOM.val("#J_ladd",times);break;case"105":case"106":case"115":var I=DOM.val("#J_conValue0"),J=DOM.val("#J_IsConditionValue");if(J=="1"){spec=document.getElementsByName("params[value]");var r=checkUtil.isNull(I),s=r[0];if(s){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1",r[1]),ParamsErrorBox1.css("display")==="none"&&ParamsErrorBox1.slideDown(),DOM.val("#J_conValue0",""),DOM.addClass("#J_conValue0","text-error");return}DOM.hide(ParamsErrorBox1),DOM.removeClass("#J_conValue0","text-error"),r=H.util.checkPrice(I),s=r[0],msg=r[1];if(s){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1",r[1]),ParamsErrorBox1.css("display")==="none"&&ParamsErrorBox1.slideDown(),DOM.val("#J_conValue0",""),DOM.addClass("#J_conValue0","text-error");return}DOM.hide(ParamsErrorBox1),DOM.removeClass("#J_conValue0","text-error");var K=DOM.val("#J_freeAreasName0").split(",");if(K.length==0||K==""){var L="\u514d\u90ae\u5730\u533a\u672a\u8bbe\u7f6e!";promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg1",L),ParamsErrorBox1.css("display")==="none"&&ParamsErrorBox1.slideDown();return}DOM.hide(ParamsErrorBox1)}break;case"107":case"108":case"117":for(var g=0;g<promotionControl.mjsData.length;g++){var M=promotionControl.checkRule(g,g);if(M==1)return;if(g>0){var N=DOM.val("#J_conValue"+(g-1)),O=DOM.val("#J_conValue"+g);if(Number(N)-Number(O)>=0){promotionControl.msg.hide();var L="\u5c42\u7ea7"+(g+1)+"\u6ee1\u591a\u5c11\u8981\u5927\u4e8e\u5c42\u7ea7"+g+"\uff01";for(var P=0;P<promotionControl.mjsData.length;P++)promotionControl.miniMjs(P);promotionControl.maxiMjs(g),DOM.html("#J_ParamsErrorMsg1",L+'<a href="javascript:promotionControl.checkAction('+g+')">\u70b9\u6b64\u4fee\u6539</a>'),ParamsErrorBox1.css("display")==="none"&&ParamsErrorBox1.slideDown(),DOM.addClass(DOM.get("#J_conValue"+g),"text-error");return}DOM.hide(ParamsErrorBox1),DOM.removeClass(DOM.get("#J_conValue"+g),"text-error")}}break;case"110":case"111":case"120":DOM.val("#J_TypeId",32);break;case"118":if(promotionControl.mjspartAttend.length==0||promotionControl.mjspartNothing.length==0){promotionControl.msg.hide(),DOM.html("#J_ParamsErrorMsg","\u8bf7\u6dfb\u52a0\u5b9d\u8d1d"),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown();return}DOM.hide(ParamsErrorBox);break;case"207":case"208":case"217":for(var g=0;g<promotionControl.mjsData.length;g++){var M=promotionControl.checkRule(g,g);if(M==1)return;if(g>0){var N=DOM.val("#J_conValue"+(g-1)),O=DOM.val("#J_conValue"+g);if(Number(N)-Number(O)>=0){promotionControl.msg.hide();var L="\u5c42\u7ea7"+(g+1)+"\u6ee1\u591a\u5c11\u8981\u5927\u4e8e\u5c42\u7ea7"+g+"\uff01";for(var P=0;P<promotionControl.mjsData.length;P++)promotionControl.miniMjs(P);promotionControl.maxiMjs(g),DOM.html("#J_ParamsErrorMsg1",L+'<a href="javascript:promotionControl.checkAction('+g+')">\u70b9\u6b64\u4fee\u6539</a>'),ParamsErrorBox1.css("display")==="none"&&ParamsErrorBox1.slideDown(),DOM.addClass(DOM.get("#J_conValue"+g),"text-error");return}DOM.hide(ParamsErrorBox1),DOM.removeClass(DOM.get("#J_conValue"+g),"text-error")}}break;default:}if(promotionControl.isEidt)if(a=="preview"){var Q=DOM.val("#J_ProtoId"),R=function(a){ParamsErrorBox.hide(),DOM.html(DOM.get("#J_PreviewBox_"+Q),a.payload.body),DOM.height(DOM.parent("#J_PreviewBox_"+Q,".J_Height"),DOM.height(DOM.get("#J_PreviewBox_"+Q+" table"))),prodescTempleteId&&(DOM.prop("#J_IsPromodesc","checked")||DOM.hide("#J_PromodescBox"))},T=function(a){promotionControl.msg.hide();if(a.desc=="need-oauth"){KISSY.Event.fire(".J_TopExpired","click");return}DOM.html("#J_ParamsErrorMsg",a.desc),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),DOM.scrollIntoView("#J_ParamsErrorMsg",window)};if(DOM.get("#J_promoExplain").checked==1)if(DOM.val(DOM.get("#J_shopDesc"))!="\u8be5\u6d3b\u52a8\u4ec5\u9650\u90e8\u5206\u7528\u6237\u53c2\u4e0e\u54e6")var U=encodeURIComponent(DOM.val(DOM.get("#J_shopDesc")));else var U="";else var U="";var V="&shop_desc="+U;(new H.widget.asyncRequest).setURI(privewPromodescUrl).setMethod("POST").setForm("#promotion_edit_form").setHandle(R).setErrorHandle(T).setData(V).send()}else{var R=function(a){promotionControl.msg.hide(),ParamsErrorBox.hide(),ParamsSucessBox=KISSY.one("#J_ParamsSucessBox"),DOM.html("#J_ParamsSucessMsg",a.desc),ParamsSucessBox.css("display")==="none"&&ParamsSucessBox.slideDown(),DOM.scrollIntoView("#J_ParamsSucessMsg",window),window.location.href=sucessTargerUrl+"&pid="+a.pid},T=function(a){promotionControl.msg.hide();if(a.desc=="need-oauth"){KISSY.Event.fire(".J_TopExpired","click");return}DOM.html("#J_ParamsErrorMsg",a.desc),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),DOM.scrollIntoView("#J_ParamsErrorMsg",window)},W=KISSY.JSON.stringify(promotionControl.mjspartAttend),X=KISSY.JSON.stringify(promotionControl.mjspartNothing),Y=KISSY.JSON.stringify(promotionControl.mjsRemove);W=W.replace(/%25/g,"%!").replace(/&/g,"%26"),X=X.replace(/%25/g,"%!").replace(/&/g,"%26"),Y=Y.replace(/%25/g,"%!").replace(/&/g,"%26");var V="&items="+Y+"&join_items="+W+"&nothing_items="+X;(new H.widget.asyncRequest).setURI(editorSaveUrl).setMethod("POST").setForm("#promotion_edit_form").setHandle(R).setErrorHandle(T).setData(V).send()}else if(a=="preview"){var Q=DOM.val("#J_ProtoId"),R=function(a){DOM.html(DOM.get("#J_PreviewBox_"+Q),a.payload.body),DOM.height(DOM.parent("#J_PreviewBox_"+Q,".J_Height"),DOM.height(DOM.get("#J_PreviewBox_"+Q+" table")))},T=function(a){promotionControl.msg.hide();if(a.desc=="need-oauth"){KISSY.Event.fire(".J_TopExpired","click");return}DOM.html("#J_ParamsErrorMsg",a.desc),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),DOM.scrollIntoView("#J_ParamsErrorMsg",window)};if(DOM.get("#J_promoExplain").checked==1)if(DOM.val(DOM.get("#J_shopDesc"))!="\u8be5\u6d3b\u52a8\u4ec5\u9650\u90e8\u5206\u7528\u6237\u53c2\u4e0e\u54e6")var U=encodeURIComponent(DOM.val(DOM.get("#J_shopDesc")));else var U="";else var U="";var V="&shop_desc="+U;(new H.widget.asyncRequest).setURI(privewPromodescUrl).setMethod("POST").setForm("#promotion_edit_form").setHandle(R).setErrorHandle(T).setData(V).send()}else{var R=function(a){promotionControl.msg.hide(),ParamsErrorBox.hide(),ParamsSucessBox=KISSY.one("#J_ParamsSucessBox"),DOM.html("#J_ParamsSucessMsg","\u6210\u529f\u521b\u5efa\u6d3b\u52a8\uff01"),ParamsSucessBox.css("display")==="none"&&ParamsSucessBox.slideDown(),DOM.scrollIntoView("#J_ParamsSucessMsg",window),window.location.href=a.desc},T=function(a){promotionControl.msg.hide();if(a.desc=="need-oauth"){KISSY.Event.fire(".J_TopExpired","click");return}DOM.html("#J_ParamsErrorMsg",a.desc),ParamsErrorBox.css("display")==="none"&&ParamsErrorBox.slideDown(),DOM.scrollIntoView("#J_ParamsErrorMsg",window)},W=KISSY.JSON.stringify(promotionControl.mjspartAttend),X=KISSY.JSON.stringify(promotionControl.mjspartNothing),Y=KISSY.JSON.stringify(promotionControl.mjsRemove);W=W.replace(/%25/g,"%!").replace(/&/g,"%26"),X=X.replace(/%25/g,"%!").replace(/&/g,"%26"),Y=Y.replace(/%25/g,"%!").replace(/&/g,"%26");var V="&items="+Y+"&join_items="+W+"&nothing_items="+X;(new H.widget.asyncRequest).setURI(SaveUrl).setMethod("POST").setForm("#promotion_edit_form").setHandle(R).setErrorHandle(T).setData(V).send()}return!0},PromoNameAction:function(a){var b=checkUtil.isNull(a),c=b[0],d=b[1];if(c)return DOM.addClass(promotionForm.promo_name,"text-error"),DOM.html("#J_PromoNameError",d),DOM.hide("#J_PromoNameRequired"),DOM.show("#J_PromoNameError"),promotionControl.NameError=!0;DOM.hide("#J_PromoNameError"),DOM.show("#J_PromoNameRequired"),b=checkUtil.checkSpecTitle(a),c=b[0],d=b[1];if(c)return DOM.addClass(promotionForm.promo_name,"text-error"),DOM.html("#J_PromoNameError",d),DOM.hide("#J_PromoNameRequired"),DOM.show("#J_PromoNameError"),promotionControl.NameError=!0;DOM.hide("#J_PromoNameError"),DOM.show("#J_PromoNameRequired");var e=DOM.val("#J_TypeId");if(e=="2"||e=="9"||e=="20"||e=="22"||e=="32"){b=checkUtil.checkPromoName(a),c=b[0],d=b[1];if(c)return DOM.addClass(promotionForm.promo_name,"text-error"),DOM.html("#J_PromoNameError",d),DOM.hide("#J_PromoNameRequired"),DOM.show("#J_PromoNameError"),promotionControl.NameError=!0;DOM.hide("#J_PromoNameError"),DOM.show("#J_PromoNameRequired")}return DOM.removeClass(promotionForm.promo_name,"text-error"),DOM.hide("#J_PromoNameError"),promotionControl.NameError=!1},PromoDescAction:function(a){var b=checkUtil.isNull(a),c=b[0],d=b[1];if(!c){b=checkUtil.checkPromoDesc(a),c=b[0],d=b[1];if(c)return DOM.addClass(promotionForm.promo_desc,"text-error"),DOM.html("#J_PromoDescError",d),DOM.hide("#J_PromoDescRequired"),DOM.hide("#J_PromoDescSucess"),DOM.show("#J_PromoDescError"),promotionControl.DescError=!0;b=checkUtil.checkSpecTitle(a),c=b[0],d=b[1];if(c)return DOM.addClass(promotionForm.promo_desc,"text-error"),DOM.html("#J_PromoDescError",d),DOM.hide("#J_PromoDescRequired"),DOM.hide("#J_PromoDescSucess"),DOM.show("#J_PromoDescError"),promotionControl.DescError=!0}return DOM.removeClass(promotionForm.promo_desc,"text-error"),DOM.hide("#J_PromoDescRequired"),DOM.show("#J_PromoDescSucess"),DOM.hide("#J_PromoDescError"),promotionControl.DescError=!1},handleInputs:function(){var a=DOM.filter(DOM.query("input"),function(a){if(a.type=="text")return!0});Event.on(a,"focus blur",function(a){a.type=="focus"?DOM.hasClass(a.target,"input-none")?(DOM.removeClass(DOM.parent(a.target),"input-text text text-error"),DOM.addClass(DOM.parent(a.target),"input-text-on")):(DOM.removeClass(a.target,"input-text text text-error"),DOM.addClass(a.target,"input-text-on")):a.type=="blur"&&(DOM.hasClass(a.target,"input-none")?(DOM.removeClass(DOM.parent(a.target),"input-text-on"),DOM.addClass(DOM.parent(a.target),"input-text")):(DOM.removeClass(a.target,"input-text-on"),DOM.addClass(a.target,"input-text")))})}}},{requires:["./mods/check","./mods/item-handle","utils/beautifyForm/index","bui/select","bui/tooltip","bui/calendar","bui/overlay","xtemplate","utils/showPages/index","switchable"]}); 